ireDefault(_WebGLRenderer2("./settings")),_CanvasRenderer2=_interopRequireDefault(_WebGLRenderer2("./renderers/canvas/CanvasRenderer")),_WebGLRenderer2=_interopRequireDefault(_WebGLRenderer2("./renderers/webgl/WebGLRenderer"));function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.settings=_settings2.default,exports.utils=utils,exports.ticker=ticker,exports.CanvasRenderer=_CanvasRenderer2.default,exports.WebGLRenderer=_WebGLRenderer2.default},{"./Application":38,"./Shader":39,"./autoDetectRenderer":40,"./const":41,"./display/Bounds":42,"./display/Container":43,"./display/DisplayObject":44,"./display/Transform":45,"./display/TransformBase":46,"./display/TransformStatic":47,"./graphics/Graphics":48,"./graphics/GraphicsData":49,"./graphics/canvas/CanvasGraphicsRenderer":50,"./graphics/webgl/GraphicsRenderer":52,"./math":65,"./renderers/canvas/CanvasRenderer":72,"./renderers/canvas/utils/CanvasRenderTarget":74,"./renderers/webgl/WebGLRenderer":79,"./renderers/webgl/filters/Filter":81,"./renderers/webgl/filters/spriteMask/SpriteMaskFilter":84,"./renderers/webgl/managers/WebGLManager":88,"./renderers/webgl/utils/ObjectRenderer":89,"./renderers/webgl/utils/Quad":90,"./renderers/webgl/utils/RenderTarget":91,"./settings":96,"./sprites/Sprite":97,"./sprites/canvas/CanvasSpriteRenderer":98,"./sprites/canvas/CanvasTinter":99,"./sprites/webgl/SpriteRenderer":101,"./text/Text":103,"./text/TextMetrics":104,"./text/TextStyle":105,"./textures/BaseRenderTexture":106,"./textures/BaseTexture":107,"./textures/RenderTexture":108,"./textures/Spritesheet":109,"./textures/Texture":110,"./textures/TextureMatrix":111,"./textures/TextureUvs":112,"./textures/VideoBaseTexture":113,"./ticker":116,"./utils":120,"pixi-gl-core":24}],109:[function(Spritesheet,module,exports){"use strict";exports.__esModule=!0;var _createClass=function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor};function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var _=Spritesheet("../"),_utils=Spritesheet("../utils");Spritesheet=function(){function Spritesheet(baseTexture,data){var resolutionFilename=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;!function(instance){if(!(instance instanceof Spritesheet))throw new TypeError("Cannot call a class as a function")}(this),this.baseTexture=baseTexture,this.textures={},this.animations={},this.data=data,this.resolution=this._updateResolution(resolutionFilename||this.baseTexture.imageUrl),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return _createClass(Spritesheet,null,[{key:"BATCH_SIZE",get:function(){return 1e3}}]),Spritesheet.prototype._updateResolution=function(resolution){var scale=this.data.meta.scale,resolution=(0,_utils.getResolutionOfUrl)(resolution,null);return null===resolution&&(resolution=void 0!==scale?parseFloat(scale):1),1!==resolution&&(this.baseTexture.resolution=resolution,this.baseTexture.update()),resolution},Spritesheet.prototype.parse=function(callback){this._batchIndex=0,this._callback=callback,this._frameKeys.length<=Spritesheet.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},Spritesheet.prototype._processFrames=function(initialFrameIndex){for(var frameIndex=initialFrameIndex,maxFrames=Spritesheet.BATCH_SIZE,sourceScale=this.baseTexture.sourceScale;frameIndex-initialFrameIndex<maxFrames&&frameIndex<this._frameKeys.length;){var trim,orig,frame,i=this._frameKeys[frameIndex],data=this._frames[i],rect=data.frame;rect&&(trim=frame=null,orig=!1!==data.trimmed&&data.sourceSize?data.sourceSize:data.frame,orig=new _.Rectangle(0,0,Math.floor(orig.w*sourceScale)/this.resolution,Math.floor(orig.h*sourceScale)/this.resolution),frame=data.rotated?new _.Rectangle(Math.floor(rect.x*sourceScale)/this.resolution,Math.floor(rect.y*sourceScale)/this.resolution,Math.floor(rect.h*sourceScale)/this.resolution,Math.floor(rect.w*sourceScale)/this.resolution):new _.Rectangle(Math.floor(rect.x*sourceScale)/this.resolution,Math.floor(rect.y*sourceScale)/this.resolution,Math.floor(rect.w*sourceScale)/this.resolution,Math.floor(rect.h*sourceScale)/this.resolution),!1!==data.trimmed&&data.spriteSourceSize&&(trim=new _.Rectangle(Math.floor(data.spriteSourceSize.x*sourceScale)/this.resolution,Math.floor(data.spriteSourceSize.y*sourceScale)/this.resolution,Math.floor(rect.w*sourceScale)/this.resolution,Math.floor(rect.h*sourceScale)/this.resolution)),this.textures[i]=new _.Texture(this.baseTexture,frame,orig,trim,data.rotated?2:0,data.anchor),_.Texture.addToCache(this.textures[i],i)),frameIndex++}},Spritesheet.prototype._processAnimations=function(){var animName,animations=this.data.animations||{};for(animName in animations){this.animations[animName]=[];for(var _ref,_iterator=animations[animName],_isArray=Array.isArray(_iterator),_i=0,_iterator=_isArray?_iterator:_iterator[Symbol.iterator]();;){if(_isArray){if(_i>=_iterator.length)break;_ref=_iterator[_i++]}else{if((_i=_iterator.next()).done)break;_ref=_i.value}this.animations[animName].push(this.textures[_ref])}}},Spritesheet.prototype._parseComplete=function(){var callback=this._callback;this._callback=null,this._batchIndex=0,callback.call(this,this.textures)},Spritesheet.prototype._nextBatch=function(){var _this=this;this._processFrames(this._batchIndex*Spritesheet.BATCH_SIZE),this._batchIndex++,setTimeout(function(){_this._batchIndex*Spritesheet.BATCH_SIZE<_this._frameKeys.length?_this._nextBatch():(_this._processAnimations(),_this._parseComplete())},0)},Spritesheet.prototype.destroy=function(){var i,destroyBase=0<arguments.length&&void 0!==arguments[0]&&arguments[0];for(i in this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,destroyBase&&this.baseTexture.destroy(),this.baseTexture=null},Spritesheet}();exports.default=Spritesheet},{"../":60,"../utils":120}],103:[function(require,module,exports){"use strict";exports.__esModule=!0;var _createClass=function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor};function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var Text=_interopRequireDefault(require("../sprites/Sprite")),_Texture2=_interopRequireDefault(require("../textures/Texture")),_math=require("../math"),_utils=require("../utils"),_const=require("../const"),_settings2=_interopRequireDefault(require("../settings")),_TextStyle2=_interopRequireDefault(require("./TextStyle")),_TextMetrics2=_interopRequireDefault(require("./TextMetrics")),_trimCanvas2=_interopRequireDefault(require("../utils/trimCanvas"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},Text=function(_Sprite){function Text(text,style,canvas){!function(instance){if(!(instance instanceof Text))throw new TypeError("Cannot call a class as a function")}(this),(canvas=canvas||document.createElement("canvas")).width=3,canvas.height=3;var _this=_Texture2.default.fromCanvas(canvas,_settings2.default.SCALE_MODE,"text");_this.orig=new _math.Rectangle,_this.trim=new _math.Rectangle;_this=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_Sprite.call(this,_this));return _Texture2.default.addToCache(_this._texture,_this._texture.baseTexture.textureCacheIds[0]),_this.canvas=canvas,_this.context=_this.canvas.getContext("2d"),_this.resolution=_settings2.default.RESOLUTION,_this._text=null,_this._style=null,_this._styleListener=null,_this._font="",_this.text=text,_this.style=style,_this.localStyleID=-1,_this}return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(Text,_Sprite),Text.prototype.updateText=function(height){var style=this._style;if(this.localStyleID!==style.styleID&&(this.dirty=!0,this.localStyleID=style.styleID),this.dirty||!height){this._font=this._style.toFontString();var context=this.context,measured=_TextMetrics2.default.measureText(this._text,this._style,this._style.wordWrap,this.canvas),width=measured.width,height=measured.height,lines=measured.lines,lineHeight=measured.lineHeight,lineWidths=measured.lineWidths,maxLineWidth=measured.maxLineWidth,fontProperties=measured.fontProperties;this.canvas.width=Math.ceil((Math.max(1,width)+2*style.padding)*this.resolution),this.canvas.height=Math.ceil((Math.max(1,height)+2*style.padding)*this.resolution),context.scale(this.resolution,this.resolution),context.clearRect(0,0,this.canvas.width,this.canvas.height),context.font=this._font,context.strokeStyle=style.stroke,context.lineWidth=style.strokeThickness,context.textBaseline=style.textBaseline,context.lineJoin=style.lineJoin,context.miterLimit=style.miterLimit;var linePositionX=void 0,linePositionY=void 0;if(style.dropShadow){context.fillStyle=style.dropShadowColor,context.globalAlpha=style.dropShadowAlpha,context.shadowBlur=style.dropShadowBlur,0<style.dropShadowBlur&&(context.shadowColor=style.dropShadowColor);for(var xShadowOffset=Math.cos(style.dropShadowAngle)*style.dropShadowDistance,yShadowOffset=Math.sin(style.dropShadowAngle)*style.dropShadowDistance,i=0;i<lines.length;i++)linePositionX=style.strokeThickness/2,linePositionY=style.strokeThickness/2+i*lineHeight+fontProperties.ascent,"right"===style.align?linePositionX+=maxLineWidth-lineWidths[i]:"center"===style.align&&(linePositionX+=(maxLineWidth-lineWidths[i])/2),style.fill&&(this.drawLetterSpacing(lines[i],linePositionX+xShadowOffset+style.padding,linePositionY+yShadowOffset+style.padding),style.stroke&&style.strokeThickness&&(context.strokeStyle=style.dropShadowColor,this.drawLetterSpacing(lines[i],linePositionX+xShadowOffset+style.padding,linePositionY+yShadowOffset+style.padding,!0),context.strokeStyle=style.stroke))}context.shadowBlur=0,context.globalAlpha=1,context.fillStyle=this._generateFillStyle(style,lines);for(var _i=0;_i<lines.length;_i++)linePositionX=style.strokeThickness/2,linePositionY=style.strokeThickness/2+_i*lineHeight+fontProperties.ascent,"right"===style.align?linePositionX+=maxLineWidth-lineWidths[_i]:"center"===style.align&&(linePositionX+=(maxLineWidth-lineWidths[_i])/2),style.stroke&&style.strokeThickness&&this.drawLetterSpacing(lines[_i],linePositionX+style.padding,linePositionY+style.padding,!0),style.fill&&this.drawLetterSpacing(lines[_i],linePositionX+style.padding,linePositionY+style.padding);this.updateTexture()}},Text.prototype.drawLetterSpacing=function(text,x,y){var isStroke=3<arguments.length&&void 0!==arguments[3]&&arguments[3],letterSpacing=this._style.letterSpacing;if(0!==letterSpacing)for(var current,currentWidth,characters=String.prototype.split.call(text,""),currentPosition=x,index=0,previousWidth=this.context.measureText(text).width;index<text.length;)current=characters[index++],isStroke?this.context.strokeText(current,currentPosition,y):this.context.fillText(current,currentPosition,y),currentPosition+=previousWidth-(currentWidth=this.context.measureText(text.substring(index)).width)+letterSpacing,previousWidth=currentWidth;else isStroke?this.context.strokeText(text,x,y):this.context.fillText(text,x,y)},Text.prototype.updateTexture=function(){var canvas=this.canvas;!this._style.trim||(padding=(0,_trimCanvas2.default)(canvas)).data&&(canvas.width=padding.width,canvas.height=padding.height,this.context.putImageData(padding.data,0,0));var texture=this._texture,baseTexture=this._style,padding=baseTexture.trim?0:baseTexture.padding,baseTexture=texture.baseTexture;baseTexture.hasLoaded=!0,baseTexture.resolution=this.resolution,baseTexture.realWidth=canvas.width,baseTexture.realHeight=canvas.height,baseTexture.width=canvas.width/this.resolution,baseTexture.height=canvas.height/this.resolution,texture.trim.width=texture._frame.width=canvas.width/this.resolution,texture.trim.height=texture._frame.height=canvas.height/this.resolution,texture.trim.x=-padding,texture.trim.y=-padding,texture.orig.width=texture._frame.width-2*padding,texture.orig.height=texture._frame.height-2*padding,this._onTextureUpdate(),baseTexture.emit("update",baseTexture),this.dirty=!1},Text.prototype.renderWebGL=function(renderer){this.resolution!==renderer.resolution&&(this.resolution=renderer.resolution,this.dirty=!0),this.updateText(!0),_Sprite.prototype.renderWebGL.call(this,renderer)},Text.prototype._renderCanvas=function(renderer){this.resolution!==renderer.resolution&&(this.resolution=renderer.resolution,this.dirty=!0),this.updateText(!0),_Sprite.prototype._renderCanvas.call(this,renderer)},Text.prototype.getLocalBounds=function(rect){return this.updateText(!0),_Sprite.prototype.getLocalBounds.call(this,rect)},Text.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},Text.prototype._onStyleChange=function(){this.dirty=!0},Text.prototype._generateFillStyle=function(style,lines){if(!Array.isArray(style.fill))return style.fill;if(navigator.isCocoonJS)return style.fill[0];var gradient=void 0,totalIterations=void 0,currentIteration=void 0,stop=void 0,width=this.canvas.width/this.resolution,height=this.canvas.height/this.resolution,fill=style.fill.slice(),fillGradientStops=style.fillGradientStops.slice();if(!fillGradientStops.length)for(var lengthPlus1=fill.length+1,i=1;i<lengthPlus1;++i)fillGradientStops.push(i/lengthPlus1);if(fill.unshift(style.fill[0]),fillGradientStops.unshift(0),fill.push(style.fill[style.fill.length-1]),fillGradientStops.push(1),style.fillGradientType===_const.TEXT_GRADIENT.LINEAR_VERTICAL){gradient=this.context.createLinearGradient(width/2,0,width/2,height),totalIterations=(fill.length+1)*lines.length;for(var _i2=currentIteration=0;_i2<lines.length;_i2++){currentIteration+=1;for(var j=0;j<fill.length;j++)stop="number"==typeof fillGradientStops[j]?fillGradientStops[j]/lines.length+_i2/lines.length:currentIteration/totalIterations,gradient.addColorStop(stop,fill[j]),currentIteration++}}else{gradient=this.context.createLinearGradient(0,height/2,width,height/2),totalIterations=fill.length+1,currentIteration=1;for(var _i3=0;_i3<fill.length;_i3++)stop="number"==typeof fillGradientStops[_i3]?fillGradientStops[_i3]:currentIteration/totalIterations,gradient.addColorStop(stop,fill[_i3]),currentIteration++}return gradient},Text.prototype.destroy=function(options){"boolean"==typeof options&&(options={children:options}),options=Object.assign({},defaultDestroyOptions,options),_Sprite.prototype.destroy.call(this,options),this.context=null,this.canvas=null,this._style=null},_createClass(Text,[{key:"width",get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(value){this.updateText(!0);var s=(0,_utils.sign)(this.scale.x)||1;this.scale.x=s*value/this._texture.orig.width,this._width=value}},{key:"height",get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(value){this.updateText(!0);var s=(0,_utils.sign)(this.scale.y)||1;this.scale.y=s*value/this._texture.orig.height,this._height=value}},{key:"style",get:function(){return this._style},set:function(style){(style=style||{})instanceof _TextStyle2.default?this._style=style:this._style=new _TextStyle2.default(style),this.localStyleID=-1,this.dirty=!0}},{key:"text",get:function(){return this._text},set:function(text){text=String(""===text||null==text?" ":text),this._text!==text&&(this._text=text,this.dirty=!0)}}]),Text}(Text.default);exports.default=Text},{"../const":41,"../math":65,"../settings":96,"../sprites/Sprite":97,"../textures/Texture":110,"../utils":120,"../utils/trimCanvas":125,"./TextMetrics":104,"./TextStyle":105}],125:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default=function(data){var width=data.width,height=data.height,context=data.getContext("2d"),pixels=context.getImageData(0,0,width,height).data,len=pixels.length,bound={top:null,left:null,right:null,bottom:null},data=null,i=void 0,x=void 0,y=void 0;for(i=0;i<len;i+=4)0!==pixels[i+3]&&(x=i/4%width,y=~~(i/4/width),null===bound.top&&(bound.top=y),(null===bound.left||x<bound.left)&&(bound.left=x),(null===bound.right||bound.right<x)&&(bound.right=1+x),(null===bound.bottom||bound.bottom<y)&&(bound.bottom=y));null!==bound.top&&(width=bound.right-bound.left,height=bound.bottom-bound.top+1,data=context.getImageData(bound.left,bound.top,width,height));return{height:height,width:width,data:data}}},{}],105:[function(require,module,exports){"use strict";exports.__esModule=!0;var _createClass=function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor};function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var TextStyle=require("../const"),_utils=require("../utils");var defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:TextStyle.TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},genericFontFamilies=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],TextStyle=function(){function TextStyle(style){!function(instance){if(!(instance instanceof TextStyle))throw new TypeError("Cannot call a class as a function")}(this),this.styleID=0,this.reset(),deepCopyProperties(this,style,style)}return TextStyle.prototype.clone=function(){var clonedProperties={};return deepCopyProperties(clonedProperties,this,defaultStyle),new TextStyle(clonedProperties)},TextStyle.prototype.reset=function(){deepCopyProperties(this,defaultStyle,defaultStyle)},TextStyle.prototype.toFontString=function(){var fontSizeString="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,fontFamilies=this.fontFamily;Array.isArray(this.fontFamily)||(fontFamilies=this.fontFamily.split(","));for(var i=fontFamilies.length-1;0<=i;i--){var fontFamily=fontFamilies[i].trim();!/([\"\'])[^\'\"]+\1/.test(fontFamily)&&genericFontFamilies.indexOf(fontFamily)<0&&(fontFamily='"'+fontFamily+'"'),fontFamilies[i]=fontFamily}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+fontSizeString+" "+fontFamilies.join(",")},_createClass(TextStyle,[{key:"align",get:function(){return this._align},set:function(align){this._align!==align&&(this._align=align,this.styleID++)}},{key:"breakWords",get:function(){return this._breakWords},set:function(breakWords){this._breakWords!==breakWords&&(this._breakWords=breakWords,this.styleID++)}},{key:"dropShadow",get:function(){return this._dropShadow},set:function(dropShadow){this._dropShadow!==dropShadow&&(this._dropShadow=dropShadow,this.styleID++)}},{key:"dropShadowAlpha",get:function(){return this._dropShadowAlpha},set:function(dropShadowAlpha){this._dropShadowAlpha!==dropShadowAlpha&&(this._dropShadowAlpha=dropShadowAlpha,this.styleID++)}},{key:"dropShadowAngle",get:function(){return this._dropShadowAngle},set:function(dropShadowAngle){this._dropShadowAngle!==dropShadowAngle&&(this._dropShadowAngle=dropShadowAngle,this.styleID++)}},{key:"dropShadowBlur",get:function(){return this._dropShadowBlur},set:function(dropShadowBlur){this._dropShadowBlur!==dropShadowBlur&&(this._dropShadowBlur=dropShadowBlur,this.styleID++)}},{key:"dropShadowColor",get:function(){return this._dropShadowColor},set:function(outputColor){outputColor=getColor(outputColor);this._dropShadowColor!==outputColor&&(this._dropShadowColor=outputColor,this.styleID++)}},{key:"dropShadowDistance",get:function(){return this._dropShadowDistance},set:function(dropShadowDistance){this._dropShadowDistance!==dropShadowDistance&&(this._dropShadowDistance=dropShadowDistance,this.styleID++)}},{key:"fill",get:function(){return this._fill},set:function(outputColor){outputColor=getColor(outputColor);this._fill!==outputColor&&(this._fill=outputColor,this.styleID++)}},{key:"fillGradientType",get:function(){return this._fillGradientType},set:function(fillGradientType){this._fillGradientType!==fillGradientType&&(this._fillGradientType=fillGradientType,this.styleID++)}},{key:"fillGradientStops",get:function(){return this._fillGradientStops},set:function(fillGradientStops){!function(array1,array2){if(!Array.isArray(array1)||!Array.isArray(array2))return!1;if(array1.length!==array2.length)return!1;for(var i=0;i<array1.length;++i)if(array1[i]!==array2[i])return!1;return!0}(this._fillGradientStops,fillGradientStops)&&(this._fillGradientStops=fillGradientStops,this.styleID++)}},{key:"fontFamily",get:function(){return this._fontFamily},set:function(fontFamily){this.fontFamily!==fontFamily&&(this._fontFamily=fontFamily,this.styleID++)}},{key:"fontSize",get:function(){return this._fontSize},set:function(fontSize){this._fontSize!==fontSize&&(this._fontSize=fontSize,this.styleID++)}},{key:"fontStyle",get:function(){return this._fontStyle},set:function(fontStyle){this._fontStyle!==fontStyle&&(this._fontStyle=fontStyle,this.styleID++)}},{key:"fontVariant",get:function(){return this._fontVariant},set:function(fontVariant){this._fontVariant!==fontVariant&&(this._fontVariant=fontVariant,this.styleID++)}},{key:"fontWeight",get:function(){return this._fontWeight},set:function(fontWeight){this._fontWeight!==fontWeight&&(this._fontWeight=fontWeight,this.styleID++)}},{key:"letterSpacing",get:function(){return this._letterSpacing},set:function(letterSpacing){this._letterSpacing!==letterSpacing&&(this._letterSpacing=letterSpacing,this.styleID++)}},{key:"lineHeight",get:function(){return this._lineHeight},set:function(lineHeight){this._lineHeight!==lineHeight&&(this._lineHeight=lineHeight,this.styleID++)}},{key:"leading",get:function(){return this._leading},set:function(leading){this._leading!==leading&&(this._leading=leading,this.styleID++)}},{key:"lineJoin",get:function(){return this._lineJoin},set:function(lineJoin){this._lineJoin!==lineJoin&&(this._lineJoin=lineJoin,this.styleID++)}},{key:"miterLimit",get:function(){return this._miterLimit},set:function(miterLimit){this._miterLimit!==miterLimit&&(this._miterLimit=miterLimit,this.styleID++)}},{key:"padding",get:function(){return this._padding},set:function(padding){this._padding!==padding&&(this._padding=padding,this.styleID++)}},{key:"stroke",get:function(){return this._stroke},set:function(outputColor){outputColor=getColor(outputColor);this._stroke!==outputColor&&(this._stroke=outputColor,this.styleID++)}},{key:"strokeThickness",get:function(){return this._strokeThickness},set:function(strokeThickness){this._strokeThickness!==strokeThickness&&(this._strokeThickness=strokeThickness,this.styleID++)}},{key:"textBaseline",get:function(){return this._textBaseline},set:function(textBaseline){this._textBaseline!==textBaseline&&(this._textBaseline=textBaseline,this.styleID++)}},{key:"trim",get:function(){return this._trim},set:function(trim){this._trim!==trim&&(this._trim=trim,this.styleID++)}},{key:"whiteSpace",get:function(){return this._whiteSpace},set:function(whiteSpace){this._whiteSpace!==whiteSpace&&(this._whiteSpace=whiteSpace,this.styleID++)}},{key:"wordWrap",get:function(){return this._wordWrap},set:function(wordWrap){this._wordWrap!==wordWrap&&(this._wordWrap=wordWrap,this.styleID++)}},{key:"wordWrapWidth",get:function(){return this._wordWrapWidth},set:function(wordWrapWidth){this._wordWrapWidth!==wordWrapWidth&&(this._wordWrapWidth=wordWrapWidth,this.styleID++)}}]),TextStyle}();function getSingleColor(color){return"number"==typeof color?(0,_utils.hex2string)(color):("string"==typeof color&&0===color.indexOf("0x")&&(color=color.replace("0x","#")),color)}function getColor(color){if(Array.isArray(color)){for(var i=0;i<color.length;++i)color[i]=getSingleColor(color[i]);return color}return getSingleColor(color)}function deepCopyProperties(target,source,propertyObj){for(var prop in propertyObj)Array.isArray(source[prop])?target[prop]=source[prop].slice():target[prop]=source[prop]}exports.default=TextStyle},{"../const":41,"../utils":120}],104:[function(require,module,canvas){"use strict";canvas.__esModule=!0;var TextMetrics=function(){function TextMetrics(text,style,width,height,lines,lineWidths,lineHeight,maxLineWidth,fontProperties){!function(instance){if(!(instance instanceof TextMetrics))throw new TypeError("Cannot call a class as a function")}(this),this.text=text,this.style=style,this.width=width,this.height=height,this.lines=lines,this.lineWidths=lineWidths,this.lineHeight=lineHeight,this.maxLineWidth=maxLineWidth,this.fontProperties=fontProperties}return TextMetrics.measureText=function(text,style,lineHeight){var height=3<arguments.length&&void 0!==arguments[3]?arguments[3]:TextMetrics._canvas;lineHeight=null==lineHeight?style.wordWrap:lineHeight;var width=style.toFontString(),fontProperties=TextMetrics.measureFont(width),context=height.getContext("2d");context.font=width;for(var lines=(lineHeight?TextMetrics.wordWrap(text,style,height):text).split(/(?:\r\n|\r|\n)/),lineWidths=new Array(lines.length),maxLineWidth=0,i=0;i<lines.length;i++){var lineWidth=context.measureText(lines[i]).width+(lines[i].length-1)*style.letterSpacing;lineWidths[i]=lineWidth,maxLineWidth=Math.max(maxLineWidth,lineWidth)}width=maxLineWidth+style.strokeThickness;style.dropShadow&&(width+=style.dropShadowDistance);lineHeight=style.lineHeight||fontProperties.fontSize+style.strokeThickness,height=Math.max(lineHeight,fontProperties.fontSize+style.strokeThickness)+(lines.length-1)*(lineHeight+style.leading);return style.dropShadow&&(height+=style.dropShadowDistance),new TextMetrics(text,style,width,height,lines,lineWidths,lineHeight+style.leading,maxLineWidth,fontProperties)},TextMetrics.wordWrap=function(text,style){for(var context=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:TextMetrics._canvas).getContext("2d"),width=0,line="",lines="",cache={},letterSpacing=style.letterSpacing,whiteSpace=style.whiteSpace,collapseSpaces=TextMetrics.collapseSpaces(whiteSpace),collapseNewlines=TextMetrics.collapseNewlines(whiteSpace),canPrependSpaces=!collapseSpaces,wordWrapWidth=style.wordWrapWidth+letterSpacing,tokens=TextMetrics.tokenize(text),i=0;i<tokens.length;i++){var token=tokens[i];if(TextMetrics.isNewline(token)){if(!collapseNewlines){lines+=TextMetrics.addLine(line),canPrependSpaces=!collapseSpaces,line="",width=0;continue}token=" "}if(collapseSpaces){var tokenWidth=TextMetrics.isBreakingSpace(token),isLastToken=TextMetrics.isBreakingSpace(line[line.length-1]);if(tokenWidth&&isLastToken)continue}tokenWidth=TextMetrics.getFromCache(token,letterSpacing,cache,context);if(wordWrapWidth<tokenWidth)if(""!==line&&(lines+=TextMetrics.addLine(line),line="",width=0),TextMetrics.canBreakWords(token,style.breakWords))for(var characters=token.split(""),j=0;j<characters.length;j++){for(var char=characters[j],k=1;characters[j+k];){var nextChar=characters[j+k],lastChar=char[char.length-1];if(TextMetrics.canBreakChars(lastChar,nextChar,token,j,style.breakWords))break;char+=nextChar,k++}j+=char.length-1;var characterWidth=TextMetrics.getFromCache(char,letterSpacing,cache,context);wordWrapWidth<characterWidth+width&&(lines+=TextMetrics.addLine(line),canPrependSpaces=!1,line="",width=0),line+=char,width+=characterWidth}else{0<line.length&&(lines+=TextMetrics.addLine(line),line="",width=0);isLastToken=i===tokens.length-1;lines+=TextMetrics.addLine(token,!isLastToken),canPrependSpaces=!1,line="",width=0}else wordWrapWidth<tokenWidth+width&&(canPrependSpaces=!1,lines+=TextMetrics.addLine(line),line="",width=0),(0<line.length||!TextMetrics.isBreakingSpace(token)||canPrependSpaces)&&(line+=token,width+=tokenWidth)}return lines+=TextMetrics.addLine(line,!1)},TextMetrics.addLine=function(line){var newLine=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return line=TextMetrics.trimRight(line),line=newLine?line+"\n":line},TextMetrics.getFromCache=function(key,spacing,cache,context){var width=cache[key];return void 0===width&&(spacing=key.length*spacing,width=context.measureText(key).width+spacing,cache[key]=width),width},TextMetrics.collapseSpaces=function(whiteSpace){return"normal"===whiteSpace||"pre-line"===whiteSpace},TextMetrics.collapseNewlines=function(whiteSpace){return"normal"===whiteSpace},TextMetrics.trimRight=function(text){if("string"!=typeof text)return"";for(var i=text.length-1;0<=i;i--){var char=text[i];if(!TextMetrics.isBreakingSpace(char))break;text=text.slice(0,-1)}return text},TextMetrics.isNewline=function(char){return"string"==typeof char&&0<=TextMetrics._newlines.indexOf(char.charCodeAt(0))},TextMetrics.isBreakingSpace=function(char){return"string"==typeof char&&0<=TextMetrics._breakingSpaces.indexOf(char.charCodeAt(0))},TextMetrics.tokenize=function(text){var tokens=[],token="";if("string"!=typeof text)return tokens;for(var i=0;i<text.length;i++){var char=text[i];TextMetrics.isBreakingSpace(char)||TextMetrics.isNewline(char)?(""!==token&&(tokens.push(token),token=""),tokens.push(char)):token+=char}return""!==token&&tokens.push(token),tokens},TextMetrics.canBreakWords=function(token,breakWords){return breakWords},TextMetrics.canBreakChars=function(char,nextChar,token,index,breakWords){return!0},TextMetrics.measureFont=function(font){if(TextMetrics._fonts[font])return TextMetrics._fonts[font];var properties={},canvas=TextMetrics._canvas,pixels=TextMetrics._context;pixels.font=font;var metricsString=TextMetrics.METRICS_STRING+TextMetrics.BASELINE_SYMBOL,width=Math.ceil(pixels.measureText(metricsString).width),height=2*(baseline=Math.ceil(pixels.measureText(TextMetrics.BASELINE_SYMBOL).width)),baseline=baseline*TextMetrics.BASELINE_MULTIPLIER|0;canvas.width=width,canvas.height=height,pixels.fillStyle="#f00",pixels.fillRect(0,0,width,height),pixels.font=font,pixels.textBaseline="alphabetic",pixels.fillStyle="#000",pixels.fillText(metricsString,0,baseline);for(var imagedata=pixels.getImageData(0,0,width,height).data,pixels=imagedata.length,line=4*width,i=0,idx=0,stop=!1,i=0;i<baseline;++i){for(var j=0;j<line;j+=4)if(255!==imagedata[idx+j]){stop=!0;break}if(stop)break;idx+=line}for(properties.ascent=baseline-i,idx=pixels-line,stop=!1,i=height;baseline<i;--i){for(var _j=0;_j<line;_j+=4)if(255!==imagedata[idx+_j]){stop=!0;break}if(stop)break;idx-=line}return properties.descent=i-baseline,properties.fontSize=properties.ascent+properties.descent,TextMetrics._fonts[font]=properties},TextMetrics.clearMetrics=function(){var font=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";font?delete TextMetrics._fonts[font]:TextMetrics._fonts={}},TextMetrics}();canvas.default=TextMetrics;canvas=document.createElement("canvas");canvas.width=canvas.height=10,TextMetrics._canvas=canvas,TextMetrics._context=canvas.getContext("2d"),TextMetrics._fonts={},TextMetrics.METRICS_STRING="|Éq",TextMetrics.BASELINE_SYMBOL="M",TextMetrics.BASELINE_MULTIPLIER=1.4,TextMetrics._newlines=[10,13],TextMetrics._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},{}],101:[function(require,module,exports){"use strict";exports.__esModule=!0;var SpriteRenderer=_interopRequireDefault(require("../../renderers/webgl/utils/ObjectRenderer")),_WebGLRenderer2=_interopRequireDefault(require("../../renderers/webgl/WebGLRenderer")),_createIndicesForQuads2=_interopRequireDefault(require("../../utils/createIndicesForQuads")),_generateMultiTextureShader2=_interopRequireDefault(require("./generateMultiTextureShader")),_checkMaxIfStatmentsInShader2=_interopRequireDefault(require("../../renderers/webgl/utils/checkMaxIfStatmentsInShader")),_BatchBuffer2=_interopRequireDefault(require("./BatchBuffer")),_settings2=_interopRequireDefault(require("../../settings")),_utils=require("../../utils"),_pixiGlCore2=_interopRequireDefault(require("pixi-gl-core")),_bitTwiddle2=_interopRequireDefault(require("bit-twiddle"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var TICK=0,TEXTURE_TICK=0,SpriteRenderer=function(_ObjectRenderer){function SpriteRenderer(renderer){!function(instance){if(!(instance instanceof SpriteRenderer))throw new TypeError("Cannot call a class as a function")}(this);var _this=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_ObjectRenderer.call(this,renderer));_this.vertSize=5,_this.vertByteSize=4*_this.vertSize,_this.size=_settings2.default.SPRITE_BATCH_SIZE,_this.buffers=[];for(var i=1;i<=_bitTwiddle2.default.nextPow2(_this.size);i*=2)_this.buffers.push(new _BatchBuffer2.default(4*i*_this.vertByteSize));_this.indices=(0,_createIndicesForQuads2.default)(_this.size),_this.shader=null,_this.currentIndex=0,_this.groups=[];for(var k=0;k<_this.size;k++)_this.groups[k]={textures:[],textureCount:0,ids:[],size:0,start:0,blend:0};return _this.sprites=[],_this.vertexBuffers=[],_this.vaos=[],_this.vaoMax=2,_this.vertexCount=0,_this.renderer.on("prerender",_this.onPrerender,_this),_this}return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(SpriteRenderer,_ObjectRenderer),SpriteRenderer.prototype.onContextChange=function(){var gl=this.renderer.gl;this.renderer.legacy?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS),_settings2.default.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=(0,_checkMaxIfStatmentsInShader2.default)(this.MAX_TEXTURES,gl)),this.shader=(0,_generateMultiTextureShader2.default)(gl,this.MAX_TEXTURES),this.indexBuffer=_pixiGlCore2.default.GLBuffer.createIndexBuffer(gl,this.indices,gl.STATIC_DRAW),this.renderer.bindVao(null);for(var attrs=this.shader.attributes,i=0;i<this.vaoMax;i++){var vertexBuffer=this.vertexBuffers[i]=_pixiGlCore2.default.GLBuffer.createVertexBuffer(gl,null,gl.STREAM_DRAW),vao=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(vertexBuffer,attrs.aVertexPosition,gl.FLOAT,!1,this.vertByteSize,0).addAttribute(vertexBuffer,attrs.aTextureCoord,gl.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(vertexBuffer,attrs.aColor,gl.UNSIGNED_BYTE,!0,this.vertByteSize,12);attrs.aTextureId&&vao.addAttribute(vertexBuffer,attrs.aTextureId,gl.FLOAT,!1,this.vertByteSize,16),this.vaos[i]=vao}this.vao=this.vaos[0],this.currentBlendMode=99999,this.boundTextures=new Array(this.MAX_TEXTURES)},SpriteRenderer.prototype.onPrerender=function(){this.vertexCount=0},SpriteRenderer.prototype.render=function(sprite){this.currentIndex>=this.size&&this.flush(),sprite._texture._uvs&&(this.sprites[this.currentIndex++]=sprite)},SpriteRenderer.prototype.flush=function(){if(0!==this.currentIndex){var vertexData,uvs,gl=this.renderer.gl,MAX_TEXTURES=this.MAX_TEXTURES,vertexBuffer=_bitTwiddle2.default.nextPow2(this.currentIndex),vao=_bitTwiddle2.default.log2(vertexBuffer),buffer=this.buffers[vao],sprites=this.sprites,groups=this.groups,float32View=buffer.float32View,uint32View=buffer.uint32View,boundTextures=this.boundTextures,rendererBoundTextures=this.renderer.boundTextures,touch=this.renderer.textureGC.count,index=0,nextTexture=void 0,currentTexture=void 0,groupCount=1,textureCount=0,currentGroup=groups[0],blendMode=_utils.premultiplyBlendMode[sprites[0]._texture.baseTexture.premultipliedAlpha?1:0][sprites[0].blendMode];currentGroup.textureCount=0,currentGroup.start=0,currentGroup.blend=blendMode,TICK++;for(var attrs,i=void 0,i=0;i<MAX_TEXTURES;++i){var bt=rendererBoundTextures[i];bt._enabled!==TICK?((boundTextures[i]=bt)._virtalBoundId=i,bt._enabled=TICK):boundTextures[i]=this.renderer.emptyTextures[i]}for(TICK++,i=0;i<this.currentIndex;++i){var sprite=sprites[i];sprites[i]=null,nextTexture=sprite._texture.baseTexture;var spriteBlendMode=_utils.premultiplyBlendMode[Number(nextTexture.premultipliedAlpha)][sprite.blendMode];if(blendMode!==spriteBlendMode&&(blendMode=spriteBlendMode,currentTexture=null,textureCount=MAX_TEXTURES,TICK++),currentTexture!==nextTexture&&(currentTexture=nextTexture)._enabled!==TICK){if(textureCount===MAX_TEXTURES&&(TICK++,currentGroup.size=i-currentGroup.start,textureCount=0,(currentGroup=groups[groupCount++]).blend=blendMode,currentGroup.textureCount=0,currentGroup.start=i),nextTexture.touched=touch,-1===nextTexture._virtalBoundId)for(var j=0;j<MAX_TEXTURES;++j){var tIndex=(j+TEXTURE_TICK)%MAX_TEXTURES,t=boundTextures[tIndex];if(t._enabled!==TICK){TEXTURE_TICK++,t._virtalBoundId=-1,boundTextures[nextTexture._virtalBoundId=tIndex]=nextTexture;break}}nextTexture._enabled=TICK,currentGroup.textureCount++,currentGroup.ids[textureCount]=nextTexture._virtalBoundId,currentGroup.textures[textureCount++]=nextTexture}vertexData=sprite.vertexData,uvs=sprite._texture._uvs.uvsUint32,this.renderer.roundPixels?(argb=this.renderer.resolution,float32View[index]=(vertexData[0]*argb|0)/argb,float32View[index+1]=(vertexData[1]*argb|0)/argb,float32View[index+5]=(vertexData[2]*argb|0)/argb,float32View[index+6]=(vertexData[3]*argb|0)/argb,float32View[index+10]=(vertexData[4]*argb|0)/argb,float32View[index+11]=(vertexData[5]*argb|0)/argb,float32View[index+15]=(vertexData[6]*argb|0)/argb,float32View[index+16]=(vertexData[7]*argb|0)/argb):(float32View[index]=vertexData[0],float32View[index+1]=vertexData[1],float32View[index+5]=vertexData[2],float32View[index+6]=vertexData[3],float32View[index+10]=vertexData[4],float32View[index+11]=vertexData[5],float32View[index+15]=vertexData[6],float32View[index+16]=vertexData[7]),uint32View[index+2]=uvs[0],uint32View[index+7]=uvs[1],uint32View[index+12]=uvs[2],uint32View[index+17]=uvs[3];var argb=Math.min(sprite.worldAlpha,1),argb=argb<1&&nextTexture.premultipliedAlpha?(0,_utils.premultiplyTint)(sprite._tintRGB,argb):sprite._tintRGB+(255*argb<<24);uint32View[index+3]=uint32View[index+8]=uint32View[index+13]=uint32View[index+18]=argb,float32View[index+4]=float32View[index+9]=float32View[index+14]=float32View[index+19]=nextTexture._virtalBoundId,index+=20}for(currentGroup.size=i-currentGroup.start,_settings2.default.CAN_UPLOAD_SAME_BUFFER?this.vertexBuffers[this.vertexCount].upload(buffer.vertices,0,!0):(this.vaoMax<=this.vertexCount&&(this.vaoMax++,attrs=this.shader.attributes,vertexBuffer=this.vertexBuffers[this.vertexCount]=_pixiGlCore2.default.GLBuffer.createVertexBuffer(gl,null,gl.STREAM_DRAW),vao=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(vertexBuffer,attrs.aVertexPosition,gl.FLOAT,!1,this.vertByteSize,0).addAttribute(vertexBuffer,attrs.aTextureCoord,gl.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(vertexBuffer,attrs.aColor,gl.UNSIGNED_BYTE,!0,this.vertByteSize,12),attrs.aTextureId&&vao.addAttribute(vertexBuffer,attrs.aTextureId,gl.FLOAT,!1,this.vertByteSize,16),this.vaos[this.vertexCount]=vao),this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].upload(buffer.vertices,0,!1),this.vertexCount++),i=0;i<MAX_TEXTURES;++i)rendererBoundTextures[i]._virtalBoundId=-1;for(i=0;i<groupCount;++i){for(var group=groups[i],groupTextureCount=group.textureCount,_j=0;_j<groupTextureCount;_j++)currentTexture=group.textures[_j],rendererBoundTextures[group.ids[_j]]!==currentTexture&&this.renderer.bindTexture(currentTexture,group.ids[_j],!0),currentTexture._virtalBoundId=-1;this.renderer.state.setBlendMode(group.blend),gl.drawElements(gl.TRIANGLES,6*group.size,gl.UNSIGNED_SHORT,6*group.start*2)}this.currentIndex=0}},SpriteRenderer.prototype.start=function(){this.renderer.bindShader(this.shader),_settings2.default.CAN_UPLOAD_SAME_BUFFER&&(this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].bind())},SpriteRenderer.prototype.stop=function(){this.flush()},SpriteRenderer.prototype.destroy=function(){for(var i=0;i<this.vaoMax;i++)this.vertexBuffers[i]&&this.vertexBuffers[i].destroy(),this.vaos[i]&&this.vaos[i].destroy();this.indexBuffer&&this.indexBuffer.destroy(),this.renderer.off("prerender",this.onPrerender,this),_ObjectRenderer.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.vertexBuffers=null,this.vaos=null,this.indexBuffer=null,this.indices=null,this.sprites=null;for(var _i=0;_i<this.buffers.length;++_i)this.buffers[_i].destroy()},SpriteRenderer}(SpriteRenderer.default);exports.default=SpriteRenderer,_WebGLRenderer2.default.registerPlugin("sprite",SpriteRenderer)},{"../../renderers/webgl/WebGLRenderer":79,"../../renderers/webgl/utils/ObjectRenderer":89,"../../renderers/webgl/utils/checkMaxIfStatmentsInShader":92,"../../settings":96,"../../utils":120,"../../utils/createIndicesForQuads":118,"./BatchBuffer":100,"./generateMultiTextureShader":102,"bit-twiddle":8,"pixi-gl-core":24}],102:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default=function(gl,maxTextures){var shader=fragTemplate;shader=(shader=shader.replace(/%count%/gi,maxTextures)).replace(/%forloop%/gi,function(maxTextures){var src="";src+="\n",src+="\n";for(var i=0;i<maxTextures;i++)0<i&&(src+="\nelse "),i<maxTextures-1&&(src+="if(vTextureId < "+i+".5)"),src+="\n{",src+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",src+="\n}";return src+="\n",src+="\n"}(maxTextures));for(var shader=new _Shader2.default(gl,"precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor;\n}\n",shader),sampleValues=[],i=0;i<maxTextures;i++)sampleValues[i]=i;return shader.bind(),shader.uniforms.uSamplers=sampleValues,shader};var obj,_Shader=require("../../Shader"),_Shader2=(obj=_Shader)&&obj.__esModule?obj:{default:obj};require("path");var fragTemplate=["varying vec2 vTextureCoord;","varying vec4 vColor;","varying float vTextureId;","uniform sampler2D uSamplers[%count%];","void main(void){","vec4 color;","%forloop%","gl_FragColor = color * vColor;","}"].join("\n")},{"../../Shader":39,path:17}],100:[function(require,module,exports){"use strict";exports.__esModule=!0;var Buffer=function(){function Buffer(size){!function(instance){if(!(instance instanceof Buffer))throw new TypeError("Cannot call a class as a function")}(this),this.vertices=new ArrayBuffer(size),this.float32View=new Float32Array(this.vertices),this.uint32View=new Uint32Array(this.vertices)}return Buffer.prototype.destroy=function(){this.vertices=null,this.positions=null,this.uvs=null,this.colors=null},Buffer}();exports.default=Buffer},{}],92:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default=function(maxIfs,gl){var createTempContext=!gl;if(0===maxIfs)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");{var tinyCanvas;createTempContext&&((tinyCanvas=document.createElement("canvas")).width=1,tinyCanvas.height=1,gl=_pixiGlCore2.default.createContext(tinyCanvas))}var shader=gl.createShader(gl.FRAGMENT_SHADER);for(;;){var fragmentSrc=fragTemplate.replace(/%forloop%/gi,function(maxIfs){for(var src="",i=0;i<maxIfs;++i)0<i&&(src+="\nelse "),i<maxIfs-1&&(src+="if(test == "+i+".0){}");return src}(maxIfs));if(gl.shaderSource(shader,fragmentSrc),gl.compileShader(shader),gl.getShaderParameter(shader,gl.COMPILE_STATUS))break;maxIfs=maxIfs/2|0}createTempContext&&gl.getExtension("WEBGL_lose_context")&&gl.getExtension("WEBGL_lose_context").loseContext();return maxIfs};var obj,_pixiGlCore=require("pixi-gl-core"),_pixiGlCore2=(obj=_pixiGlCore)&&obj.__esModule?obj:{default:obj};var fragTemplate=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n")},{"pixi-gl-core":24}],98:[function(CanvasSpriteRenderer,module,exports){"use strict";exports.__esModule=!0;var _CanvasRenderer2=_interopRequireDefault(CanvasSpriteRenderer("../../renderers/canvas/CanvasRenderer")),_const=CanvasSpriteRenderer("../../const"),_math=CanvasSpriteRenderer("../../math"),_CanvasTinter2=_interopRequireDefault(CanvasSpriteRenderer("./CanvasTinter"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var canvasRenderWorldTransform=new _math.Matrix,CanvasSpriteRenderer=function(){function CanvasSpriteRenderer(renderer){!function(instance){if(!(instance instanceof CanvasSpriteRenderer))throw new TypeError("Cannot call a class as a function")}(this),this.renderer=renderer}return CanvasSpriteRenderer.prototype.render=function(sprite){var smoothingEnabled,texture=sprite._texture,renderer=this.renderer,width=texture._frame.width,height=texture._frame.height,resolution=sprite.transform.worldTransform,dx=0,dy=0;texture.orig.width<=0||texture.orig.height<=0||!texture.baseTexture.source||(renderer.setBlendMode(sprite.blendMode),texture.valid&&(renderer.context.globalAlpha=sprite.worldAlpha,smoothingEnabled=texture.baseTexture.scaleMode===_const.SCALE_MODES.LINEAR,renderer.smoothProperty&&renderer.context[renderer.smoothProperty]!==smoothingEnabled&&(renderer.context[renderer.smoothProperty]=smoothingEnabled),dy=texture.trim?(dx=texture.trim.width/2+texture.trim.x-sprite.anchor.x*texture.orig.width,texture.trim.height/2+texture.trim.y-sprite.anchor.y*texture.orig.height):(dx=(.5-sprite.anchor.x)*texture.orig.width,(.5-sprite.anchor.y)*texture.orig.height),texture.rotate&&(resolution.copy(canvasRenderWorldTransform),resolution=canvasRenderWorldTransform,_math.GroupD8.matrixAppendRotationInv(resolution,texture.rotate,dx,dy),dy=dx=0),dx-=width/2,dy-=height/2,renderer.roundPixels?(renderer.context.setTransform(resolution.a,resolution.b,resolution.c,resolution.d,resolution.tx*renderer.resolution|0,resolution.ty*renderer.resolution|0),dx|=0,dy|=0):renderer.context.setTransform(resolution.a,resolution.b,resolution.c,resolution.d,resolution.tx*renderer.resolution,resolution.ty*renderer.resolution),resolution=texture.baseTexture.resolution,16777215!==sprite.tint?(sprite.cachedTint===sprite.tint&&sprite.tintedTexture.tintId===sprite._texture._updateID||(sprite.cachedTint=sprite.tint,sprite.tintedTexture=_CanvasTinter2.default.getTintedTexture(sprite,sprite.tint)),renderer.context.drawImage(sprite.tintedTexture,0,0,width*resolution,height*resolution,dx*renderer.resolution,dy*renderer.resolution,width*renderer.resolution,height*renderer.resolution)):renderer.context.drawImage(texture.baseTexture.source,texture._frame.x*resolution,texture._frame.y*resolution,width*resolution,height*resolution,dx*renderer.resolution,dy*renderer.resolution,width*renderer.resolution,height*renderer.resolution)))},CanvasSpriteRenderer.prototype.destroy=function(){this.renderer=null},CanvasSpriteRenderer}();exports.default=CanvasSpriteRenderer,_CanvasRenderer2.default.registerPlugin("sprite",CanvasSpriteRenderer)},{"../../const":41,"../../math":65,"../../renderers/canvas/CanvasRenderer":72,"./CanvasTinter":99}],99:[function(require,module,exports){"use strict";exports.__esModule=!0;var obj,_utils=require("../../utils"),_canUseNewCanvasBlendModes=require("../../renderers/canvas/utils/canUseNewCanvasBlendModes");var CanvasTinter={getTintedTexture:function(canvas,tintImage){var texture=canvas._texture,stringColor="#"+("00000"+(0|(tintImage=CanvasTinter.roundColor(tintImage))).toString(16)).substr(-6);texture.tintCache=texture.tintCache||{};var cachedTexture=texture.tintCache[stringColor],canvas=void 0;if(cachedTexture){if(cachedTexture.tintId===texture._updateID)return texture.tintCache[stringColor];canvas=texture.tintCache[stringColor]}else canvas=CanvasTinter.canvas||document.createElement("canvas");return CanvasTinter.tintMethod(texture,tintImage,canvas),canvas.tintId=texture._updateID,CanvasTinter.convertTintToImage?((tintImage=new Image).src=canvas.toDataURL(),texture.tintCache[stringColor]=tintImage):(texture.tintCache[stringColor]=canvas,CanvasTinter.canvas=null),canvas},tintWithMultiply:function(texture,color,canvas){var context=canvas.getContext("2d"),crop=texture._frame.clone(),resolution=texture.baseTexture.resolution;crop.x*=resolution,crop.y*=resolution,crop.width*=resolution,crop.height*=resolution,canvas.width=Math.ceil(crop.width),canvas.height=Math.ceil(crop.height),context.save(),context.fillStyle="#"+("00000"+(0|color).toString(16)).substr(-6),context.fillRect(0,0,crop.width,crop.height),context.globalCompositeOperation="multiply",context.drawImage(texture.baseTexture.source,crop.x,crop.y,crop.width,crop.height,0,0,crop.width,crop.height),context.globalCompositeOperation="destination-atop",context.drawImage(texture.baseTexture.source,crop.x,crop.y,crop.width,crop.height,0,0,crop.width,crop.height),context.restore()},tintWithOverlay:function(texture,color,canvas){var context=canvas.getContext("2d"),crop=texture._frame.clone(),resolution=texture.baseTexture.resolution;crop.x*=resolution,crop.y*=resolution,crop.width*=resolution,crop.height*=resolution,canvas.width=Math.ceil(crop.width),canvas.height=Math.ceil(crop.height),context.save(),context.globalCompositeOperation="copy",context.fillStyle="#"+("00000"+(0|color).toString(16)).substr(-6),context.fillRect(0,0,crop.width,crop.height),context.globalCompositeOperation="destination-atop",context.drawImage(texture.baseTexture.source,crop.x,crop.y,crop.width,crop.height,0,0,crop.width,crop.height),context.restore()},tintWithPerPixel:function(texture,rgbValues,canvas){var context=canvas.getContext("2d"),pixelData=texture._frame.clone(),resolution=texture.baseTexture.resolution;pixelData.x*=resolution,pixelData.y*=resolution,pixelData.width*=resolution,pixelData.height*=resolution,canvas.width=Math.ceil(pixelData.width),canvas.height=Math.ceil(pixelData.height),context.save(),context.globalCompositeOperation="copy",context.drawImage(texture.baseTexture.source,pixelData.x,pixelData.y,pixelData.width,pixelData.height,0,0,pixelData.width,pixelData.height),context.restore();for(var rgbValues=(0,_utils.hex2rgb)(rgbValues),r=rgbValues[0],g=rgbValues[1],b=rgbValues[2],pixelData=context.getImageData(0,0,pixelData.width,pixelData.height),pixels=pixelData.data,i=0;i<pixels.length;i+=4)pixels[i+0]*=r,pixels[i+1]*=g,pixels[i+2]*=b;context.putImageData(pixelData,0,0)},roundColor:function(rgbValues){var step=CanvasTinter.cacheStepsPerColorChannel,rgbValues=(0,_utils.hex2rgb)(rgbValues);return rgbValues[0]=Math.min(255,rgbValues[0]/step*step),rgbValues[1]=Math.min(255,rgbValues[1]/step*step),rgbValues[2]=Math.min(255,rgbValues[2]/step*step),(0,_utils.rgb2hex)(rgbValues)},cacheStepsPerColorChannel:8,convertTintToImage:!1,canUseMultiply:(0,((obj=_canUseNewCanvasBlendModes)&&obj.__esModule?obj:{default:obj}).default)(),tintMethod:0};CanvasTinter.tintMethod=CanvasTinter.canUseMultiply?CanvasTinter.tintWithMultiply:CanvasTinter.tintWithPerPixel,exports.default=CanvasTinter},{"../../renderers/canvas/utils/canUseNewCanvasBlendModes":75,"../../utils":120}],52:[function(GraphicsRenderer,module,exports){"use strict";exports.__esModule=!0;var _utils=GraphicsRenderer("../../utils"),_const=GraphicsRenderer("../../const"),_ObjectRenderer3=_interopRequireDefault(GraphicsRenderer("../../renderers/webgl/utils/ObjectRenderer")),_WebGLRenderer2=_interopRequireDefault(GraphicsRenderer("../../renderers/webgl/WebGLRenderer")),_WebGLGraphicsData2=_interopRequireDefault(GraphicsRenderer("./WebGLGraphicsData")),_PrimitiveShader2=_interopRequireDefault(GraphicsRenderer("./shaders/PrimitiveShader")),_buildPoly2=_interopRequireDefault(GraphicsRenderer("./utils/buildPoly")),_buildRectangle2=_interopRequireDefault(GraphicsRenderer("./utils/buildRectangle")),_buildRoundedRectangle2=_interopRequireDefault(GraphicsRenderer("./utils/buildRoundedRectangle")),_buildCircle2=_interopRequireDefault(GraphicsRenderer("./utils/buildCircle"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}GraphicsRenderer=function(_ObjectRenderer){function GraphicsRenderer(renderer){!function(instance){if(!(instance instanceof GraphicsRenderer))throw new TypeError("Cannot call a class as a function")}(this);var _this=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_ObjectRenderer.call(this,renderer));return _this.graphicsDataPool=[],_this.primitiveShader=null,_this.gl=renderer.gl,_this.CONTEXT_UID=0,_this}return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(GraphicsRenderer,_ObjectRenderer),GraphicsRenderer.prototype.onContextChange=function(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.primitiveShader=new _PrimitiveShader2.default(this.gl)},GraphicsRenderer.prototype.destroy=function(){_ObjectRenderer3.default.prototype.destroy.call(this);for(var i=0;i<this.graphicsDataPool.length;++i)this.graphicsDataPool[i].destroy();this.graphicsDataPool=null},GraphicsRenderer.prototype.render=function(graphics){var renderer=this.renderer,gl=renderer.gl,webGLData=void 0,webGL=graphics._webGL[this.CONTEXT_UID];webGL&&graphics.dirty===webGL.dirty||(this.updateGraphics(graphics),webGL=graphics._webGL[this.CONTEXT_UID]);var shader=this.primitiveShader;renderer.bindShader(shader),renderer.state.setBlendMode(graphics.blendMode);for(var i=0,n=webGL.data.length;i<n;i++){var shaderTemp=(webGLData=webGL.data[i]).shader;renderer.bindShader(shaderTemp),shaderTemp.uniforms.translationMatrix=graphics.transform.worldTransform.toArray(!0),shaderTemp.uniforms.tint=(0,_utils.hex2rgb)(graphics.tint),shaderTemp.uniforms.alpha=graphics.worldAlpha,renderer.bindVao(webGLData.vao),webGLData.nativeLines?gl.drawArrays(gl.LINES,0,webGLData.points.length/6):webGLData.vao.draw(gl.TRIANGLE_STRIP,webGLData.indices.length)}},GraphicsRenderer.prototype.updateGraphics=function(graphics){var gl=this.renderer.gl,webGL=graphics._webGL[this.CONTEXT_UID];if((webGL=webGL||(graphics._webGL[this.CONTEXT_UID]={lastIndex:0,data:[],gl:gl,clearDirty:-1,dirty:-1})).dirty=graphics.dirty,graphics.clearDirty!==webGL.clearDirty){webGL.clearDirty=graphics.clearDirty;for(var i=0;i<webGL.data.length;i++)this.graphicsDataPool.push(webGL.data[i]);webGL.data.length=0,webGL.lastIndex=0}for(var webGLData=void 0,webGLDataNativeLines=void 0,_i=webGL.lastIndex;_i<graphics.graphicsData.length;_i++){var data=graphics.graphicsData[_i],webGLData=this.getWebGLData(webGL,0);data.nativeLines&&data.lineWidth&&(webGLDataNativeLines=this.getWebGLData(webGL,0,!0),webGL.lastIndex++),data.type===_const.SHAPES.POLY&&(0,_buildPoly2.default)(data,webGLData,webGLDataNativeLines),data.type===_const.SHAPES.RECT?(0,_buildRectangle2.default)(data,webGLData,webGLDataNativeLines):data.type===_const.SHAPES.CIRC||data.type===_const.SHAPES.ELIP?(0,_buildCircle2.default)(data,webGLData,webGLDataNativeLines):data.type===_const.SHAPES.RREC&&(0,_buildRoundedRectangle2.default)(data,webGLData,webGLDataNativeLines),webGL.lastIndex++}this.renderer.bindVao(null);for(var _i2=0;_i2<webGL.data.length;_i2++)(webGLData=webGL.data[_i2]).dirty&&webGLData.upload()},GraphicsRenderer.prototype.getWebGLData=function(gl,type,nativeLines){var webGLData=gl.data[gl.data.length-1];return(!webGLData||webGLData.nativeLines!==nativeLines||32e4<webGLData.points.length)&&((webGLData=this.graphicsDataPool.pop()||new _WebGLGraphicsData2.default(this.renderer.gl,this.primitiveShader,this.renderer.state.attribsState)).nativeLines=nativeLines,webGLData.reset(type),gl.data.push(webGLData)),webGLData.dirty=!0,webGLData},GraphicsRenderer}(_ObjectRenderer3.default);exports.default=GraphicsRenderer,_WebGLRenderer2.default.registerPlugin("graphics",GraphicsRenderer)},{"../../const":41,"../../renderers/webgl/WebGLRenderer":79,"../../renderers/webgl/utils/ObjectRenderer":89,"../../utils":120,"./WebGLGraphicsData":53,"./shaders/PrimitiveShader":54,"./utils/buildCircle":55,"./utils/buildPoly":57,"./utils/buildRectangle":58,"./utils/buildRoundedRectangle":59}],59:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default=function(graphicsData,webGLData,webGLDataNativeLines){var radius=graphicsData.shape,x=radius.x,y=radius.y,width=radius.width,height=radius.height,radius=radius.radius,recPoints=[];if(recPoints.push(x+radius,y),quadraticBezierCurve(x+width-radius,y,x+width,y,x+width,y+radius,recPoints),quadraticBezierCurve(x+width,y+height-radius,x+width,y+height,x+width-radius,y+height,recPoints),quadraticBezierCurve(x+radius,y+height,x,y+height,x,y+height-radius,recPoints),quadraticBezierCurve(x,y+radius,x,y,x+radius+1e-10,y,recPoints),graphicsData.fill){for(var tempPoints=(0,_utils.hex2rgb)(graphicsData.fillColor),alpha=graphicsData.fillAlpha,r=tempPoints[0]*alpha,g=tempPoints[1]*alpha,b=tempPoints[2]*alpha,verts=webGLData.points,indices=webGLData.indices,vecPos=verts.length/6,triangles=(0,_earcut2.default)(recPoints,null,2),i=0,j=triangles.length;i<j;i+=3)indices.push(triangles[i]+vecPos),indices.push(triangles[i]+vecPos),indices.push(triangles[i+1]+vecPos),indices.push(triangles[i+2]+vecPos),indices.push(triangles[i+2]+vecPos);for(var _i=0,_j=recPoints.length;_i<_j;_i++)verts.push(recPoints[_i],recPoints[++_i],r,g,b,alpha)}graphicsData.lineWidth&&(tempPoints=graphicsData.points,graphicsData.points=recPoints,(0,_buildLine2.default)(graphicsData,webGLData,webGLDataNativeLines),graphicsData.points=tempPoints)};var _earcut2=_interopRequireDefault(require("earcut")),_buildLine2=_interopRequireDefault(require("./buildLine")),_utils=require("../../../utils");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getPt(n1,n2,perc){return n1+(n2-n1)*perc}function quadraticBezierCurve(fromX,fromY,cpX,cpY,toX,toY,argument_6){for(var xa,ya,xb,yb,x,y,j,points=6<arguments.length&&void 0!==argument_6?argument_6:[],i=0;i<=20;++i)xa=getPt(fromX,cpX,j=i/20),ya=getPt(fromY,cpY,j),xb=getPt(cpX,toX,j),yb=getPt(cpY,toY,j),x=getPt(xa,xb,j),y=getPt(ya,yb,j),points.push(x,y);return points}},{"../../../utils":120,"./buildLine":56,earcut:9}],58:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default=function(graphicsData,webGLData,webGLDataNativeLines){var indices=graphicsData.shape,x=indices.x,y=indices.y,width=indices.width,height=indices.height;{var alpha,r,g,b,verts;graphicsData.fill&&(tempPoints=(0,_utils.hex2rgb)(graphicsData.fillColor),alpha=graphicsData.fillAlpha,r=tempPoints[0]*alpha,g=tempPoints[1]*alpha,b=tempPoints[2]*alpha,verts=webGLData.points,indices=webGLData.indices,tempPoints=verts.length/6,verts.push(x,y),verts.push(r,g,b,alpha),verts.push(x+width,y),verts.push(r,g,b,alpha),verts.push(x,y+height),verts.push(r,g,b,alpha),verts.push(x+width,y+height),verts.push(r,g,b,alpha),indices.push(tempPoints,tempPoints,1+tempPoints,2+tempPoints,3+tempPoints,3+tempPoints))}{var tempPoints;graphicsData.lineWidth&&(tempPoints=graphicsData.points,graphicsData.points=[x,y,x+width,y,x+width,y+height,x,y+height,x,y],(0,_buildLine2.default)(graphicsData,webGLData,webGLDataNativeLines),graphicsData.points=tempPoints)}};var obj,_buildLine=require("./buildLine"),_buildLine2=(obj=_buildLine)&&obj.__esModule?obj:{default:obj},_utils=require("../../../utils")},{"../../../utils":120,"./buildLine":56}],57:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default=function(graphicsData,webGLData,webGLDataNativeLines){graphicsData.points=graphicsData.shape.points.slice();var points=graphicsData.points;if(graphicsData.fill&&6<=points.length){for(var holeArray=[],holes=graphicsData.holes,i=0;i<holes.length;i++){var hole=holes[i];holeArray.push(points.length/2),points=points.concat(hole.points)}var verts=webGLData.points,indices=webGLData.indices,length=points.length/2,color=(0,_utils.hex2rgb)(graphicsData.fillColor),alpha=graphicsData.fillAlpha,r=color[0]*alpha,g=color[1]*alpha,b=color[2]*alpha,triangles=(0,_earcut2.default)(points,holeArray,2);if(!triangles)return;for(var vertPos=verts.length/6,_i=0;_i<triangles.length;_i+=3)indices.push(triangles[_i]+vertPos),indices.push(triangles[_i]+vertPos),indices.push(triangles[_i+1]+vertPos),indices.push(triangles[_i+2]+vertPos),indices.push(triangles[_i+2]+vertPos);for(var _i2=0;_i2<length;_i2++)verts.push(points[2*_i2],points[2*_i2+1],r,g,b,alpha)}0<graphicsData.lineWidth&&(0,_buildLine2.default)(graphicsData,webGLData,webGLDataNativeLines)};var _buildLine2=_interopRequireDefault(require("./buildLine")),_utils=require("../../../utils"),_earcut2=_interopRequireDefault(require("earcut"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"../../../utils":120,"./buildLine":56,earcut:9}],55:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default=function(graphicsData,webGLData,webGLDataNativeLines){var circleData=graphicsData.shape,x=circleData.x,y=circleData.y,width=void 0,height=void 0;height=graphicsData.type===_const.SHAPES.CIRC?(width=circleData.radius,circleData.radius):(width=circleData.width,circleData.height);if(0===width||0===height)return;var totalSegs=Math.floor(30*Math.sqrt(circleData.radius))||Math.floor(15*Math.sqrt(circleData.width+circleData.height)),seg=2*Math.PI/totalSegs;if(graphicsData.fill){var tempPoints=(0,_utils.hex2rgb)(graphicsData.fillColor),alpha=graphicsData.fillAlpha,r=tempPoints[0]*alpha,g=tempPoints[1]*alpha,b=tempPoints[2]*alpha,verts=webGLData.points,indices=webGLData.indices,vecPos=verts.length/6;indices.push(vecPos);for(var i=0;i<totalSegs+1;i++)verts.push(x,y,r,g,b,alpha),verts.push(x+Math.sin(seg*i)*width,y+Math.cos(seg*i)*height,r,g,b,alpha),indices.push(vecPos++,vecPos++);indices.push(vecPos-1)}if(graphicsData.lineWidth){tempPoints=graphicsData.points;graphicsData.points=[];for(var _i=0;_i<totalSegs;_i++)graphicsData.points.push(x+Math.sin(seg*-_i)*width,y+Math.cos(seg*-_i)*height);graphicsData.points.push(graphicsData.points[0],graphicsData.points[1]),(0,_buildLine2.default)(graphicsData,webGLData,webGLDataNativeLines),graphicsData.points=tempPoints}};var obj,_buildLine=require("./buildLine"),_buildLine2=(obj=_buildLine)&&obj.__esModule?obj:{default:obj},_const=require("../../../const"),_utils=require("../../../utils")},{"../../../const":41,"../../../utils":120,"./buildLine":56}],56:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default=function(graphicsData,webGLData,webGLDataNativeLines){graphicsData.nativeLines?function(graphicsData,color){var i=0,points=graphicsData.points;if(0!==points.length){var verts=color.points,length=points.length/2,color=(0,_utils.hex2rgb)(graphicsData.lineColor),alpha=graphicsData.lineAlpha,r=color[0]*alpha,g=color[1]*alpha,b=color[2]*alpha;for(i=1;i<length;i++){var p1x=points[2*(i-1)],p1y=points[2*(i-1)+1],p2x=points[2*i],p2y=points[2*i+1];verts.push(p1x,p1y),verts.push(r,g,b,alpha),verts.push(p2x,p2y),verts.push(r,g,b,alpha)}}}(graphicsData,webGLDataNativeLines):function(ratio,color){var points=ratio.points;if(0!==points.length){var midPointX,firstPoint=new _math.Point(points[0],points[1]),midPointY=new _math.Point(points[points.length-2],points[points.length-1]);firstPoint.x===midPointY.x&&firstPoint.y===midPointY.y&&((points=points.slice()).pop(),points.pop(),midPointX=(midPointY=new _math.Point(points[points.length-2],points[points.length-1])).x+.5*(firstPoint.x-midPointY.x),midPointY=midPointY.y+.5*(firstPoint.y-midPointY.y),points.unshift(midPointX,midPointY),points.push(midPointX,midPointY));var verts=color.points,indices=color.indices,length=points.length/2,indexCount=points.length,indexStart=verts.length/6,width=ratio.lineWidth/2,color=(0,_utils.hex2rgb)(ratio.lineColor),alpha=ratio.lineAlpha,r=color[0]*alpha,g=color[1]*alpha,b=color[2]*alpha,p1x=points[0],p1y=points[1],p2x=points[2],p2y=points[3],p3x=0,p3y=0,perpx=-(p1y-p2y),perpy=p1x-p2x,perp2x=0,perp2y=0,perp3x=0,perp3y=0,dist=Math.sqrt(perpx*perpx+perpy*perpy);perpx/=dist,perpy/=dist,perpx*=width,perpy*=width;var r1=2*(1-(ratio=ratio.lineAlignment)),r2=2*ratio;verts.push(p1x-perpx*r1,p1y-perpy*r1,r,g,b,alpha),verts.push(p1x+perpx*r2,p1y+perpy*r2,r,g,b,alpha);for(var i=1;i<length-1;++i){p1x=points[2*(i-1)],p1y=points[2*(i-1)+1],p2x=points[2*i],p2y=points[2*i+1],p3x=points[2*(i+1)],p3y=points[2*(i+1)+1],perpx=-(p1y-p2y),perpy=p1x-p2x,dist=Math.sqrt(perpx*perpx+perpy*perpy),perpx/=dist,perpy/=dist,perpx*=width,perpy*=width,perp2x=-(p2y-p3y),perp2y=p2x-p3x,dist=Math.sqrt(perp2x*perp2x+perp2y*perp2y),perp2x/=dist,perp2y/=dist;var a1=-perpy+p1y-(-perpy+p2y),b1=-perpx+p2x-(-perpx+p1x),c1=(-perpx+p1x)*(-perpy+p2y)-(-perpx+p2x)*(-perpy+p1y),a2=-(perp2y*=width)+p3y-(-perp2y+p2y),px=-(perp2x*=width)+p2x-(-perp2x+p3x),c2=(-perp2x+p3x)*(-perp2y+p2y)-(-perp2x+p2x)*(-perp2y+p3y),py=a1*px-a2*b1;Math.abs(py)<.1?(py+=10.1,verts.push(p2x-perpx*r1,p2y-perpy*r1,r,g,b,alpha),verts.push(p2x+perpx*r2,p2y+perpy*r2,r,g,b,alpha)):196*width*width<((px=(b1*c2-px*c1)/py)-p2x)*(px-p2x)+((py=(a2*c1-a1*c2)/py)-p2y)*(py-p2y)?(perp3x=perpx-perp2x,perp3y=perpy-perp2y,dist=Math.sqrt(perp3x*perp3x+perp3y*perp3y),perp3x/=dist,perp3y/=dist,perp3x*=width,perp3y*=width,verts.push(p2x-perp3x*r1,p2y-perp3y*r1),verts.push(r,g,b,alpha),verts.push(p2x+perp3x*r2,p2y+perp3y*r2),verts.push(r,g,b,alpha),verts.push(p2x-perp3x*r2*r1,p2y-perp3y*r1),verts.push(r,g,b,alpha),indexCount++):(verts.push(p2x+(px-p2x)*r1,p2y+(py-p2y)*r1),verts.push(r,g,b,alpha),verts.push(p2x-(px-p2x)*r2,p2y-(py-p2y)*r2),verts.push(r,g,b,alpha))}p1x=points[2*(length-2)],p1y=points[2*(length-2)+1],p2x=points[2*(length-1)],p2y=points[2*(length-1)+1],perpx=-(p1y-p2y),perpy=p1x-p2x,dist=Math.sqrt(perpx*perpx+perpy*perpy),perpx/=dist,perpy/=dist,perpx*=width,perpy*=width,verts.push(p2x-perpx*r1,p2y-perpy*r1),verts.push(r,g,b,alpha),verts.push(p2x+perpx*r2,p2y+perpy*r2),verts.push(r,g,b,alpha),indices.push(indexStart);for(var _i=0;_i<indexCount;++_i)indices.push(indexStart++);indices.push(indexStart-1)}}(graphicsData,webGLData)};var _math=require("../../../math"),_utils=require("../../../utils")},{"../../../math":65,"../../../utils":120}],54:[function(PrimitiveShader,module,exports){"use strict";exports.__esModule=!0;var obj,_Shader2=PrimitiveShader("../../../Shader");PrimitiveShader=function(_Shader){function PrimitiveShader(gl){return function(instance){if(!(instance instanceof PrimitiveShader))throw new TypeError("Cannot call a class as a function")}(this),function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_Shader.call(this,gl,["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"].join("\n"),["varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n")))}return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(PrimitiveShader,_Shader),PrimitiveShader}(((obj=_Shader2)&&obj.__esModule?obj:{default:obj}).default);exports.default=PrimitiveShader},{"../../../Shader":39}],53:[function(WebGLGraphicsData,module,exports){"use strict";exports.__esModule=!0;var obj,_pixiGlCore=WebGLGraphicsData("pixi-gl-core"),_pixiGlCore2=(obj=_pixiGlCore)&&obj.__esModule?obj:{default:obj};WebGLGraphicsData=function(){function WebGLGraphicsData(gl,shader,attribsState){!function(instance){if(!(instance instanceof WebGLGraphicsData))throw new TypeError("Cannot call a class as a function")}(this),this.gl=gl,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=_pixiGlCore2.default.GLBuffer.createVertexBuffer(gl),this.indexBuffer=_pixiGlCore2.default.GLBuffer.createIndexBuffer(gl),this.dirty=!0,this.nativeLines=!1,this.glPoints=null,this.glIndices=null,this.shader=shader,this.vao=new _pixiGlCore2.default.VertexArrayObject(gl,attribsState).addIndex(this.indexBuffer).addAttribute(this.buffer,shader.attributes.aVertexPosition,gl.FLOAT,!1,24,0).addAttribute(this.buffer,shader.attributes.aColor,gl.FLOAT,!1,24,8)}return WebGLGraphicsData.prototype.reset=function(){this.points.length=0,this.indices.length=0},WebGLGraphicsData.prototype.upload=function(){this.glPoints=new Float32Array(this.points),this.buffer.upload(this.glPoints),this.glIndices=new Uint16Array(this.indices),this.indexBuffer.upload(this.glIndices),this.dirty=!1},WebGLGraphicsData.prototype.destroy=function(){this.color=null,this.points=null,this.indices=null,this.vao.destroy(),this.buffer.destroy(),this.indexBuffer.destroy(),this.gl=null,this.buffer=null,this.indexBuffer=null,this.glPoints=null,this.glIndices=null},WebGLGraphicsData}();exports.default=WebGLGraphicsData},{"pixi-gl-core":24}],50:[function(CanvasGraphicsRenderer,module,exports){"use strict";exports.__esModule=!0;var obj,_CanvasRenderer=CanvasGraphicsRenderer("../../renderers/canvas/CanvasRenderer"),_CanvasRenderer2=(obj=_CanvasRenderer)&&obj.__esModule?obj:{default:obj},_const=CanvasGraphicsRenderer("../../const");CanvasGraphicsRenderer=function(){function CanvasGraphicsRenderer(renderer){!function(instance){if(!(instance instanceof CanvasGraphicsRenderer))throw new TypeError("Cannot call a class as a function")}(this),this.renderer=renderer}return CanvasGraphicsRenderer.prototype.render=function(graphics){var renderer=this.renderer,context=renderer.context,worldAlpha=graphics.worldAlpha,transform=graphics.transform.worldTransform,resolution=renderer.resolution;context.setTransform(transform.a*resolution,transform.b*resolution,transform.c*resolution,transform.d*resolution,transform.tx*resolution,transform.ty*resolution),graphics.canvasTintDirty===graphics.dirty&&graphics._prevTint===graphics.tint||this.updateGraphicsTint(graphics),renderer.setBlendMode(graphics.blendMode);for(var i=0;i<graphics.graphicsData.length;i++){var y,xe,xm,rx,ry,width,height,radius,data=graphics.graphicsData[i],maxRadius=data.shape,fillColor=data._fillTint,lineColor=data._lineTint;if(context.lineWidth=data.lineWidth,data.type===_const.SHAPES.POLY){context.beginPath();var points=maxRadius.points,holes=data.holes,outerArea=void 0,innerArea=void 0,px=void 0,py=void 0;context.moveTo(points[0],points[1]);for(var j=2;j<points.length;j+=2)context.lineTo(points[j],points[j+1]);if(maxRadius.closed&&context.closePath(),0<holes.length){px=points[outerArea=0],py=points[1];for(var _j=2;_j+2<points.length;_j+=2)outerArea+=(points[_j]-px)*(points[_j+3]-py)-(points[_j+2]-px)*(points[_j+1]-py);for(var k=0;k<holes.length;k++)if(points=holes[k].points){px=points[innerArea=0],py=points[1];for(var _j2=2;_j2+2<points.length;_j2+=2)innerArea+=(points[_j2]-px)*(points[_j2+3]-py)-(points[_j2+2]-px)*(points[_j2+1]-py);if(innerArea*outerArea<0){context.moveTo(points[0],points[1]);for(var _j3=2;_j3<points.length;_j3+=2)context.lineTo(points[_j3],points[_j3+1])}else{context.moveTo(points[points.length-2],points[points.length-1]);for(var _j4=points.length-4;0<=_j4;_j4-=2)context.lineTo(points[_j4],points[_j4+1])}holes[k].close&&context.closePath()}}data.fill&&(context.globalAlpha=data.fillAlpha*worldAlpha,context.fillStyle="#"+("00000"+(0|fillColor).toString(16)).substr(-6),context.fill()),data.lineWidth&&(context.globalAlpha=data.lineAlpha*worldAlpha,context.strokeStyle="#"+("00000"+(0|lineColor).toString(16)).substr(-6),context.stroke())}else data.type===_const.SHAPES.RECT?(!data.fillColor&&0!==data.fillColor||(context.globalAlpha=data.fillAlpha*worldAlpha,context.fillStyle="#"+("00000"+(0|fillColor).toString(16)).substr(-6),context.fillRect(maxRadius.x,maxRadius.y,maxRadius.width,maxRadius.height)),data.lineWidth&&(context.globalAlpha=data.lineAlpha*worldAlpha,context.strokeStyle="#"+("00000"+(0|lineColor).toString(16)).substr(-6),context.strokeRect(maxRadius.x,maxRadius.y,maxRadius.width,maxRadius.height))):data.type===_const.SHAPES.CIRC?(context.beginPath(),context.arc(maxRadius.x,maxRadius.y,maxRadius.radius,0,2*Math.PI),context.closePath(),data.fill&&(context.globalAlpha=data.fillAlpha*worldAlpha,context.fillStyle="#"+("00000"+(0|fillColor).toString(16)).substr(-6),context.fill()),data.lineWidth&&(context.globalAlpha=data.lineAlpha*worldAlpha,context.strokeStyle="#"+("00000"+(0|lineColor).toString(16)).substr(-6),context.stroke())):data.type===_const.SHAPES.ELIP?(xm=2*maxRadius.width,radius=2*maxRadius.height,height=maxRadius.x-xm/2,y=maxRadius.y-radius/2,context.beginPath(),rx=xm/2*.5522848,width=radius/2*.5522848,xe=height+xm,ry=y+radius,xm=height+xm/2,radius=y+radius/2,context.moveTo(height,radius),context.bezierCurveTo(height,radius-width,xm-rx,y,xm,y),context.bezierCurveTo(xm+rx,y,xe,radius-width,xe,radius),context.bezierCurveTo(xe,radius+width,xm+rx,ry,xm,ry),context.bezierCurveTo(xm-rx,ry,height,radius+width,height,radius),context.closePath(),data.fill&&(context.globalAlpha=data.fillAlpha*worldAlpha,context.fillStyle="#"+("00000"+(0|fillColor).toString(16)).substr(-6),context.fill()),data.lineWidth&&(context.globalAlpha=data.lineAlpha*worldAlpha,context.strokeStyle="#"+("00000"+(0|lineColor).toString(16)).substr(-6),context.stroke())):data.type===_const.SHAPES.RREC&&(rx=maxRadius.x,ry=maxRadius.y,width=maxRadius.width,height=maxRadius.height,radius=maxRadius.radius,radius=(maxRadius=Math.min(width,height)/2|0)<radius?maxRadius:radius,context.beginPath(),context.moveTo(rx,ry+radius),context.lineTo(rx,ry+height-radius),context.quadraticCurveTo(rx,ry+height,rx+radius,ry+height),context.lineTo(rx+width-radius,ry+height),context.quadraticCurveTo(rx+width,ry+height,rx+width,ry+height-radius),context.lineTo(rx+width,ry+radius),context.quadraticCurveTo(rx+width,ry,rx+width-radius,ry),context.lineTo(rx+radius,ry),context.quadraticCurveTo(rx,ry,rx,ry+radius),context.closePath(),!data.fillColor&&0!==data.fillColor||(context.globalAlpha=data.fillAlpha*worldAlpha,context.fillStyle="#"+("00000"+(0|fillColor).toString(16)).substr(-6),context.fill()),data.lineWidth&&(context.globalAlpha=data.lineAlpha*worldAlpha,context.strokeStyle="#"+("00000"+(0|lineColor).toString(16)).substr(-6),context.stroke()))}},CanvasGraphicsRenderer.prototype.updateGraphicsTint=function(graphics){graphics._prevTint=graphics.tint,graphics.canvasTintDirty=graphics.dirty;for(var tintR=(graphics.tint>>16&255)/255,tintG=(graphics.tint>>8&255)/255,tintB=(255&graphics.tint)/255,i=0;i<graphics.graphicsData.length;++i){var data=graphics.graphicsData[i],fillColor=0|data.fillColor,lineColor=0|data.lineColor;data._fillTint=((fillColor>>16&255)/255*tintR*255<<16)+((fillColor>>8&255)/255*tintG*255<<8)+(255&fillColor)/255*tintB*255,data._lineTint=((lineColor>>16&255)/255*tintR*255<<16)+((lineColor>>8&255)/255*tintG*255<<8)+(255&lineColor)/255*tintB*255}},CanvasGraphicsRenderer.prototype.renderPolygon=function(points,close,context){context.moveTo(points[0],points[1]);for(var j=1;j<points.length/2;++j)context.lineTo(points[2*j],points[2*j+1]);close&&context.closePath()},CanvasGraphicsRenderer.prototype.destroy=function(){this.renderer=null},CanvasGraphicsRenderer}();exports.default=CanvasGraphicsRenderer,_CanvasRenderer2.default.registerPlugin("graphics",CanvasGraphicsRenderer)},{"../../const":41,"../../renderers/canvas/CanvasRenderer":72}],48:[function(require,module,exports){"use strict";exports.__esModule=!0;var Graphics=_interopRequireDefault(require("../display/Container")),_RenderTexture2=_interopRequireDefault(require("../textures/RenderTexture")),_Texture2=_interopRequireDefault(require("../textures/Texture")),_GraphicsData2=_interopRequireDefault(require("./GraphicsData")),_Sprite2=_interopRequireDefault(require("../sprites/Sprite")),_math=require("../math"),_utils=require("../utils"),_const=require("../const"),_Bounds2=_interopRequireDefault(require("../display/Bounds")),_bezierCurveTo3=_interopRequireDefault(require("./utils/bezierCurveTo")),_CanvasRenderer2=_interopRequireDefault(require("../renderers/canvas/CanvasRenderer"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var canvasRenderer=void 0,tempMatrix=new _math.Matrix,tempPoint=new _math.Point,tempColor1=new Float32Array(4),tempColor2=new Float32Array(4),Graphics=function(_Container){function Graphics(){var nativeLines=0<arguments.length&&void 0!==arguments[0]&&arguments[0];!function(instance){if(!(instance instanceof Graphics))throw new TypeError("Cannot call a class as a function")}(this);var _this=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_Container.call(this));return _this.fillAlpha=1,_this.lineWidth=0,_this.nativeLines=nativeLines,_this.lineColor=0,_this.lineAlignment=.5,_this.graphicsData=[],_this.tint=16777215,_this._prevTint=16777215,_this.blendMode=_const.BLEND_MODES.NORMAL,_this.currentPath=null,_this._webGL={},_this.isMask=!1,_this.boundsPadding=0,_this._localBounds=new _Bounds2.default,_this.dirty=0,_this.fastRectDirty=-1,_this.clearDirty=0,_this.boundsDirty=-1,_this.cachedSpriteDirty=!1,_this._spriteRect=null,_this._fastRect=!1,_this._prevRectTint=null,_this._prevRectFillColor=null,_this}return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(Graphics,_Container),Graphics.prototype.clone=function(){var clone=new Graphics;clone.renderable=this.renderable,clone.fillAlpha=this.fillAlpha,clone.lineWidth=this.lineWidth,clone.lineColor=this.lineColor,clone.lineAlignment=this.lineAlignment,clone.tint=this.tint,clone.blendMode=this.blendMode,clone.isMask=this.isMask,clone.boundsPadding=this.boundsPadding,clone.dirty=0,clone.cachedSpriteDirty=this.cachedSpriteDirty;for(var i=0;i<this.graphicsData.length;++i)clone.graphicsData.push(this.graphicsData[i].clone());return clone.currentPath=clone.graphicsData[clone.graphicsData.length-1],clone.updateLocalBounds(),clone},Graphics.prototype._quadraticCurveLength=function(b,s,a,c,c2,ba){var a2=b-2*a+c2,a32=s-2*c+ba,c2=2*a-2*b,ba=2*c-2*s,a=4*(a2*a2+a32*a32),b=4*(a2*c2+a32*ba),c=c2*c2+ba*ba,s=2*Math.sqrt(a+b+c),a2=Math.sqrt(a),a32=2*a*a2,c2=2*Math.sqrt(c),ba=b/a2;return(a32*s+a2*b*(s-c2)+(4*c*a-b*b)*Math.log((2*a2+ba+s)/(ba+c2)))/(4*a32)},Graphics.prototype._bezierCurveLength=function(fromX,fromY,cpX,cpY,cpX2,cpY2,toX,toY){for(var t,t2,t3,nt,nt2,nt3,x,y,dx,dy,result=0,prevX=fromX,prevY=fromY,i=1;i<=10;++i)dx=prevX-(x=(nt3=(nt2=(nt=1-(t=i/10))*nt)*nt)*fromX+3*nt2*t*cpX+3*nt*(t2=t*t)*cpX2+(t3=t2*t)*toX),dy=prevY-(y=nt3*fromY+3*nt2*t*cpY+3*nt*t2*cpY2+t3*toY),prevX=x,prevY=y,result+=Math.sqrt(dx*dx+dy*dy);return result},Graphics.prototype._segmentsCount=function(result){result=Math.ceil(result/Graphics.CURVES.maxLength);return result<Graphics.CURVES.minSegments?result=Graphics.CURVES.minSegments:result>Graphics.CURVES.maxSegments&&(result=Graphics.CURVES.maxSegments),result},Graphics.prototype.lineStyle=function(){var lineWidth=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,color=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,alpha=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,shape=3<arguments.length&&void 0!==arguments[3]?arguments[3]:.5;return this.lineWidth=lineWidth,this.lineColor=color,this.lineAlpha=alpha,this.lineAlignment=shape,this.currentPath&&(this.currentPath.shape.points.length?((shape=new _math.Polygon(this.currentPath.shape.points.slice(-2))).closed=!1,this.drawShape(shape)):(this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha,this.currentPath.lineAlignment=this.lineAlignment)),this},Graphics.prototype.moveTo=function(x,shape){shape=new _math.Polygon([x,shape]);return shape.closed=!1,this.drawShape(shape),this},Graphics.prototype.lineTo=function(x,y){var points=this.currentPath.shape.points,fromX=points[points.length-2],fromY=points[points.length-1];return fromX===x&&fromY===y||(points.push(x,y),this.dirty++),this},Graphics.prototype.quadraticCurveTo=function(cpX,cpY,toX,toY){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var points=this.currentPath.shape.points;0===points.length&&this.moveTo(0,0);for(var fromX=points[points.length-2],fromY=points[points.length-1],n=Graphics.CURVES.adaptive?this._segmentsCount(this._quadraticCurveLength(fromX,fromY,cpX,cpY,toX,toY)):20,i=1;i<=n;++i){var j=i/n,xa=fromX+(cpX-fromX)*j,ya=fromY+(cpY-fromY)*j;points.push(xa+(cpX+(toX-cpX)*j-xa)*j,ya+(cpY+(toY-cpY)*j-ya)*j)}return this.dirty++,this},Graphics.prototype.bezierCurveTo=function(cpX,cpY,cpX2,cpY2,toX,toY){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var points=this.currentPath.shape.points,fromX=points[points.length-2],fromY=points[points.length-1];points.length-=2;var n=Graphics.CURVES.adaptive?this._segmentsCount(this._bezierCurveLength(fromX,fromY,cpX,cpY,cpX2,cpY2,toX,toY)):20;return(0,_bezierCurveTo3.default)(fromX,fromY,cpX,cpY,cpX2,cpY2,toX,toY,n,points),this.dirty++,this},Graphics.prototype.arcTo=function(x1,y1,cx,k2,radius){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(x1,y1):this.moveTo(x1,y1);var qy,startAngle,endAngle,cy=this.currentPath.shape.points,k1=cy[cy.length-2],a1=cy[cy.length-1]-y1,b1=k1-x1,a2=k2-y1,b2=cx-x1,py=Math.abs(a1*b2-b1*a2);return py<1e-8||0===radius?cy[cy.length-2]===x1&&cy[cy.length-1]===y1||cy.push(x1,y1):(startAngle=a1*a1+b1*b1,endAngle=a2*a2+b2*b2,qy=a1*a2+b1*b2,cx=(k1=radius*Math.sqrt(startAngle)/py)*b2+(k2=radius*Math.sqrt(endAngle)/py)*b1,cy=k1*a2+k2*a1,startAngle=b1*(k2+(py=k1*qy/startAngle)),py=a1*(k2+py),endAngle=b2*(k1+(qy=k2*qy/endAngle)),qy=a2*(k1+qy),startAngle=Math.atan2(py-cy,startAngle-cx),endAngle=Math.atan2(qy-cy,endAngle-cx),this.arc(cx+x1,cy+y1,radius,startAngle,endAngle,b2*a1<b1*a2)),this.dirty++,this},Graphics.prototype.arc=function(cx,cy,radius,startAngle,yDiff){var xDiff=5<arguments.length&&void 0!==arguments[5]&&arguments[5];if(startAngle===yDiff)return this;!xDiff&&yDiff<=startAngle?yDiff+=_const.PI_2:xDiff&&startAngle<=yDiff&&(startAngle+=_const.PI_2);var sweep=yDiff-startAngle,segs=Graphics.CURVES.adaptive?this._segmentsCount(Math.abs(sweep)*radius):40*Math.ceil(Math.abs(sweep)/_const.PI_2);if(0==sweep)return this;var startX=cx+Math.cos(startAngle)*radius,startY=cy+Math.sin(startAngle)*radius,points=this.currentPath?this.currentPath.shape.points:null;points?(xDiff=Math.abs(points[points.length-2]-startX),yDiff=Math.abs(points[points.length-1]-startY),xDiff<.001&&yDiff<.001||points.push(startX,startY)):(this.moveTo(startX,startY),points=this.currentPath.shape.points);for(var theta=sweep/(2*segs),theta2=2*theta,cTheta=Math.cos(theta),sTheta=Math.sin(theta),segMinus=segs-1,remainder=segMinus%1/segMinus,i=0;i<=segMinus;++i){var s=theta+startAngle+theta2*(i+remainder*i),c=Math.cos(s),s=-Math.sin(s);points.push((cTheta*c+sTheta*s)*radius+cx,(cTheta*-s+sTheta*c)*radius+cy)}return this.dirty++,this},Graphics.prototype.beginFill=function(){var color=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,alpha=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return this.filling=!0,this.fillColor=color,this.fillAlpha=alpha,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},Graphics.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},Graphics.prototype.drawRect=function(x,y,width,height){return this.drawShape(new _math.Rectangle(x,y,width,height)),this},Graphics.prototype.drawRoundedRect=function(x,y,width,height,radius){return this.drawShape(new _math.RoundedRectangle(x,y,width,height,radius)),this},Graphics.prototype.drawCircle=function(x,y,radius){return this.drawShape(new _math.Circle(x,y,radius)),this},Graphics.prototype.drawEllipse=function(x,y,width,height){return this.drawShape(new _math.Ellipse(x,y,width,height)),this},Graphics.prototype.drawPolygon=function(shape){var points=shape,closed=!0;if(points instanceof _math.Polygon&&(closed=points.closed,points=points.points),!Array.isArray(points)){points=new Array(arguments.length);for(var i=0;i<points.length;++i)points[i]=arguments[i]}shape=new _math.Polygon(points);return shape.closed=closed,this.drawShape(shape),this},Graphics.prototype.drawStar=function(x,y,points,radius,innerRadius){var rotation=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;innerRadius=innerRadius||radius/2;for(var startAngle=-1*Math.PI/2+rotation,len=2*points,delta=_const.PI_2/len,polygon=[],i=0;i<len;i++){var r=i%2?innerRadius:radius,angle=i*delta+startAngle;polygon.push(x+r*Math.cos(angle),y+r*Math.sin(angle))}return this.drawPolygon(polygon)},Graphics.prototype.clear=function(){return(this.lineWidth||this.filling||0<this.graphicsData.length)&&(this.lineWidth=0,this.lineAlignment=.5,this.filling=!1,this.boundsDirty=-1,this.canvasTintDirty=-1,this.dirty++,this.clearDirty++,this.graphicsData.length=0),this.currentPath=null,this._spriteRect=null,this},Graphics.prototype.isFastRect=function(){return 1===this.graphicsData.length&&this.graphicsData[0].shape.type===_const.SHAPES.RECT&&!this.graphicsData[0].lineWidth},Graphics.prototype._renderWebGL=function(renderer){this.dirty!==this.fastRectDirty&&(this.fastRectDirty=this.dirty,this._fastRect=this.isFastRect()),this._fastRect?this._renderSpriteRect(renderer):(renderer.setObjectRenderer(renderer.plugins.graphics),renderer.plugins.graphics.render(this))},Graphics.prototype._renderSpriteRect=function(renderer){var rect=this.graphicsData[0].shape;this._spriteRect||(this._spriteRect=new _Sprite2.default(new _Texture2.default(_Texture2.default.WHITE)));var t1,t2,sprite=this._spriteRect,fillColor=this.graphicsData[0].fillColor;16777215===this.tint?sprite.tint=fillColor:this.tint===this._prevRectTint&&fillColor===this._prevRectFillColor||(t1=tempColor1,t2=tempColor2,(0,_utils.hex2rgb)(fillColor,t1),(0,_utils.hex2rgb)(this.tint,t2),t1[0]*=t2[0],t1[1]*=t2[1],t1[2]*=t2[2],sprite.tint=(0,_utils.rgb2hex)(t1),this._prevRectTint=this.tint,this._prevRectFillColor=fillColor),sprite.alpha=this.graphicsData[0].fillAlpha,sprite.worldAlpha=this.worldAlpha*sprite.alpha,sprite.blendMode=this.blendMode,sprite._texture._frame.width=rect.width,sprite._texture._frame.height=rect.height,sprite.transform.worldTransform=this.transform.worldTransform,sprite.anchor.set(-rect.x/rect.width,-rect.y/rect.height),sprite._onAnchorUpdate(),sprite._renderWebGL(renderer)},Graphics.prototype._renderCanvas=function(renderer){!0!==this.isMask&&renderer.plugins.graphics.render(this)},Graphics.prototype._calculateBounds=function(){this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.updateLocalBounds(),this.cachedSpriteDirty=!0);var lb=this._localBounds;this._bounds.addFrame(this.transform,lb.minX,lb.minY,lb.maxX,lb.maxY)},Graphics.prototype.containsPoint=function(point){this.worldTransform.applyInverse(point,tempPoint);for(var graphicsData=this.graphicsData,i=0;i<graphicsData.length;++i){var data=graphicsData[i];if(data.fill&&(data.shape&&data.shape.contains(tempPoint.x,tempPoint.y))){var hitHole=!1;if(data.holes)for(var _i=0;_i<data.holes.length;_i++)if(data.holes[_i].contains(tempPoint.x,tempPoint.y)){hitHole=!0;break}if(!hitHole)return!0}}return!1},Graphics.prototype.updateLocalBounds=function(){var minX=1/0,maxX=-1/0,minY=1/0,maxY=-1/0;if(this.graphicsData.length)for(var x=0,y=0,w=0,h=0,i=0;i<this.graphicsData.length;i++){var data=this.graphicsData[i],type=data.type,lineOffset=data.lineWidth*data.lineAlignment,shape=data.shape;if(type===_const.SHAPES.RECT||type===_const.SHAPES.RREC)x=shape.x-lineOffset,y=shape.y-lineOffset,minX=x<minX?x:minX,maxX=maxX<x+(w=shape.width+2*lineOffset)?x+w:maxX,minY=y<minY?y:minY,maxY=maxY<y+(h=shape.height+2*lineOffset)?y+h:maxY;else if(type===_const.SHAPES.CIRC)x=shape.x,y=shape.y,minX=x-(w=shape.radius+lineOffset)<minX?x-w:minX,maxX=maxX<x+w?x+w:maxX,minY=y-(h=shape.radius+lineOffset)<minY?y-h:minY,maxY=maxY<y+h?y+h:maxY;else if(type===_const.SHAPES.ELIP)x=shape.x,y=shape.y,minX=x-(w=shape.width+lineOffset)<minX?x-w:minX,maxX=maxX<x+w?x+w:maxX,minY=y-(h=shape.height+lineOffset)<minY?y-h:minY,maxY=maxY<y+h?y+h:maxY;else for(var x2,y2,dx,dy,rw,rh,cx,cy,points=shape.points,j=0;j+2<points.length;j+=2)x=points[j],y=points[j+1],x2=points[j+2],y2=points[j+3],dx=Math.abs(x2-x),dy=Math.abs(y2-y),h=2*lineOffset,(w=Math.sqrt(dx*dx+dy*dy))<1e-9||(minX=(cx=(x2+x)/2)-(rw=(h/w*dy+dx)/2)<minX?cx-rw:minX,maxX=maxX<cx+rw?cx+rw:maxX,minY=(cy=(y2+y)/2)-(rh=(h/w*dx+dy)/2)<minY?cy-rh:minY,maxY=maxY<cy+rh?cy+rh:maxY)}else maxY=minY=maxX=minX=0;var padding=this.boundsPadding;this._localBounds.minX=minX-padding,this._localBounds.maxX=maxX+padding,this._localBounds.minY=minY-padding,this._localBounds.maxY=maxY+padding},Graphics.prototype.drawShape=function(data){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null;data=new _GraphicsData2.default(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,this.nativeLines,data,this.lineAlignment);return this.graphicsData.push(data),data.type===_const.SHAPES.POLY&&(data.shape.closed=data.shape.closed,this.currentPath=data),this.dirty++,data},Graphics.prototype.generateCanvasTexture=function(texture){var resolution=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,bounds=this.getLocalBounds(),canvasBuffer=_RenderTexture2.default.create(bounds.width,bounds.height,texture,resolution);canvasRenderer=canvasRenderer||new _CanvasRenderer2.default,this.transform.updateLocalTransform(),this.transform.localTransform.copy(tempMatrix),tempMatrix.invert(),tempMatrix.tx-=bounds.x,tempMatrix.ty-=bounds.y,canvasRenderer.render(this,canvasBuffer,!0,tempMatrix);texture=_Texture2.default.fromCanvas(canvasBuffer.baseTexture._canvasRenderTarget.canvas,texture,"graphics");return texture.baseTexture.resolution=resolution,texture.baseTexture.update(),texture},Graphics.prototype.closePath=function(){var currentPath=this.currentPath;return currentPath&&currentPath.shape&&currentPath.shape.close(),this},Graphics.prototype.addHole=function(){var hole=this.graphicsData.pop();return this.currentPath=this.graphicsData[this.graphicsData.length-1],this.currentPath.addHole(hole.shape),this.currentPath=null,this},Graphics.prototype.destroy=function(options){_Container.prototype.destroy.call(this,options);for(var id,i=0;i<this.graphicsData.length;++i)this.graphicsData[i].destroy();for(id in this._webGL)for(var j=0;j<this._webGL[id].data.length;++j)this._webGL[id].data[j].destroy();this._spriteRect&&this._spriteRect.destroy(),this.graphicsData=null,this.currentPath=null,this._webGL=null,this._localBounds=null},Graphics}(Graphics.default);(exports.default=Graphics)._SPRITE_TEXTURE=null,Graphics.CURVES={adaptive:!1,maxLength:10,minSegments:8,maxSegments:2048}},{"../const":41,"../display/Bounds":42,"../display/Container":43,"../math":65,"../renderers/canvas/CanvasRenderer":72,"../sprites/Sprite":97,"../textures/RenderTexture":108,"../textures/Texture":110,"../utils":120,"./GraphicsData":49,"./utils/bezierCurveTo":51}],97:[function(Sprite,module,exports){"use strict";exports.__esModule=!0;var _createClass=function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor};function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var _math=Sprite("../math"),_utils=Sprite("../utils"),_const=Sprite("../const"),_Texture2=_interopRequireDefault(Sprite("../textures/Texture")),Sprite=_interopRequireDefault(Sprite("../display/Container"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var tempPoint=new _math.Point,Sprite=function(_Container){function Sprite(texture){!function(instance){if(!(instance instanceof Sprite))throw new TypeError("Cannot call a class as a function")}(this);var _this=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_Container.call(this));return _this._anchor=new _math.ObservablePoint(_this._onAnchorUpdate,_this,texture?texture.defaultAnchor.x:0,texture?texture.defaultAnchor.y:0),_this._texture=null,_this._width=0,_this._height=0,_this._tint=null,_this._tintRGB=null,_this.tint=16777215,_this.blendMode=_const.BLEND_MODES.NORMAL,_this.shader=null,_this.cachedTint=16777215,_this.texture=texture||_Texture2.default.EMPTY,_this.vertexData=new Float32Array(8),_this.vertexTrimmedData=null,_this._transformID=-1,_this._textureID=-1,_this._transformTrimmedID=-1,_this._textureTrimmedID=-1,_this.pluginName="sprite",_this}return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(Sprite,_Container),Sprite.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this.cachedTint=16777215,this._width&&(this.scale.x=(0,_utils.sign)(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=(0,_utils.sign)(this.scale.y)*this._height/this._texture.orig.height)},Sprite.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},Sprite.prototype.calculateVertices=function(){var a,b,c,d,tx,ty,vertexData,trim,orig,anchor,w0,w1,h1,h0;this._transformID===this.transform._worldID&&this._textureID===this._texture._updateID||(this._transformID=this.transform._worldID,this._textureID=this._texture._updateID,h1=this._texture,a=(h0=this.transform.worldTransform).a,b=h0.b,c=h0.c,d=h0.d,tx=h0.tx,ty=h0.ty,vertexData=this.vertexData,trim=h1.trim,orig=h1.orig,anchor=this._anchor,h1=h0=w1=w0=0,h0=trim?(w0=(w1=trim.x-anchor._x*orig.width)+trim.width,(h1=trim.y-anchor._y*orig.height)+trim.height):(w0=(w1=-anchor._x*orig.width)+orig.width,(h1=-anchor._y*orig.height)+orig.height),vertexData[0]=a*w1+c*h1+tx,vertexData[1]=d*h1+b*w1+ty,vertexData[2]=a*w0+c*h1+tx,vertexData[3]=d*h1+b*w0+ty,vertexData[4]=a*w0+c*h0+tx,vertexData[5]=d*h0+b*w0+ty,vertexData[6]=a*w1+c*h0+tx,vertexData[7]=d*h0+b*w1+ty)},Sprite.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var w1=this._texture,vertexData=this.vertexTrimmedData,h0=w1.orig,h1=this._anchor,w0=this.transform.worldTransform,a=w0.a,b=w0.b,c=w0.c,d=w0.d,tx=w0.tx,ty=w0.ty,w1=-h1._x*h0.width,w0=w1+h0.width,h1=-h1._y*h0.height,h0=h1+h0.height;vertexData[0]=a*w1+c*h1+tx,vertexData[1]=d*h1+b*w1+ty,vertexData[2]=a*w0+c*h1+tx,vertexData[3]=d*h1+b*w0+ty,vertexData[4]=a*w0+c*h0+tx,vertexData[5]=d*h0+b*w0+ty,vertexData[6]=a*w1+c*h0+tx,vertexData[7]=d*h0+b*w1+ty},Sprite.prototype._renderWebGL=function(renderer){this.calculateVertices(),renderer.setObjectRenderer(renderer.plugins[this.pluginName]),renderer.plugins[this.pluginName].render(this)},Sprite.prototype._renderCanvas=function(renderer){renderer.plugins[this.pluginName].render(this)},Sprite.prototype._calculateBounds=function(){var trim=this._texture.trim,orig=this._texture.orig;!trim||trim.width===orig.width&&trim.height===orig.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},Sprite.prototype.getLocalBounds=function(rect){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),rect||(this._localBoundsRect||(this._localBoundsRect=new _math.Rectangle),rect=this._localBoundsRect),this._bounds.getRectangle(rect)):_Container.prototype.getLocalBounds.call(this,rect)},Sprite.prototype.containsPoint=function(y1){this.worldTransform.applyInverse(y1,tempPoint);var width=this._texture.orig.width,height=this._texture.orig.height,x1=-width*this.anchor.x,y1=0;return tempPoint.x>=x1&&tempPoint.x<x1+width&&(y1=-height*this.anchor.y,tempPoint.y>=y1&&tempPoint.y<y1+height)},Sprite.prototype.destroy=function(destroyBaseTexture){_Container.prototype.destroy.call(this,destroyBaseTexture),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,("boolean"==typeof destroyBaseTexture?destroyBaseTexture:destroyBaseTexture&&destroyBaseTexture.texture)&&(destroyBaseTexture="boolean"==typeof destroyBaseTexture?destroyBaseTexture:destroyBaseTexture&&destroyBaseTexture.baseTexture,this._texture.destroy(!!destroyBaseTexture)),this._texture=null,this.shader=null},Sprite.from=function(source){return new Sprite(_Texture2.default.from(source))},Sprite.fromFrame=function(frameId){var texture=_utils.TextureCache[frameId];if(!texture)throw new Error('The frameId "'+frameId+'" does not exist in the texture cache');return new Sprite(texture)},Sprite.fromImage=function(imageId,crossorigin,scaleMode){return new Sprite(_Texture2.default.fromImage(imageId,crossorigin,scaleMode))},_createClass(Sprite,[{key:"width",get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(value){var s=(0,_utils.sign)(this.scale.x)||1;this.scale.x=s*value/this._texture.orig.width,this._width=value}},{key:"height",get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(value){var s=(0,_utils.sign)(this.scale.y)||1;this.scale.y=s*value/this._texture.orig.height,this._height=value}},{key:"anchor",get:function(){return this._anchor},set:function(value){this._anchor.copy(value)}},{key:"tint",get:function(){return this._tint},set:function(value){this._tint=value,this._tintRGB=(value>>16)+(65280&value)+((255&value)<<16)}},{key:"texture",get:function(){return this._texture},set:function(value){this._texture!==value&&(this._texture=value||_Texture2.default.EMPTY,this.cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,value&&(value.baseTexture.hasLoaded?this._onTextureUpdate():value.once("update",this._onTextureUpdate,this)))}}]),Sprite}(Sprite.default);exports.default=Sprite},{"../const":41,"../display/Container":43,"../math":65,"../textures/Texture":110,"../utils":120}],51:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default=function(fromX,fromY,cpX,cpY,cpX2,cpY2,toX,toY,n){var path=9<arguments.length&&void 0!==arguments[9]?arguments[9]:[],dt=0,dt2=0,dt3=0,t2=0,t3=0;path.push(fromX,fromY);for(var i=1,j=0;i<=n;++i)dt3=(dt2=(dt=1-(j=i/n))*dt)*dt,t3=(t2=j*j)*j,path.push(dt3*fromX+3*dt2*j*cpX+3*dt*t2*cpX2+t3*toX,dt3*fromY+3*dt2*j*cpY+3*dt*t2*cpY2+t3*toY);return path}},{}],49:[function(require,module,exports){"use strict";exports.__esModule=!0;var GraphicsData=function(){function GraphicsData(lineWidth,lineColor,lineAlpha,fillColor,fillAlpha,fill,nativeLines,shape,lineAlignment){!function(instance){if(!(instance instanceof GraphicsData))throw new TypeError("Cannot call a class as a function")}(this),this.lineWidth=lineWidth,this.lineAlignment=lineAlignment,this.nativeLines=nativeLines,this.lineColor=lineColor,this.lineAlpha=lineAlpha,this._lineTint=lineColor,this.fillColor=fillColor,this.fillAlpha=fillAlpha,this._fillTint=fillColor,this.fill=fill,this.holes=[],this.shape=shape,this.type=shape.type}return GraphicsData.prototype.clone=function(){return new GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.nativeLines,this.shape,this.lineAlignment)},GraphicsData.prototype.addHole=function(shape){this.holes.push(shape)},GraphicsData.prototype.destroy=function(){this.shape=null,this.holes=null},GraphicsData}();exports.default=GraphicsData},{}],38:[function(Application,module,exports){"use strict";exports.__esModule=!0;var _createClass=function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor};function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var _autoDetectRenderer=Application("./autoDetectRenderer"),_Container2=_interopRequireDefault(Application("./display/Container")),_ticker=Application("./ticker"),_settings2=_interopRequireDefault(Application("./settings")),_const=Application("./const");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Application=function(){function Application(options,arg2,arg3,arg4,arg5){!function(instance){if(!(instance instanceof Application))throw new TypeError("Cannot call a class as a function")}(this),"number"==typeof options&&(options=Object.assign({width:options,height:arg2||_settings2.default.RENDER_OPTIONS.height,forceCanvas:!!arg4,sharedTicker:!!arg5},arg3)),this._options=options=Object.assign({autoStart:!0,sharedTicker:!1,forceCanvas:!1,sharedLoader:!1},options),this.renderer=(0,_autoDetectRenderer.autoDetectRenderer)(options),this.stage=new _Container2.default,this._ticker=null,this.ticker=options.sharedTicker?_ticker.shared:new _ticker.Ticker,options.autoStart&&this.start()}return Application.prototype.render=function(){this.renderer.render(this.stage)},Application.prototype.stop=function(){this._ticker.stop()},Application.prototype.start=function(){this._ticker.start()},Application.prototype.destroy=function(removeView,stageOptions){var oldTicker;this._ticker&&(oldTicker=this._ticker,this.ticker=null,oldTicker.destroy()),this.stage.destroy(stageOptions),this.stage=null,this.renderer.destroy(removeView),this.renderer=null,this._options=null},_createClass(Application,[{key:"ticker",set:function(ticker){this._ticker&&this._ticker.remove(this.render,this),(this._ticker=ticker)&&ticker.add(this.render,this,_const.UPDATE_PRIORITY.LOW)},get:function(){return this._ticker}},{key:"view",get:function(){return this.renderer.view}},{key:"screen",get:function(){return this.renderer.screen}}]),Application}();exports.default=Application},{"./autoDetectRenderer":40,"./const":41,"./display/Container":43,"./settings":96,"./ticker":116}],40:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.autoDetectRenderer=function(options,arg1,arg2,arg3){var forceCanvas=options&&options.forceCanvas;void 0!==arg3&&(forceCanvas=arg3);return new(forceCanvas||!utils.isWebGLSupported()?_CanvasRenderer2:_WebGLRenderer2).default(options,arg1,arg2)};var utils=function(obj){{if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}}(require("./utils")),_CanvasRenderer2=_interopRequireDefault(require("./renderers/canvas/CanvasRenderer")),_WebGLRenderer2=_interopRequireDefault(require("./renderers/webgl/WebGLRenderer"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./renderers/canvas/CanvasRenderer":72,"./renderers/webgl/WebGLRenderer":79,"./utils":120}],79:[function(WebGLRenderer,module,exports){"use strict";exports.__esModule=!0;var _SystemRenderer3=_interopRequireDefault(WebGLRenderer("../SystemRenderer")),_MaskManager2=_interopRequireDefault(WebGLRenderer("./managers/MaskManager")),_StencilManager2=_interopRequireDefault(WebGLRenderer("./managers/StencilManager")),_FilterManager2=_interopRequireDefault(WebGLRenderer("./managers/FilterManager")),_RenderTarget2=_interopRequireDefault(WebGLRenderer("./utils/RenderTarget")),_ObjectRenderer2=_interopRequireDefault(WebGLRenderer("./utils/ObjectRenderer")),_TextureManager2=_interopRequireDefault(WebGLRenderer("./TextureManager")),_BaseTexture2=_interopRequireDefault(WebGLRenderer("../../textures/BaseTexture")),_TextureGarbageCollector2=_interopRequireDefault(WebGLRenderer("./TextureGarbageCollector")),_WebGLState2=_interopRequireDefault(WebGLRenderer("./WebGLState")),_mapWebGLDrawModesToPixi2=_interopRequireDefault(WebGLRenderer("./utils/mapWebGLDrawModesToPixi")),_validateContext2=_interopRequireDefault(WebGLRenderer("./utils/validateContext")),_utils=WebGLRenderer("../../utils"),_pixiGlCore2=_interopRequireDefault(WebGLRenderer("pixi-gl-core")),_const=WebGLRenderer("../../const");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var CONTEXT_UID=0,WebGLRenderer=function(_SystemRenderer){function WebGLRenderer(options,arg2,_this){!function(instance){if(!(instance instanceof WebGLRenderer))throw new TypeError("Cannot call a class as a function")}(this);_this=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_SystemRenderer.call(this,"WebGL",options,arg2,_this));return _this.legacy=_this.options.legacy,_this.legacy&&(_pixiGlCore2.default.VertexArrayObject.FORCE_NATIVE=!0),_this.type=_const.RENDERER_TYPE.WEBGL,_this.handleContextLost=_this.handleContextLost.bind(_this),_this.handleContextRestored=_this.handleContextRestored.bind(_this),_this.view.addEventListener("webglcontextlost",_this.handleContextLost,!1),_this.view.addEventListener("webglcontextrestored",_this.handleContextRestored,!1),_this._contextOptions={alpha:_this.transparent,antialias:_this.options.antialias,premultipliedAlpha:_this.transparent&&"notMultiplied"!==_this.transparent,stencil:!0,preserveDrawingBuffer:_this.options.preserveDrawingBuffer,powerPreference:_this.options.powerPreference},_this._backgroundColorRgba[3]=_this.transparent?0:1,_this.maskManager=new _MaskManager2.default(_this),_this.stencilManager=new _StencilManager2.default(_this),_this.emptyRenderer=new _ObjectRenderer2.default(_this),_this.currentRenderer=_this.emptyRenderer,_this.textureManager=null,_this.filterManager=null,_this.initPlugins(),_this.options.context&&(0,_validateContext2.default)(_this.options.context),_this.gl=_this.options.context||_pixiGlCore2.default.createContext(_this.view,_this._contextOptions),_this.CONTEXT_UID=CONTEXT_UID++,_this.state=new _WebGLState2.default(_this.gl),_this.renderingToScreen=!0,_this.boundTextures=null,_this._activeShader=null,_this._activeVao=null,_this._activeRenderTarget=null,_this._initContext(),_this.drawModes=(0,_mapWebGLDrawModesToPixi2.default)(_this.gl),_this._nextTextureLocation=0,_this.setBlendMode(0),_this}return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(WebGLRenderer,_SystemRenderer),WebGLRenderer.prototype._initContext=function(){var gl=this.gl;gl.isContextLost()&&gl.getExtension("WEBGL_lose_context")&&gl.getExtension("WEBGL_lose_context").restoreContext();var maxTextures=gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);this._activeShader=null,this._activeVao=null,this.boundTextures=new Array(maxTextures),this.emptyTextures=new Array(maxTextures),this._unknownBoundTextures=!1,this.textureManager=new _TextureManager2.default(this),this.filterManager=new _FilterManager2.default(this),this.textureGC=new _TextureGarbageCollector2.default(this),this.state.resetToDefault(),this.rootRenderTarget=new _RenderTarget2.default(gl,this.width,this.height,null,this.resolution,!0),this.rootRenderTarget.clearColor=this._backgroundColorRgba,this.bindRenderTarget(this.rootRenderTarget);var emptyGLTexture=new _pixiGlCore2.default.GLTexture.fromData(gl,null,1,1),tempObj={_glTextures:{}};tempObj._glTextures[this.CONTEXT_UID]={};for(var i=0;i<maxTextures;i++){var empty=new _BaseTexture2.default;empty._glTextures[this.CONTEXT_UID]=emptyGLTexture,this.boundTextures[i]=tempObj,this.emptyTextures[i]=empty,this.bindTexture(null,i)}this.emit("context",gl),this.resize(this.screen.width,this.screen.height)},WebGLRenderer.prototype.render=function(displayObject,renderTexture,clear,transform,cacheParent){this.renderingToScreen=!renderTexture,this.emit("prerender"),this.gl&&!this.gl.isContextLost()&&(this._nextTextureLocation=0,renderTexture||(this._lastObjectRendered=displayObject),cacheParent||(cacheParent=displayObject.parent,displayObject.parent=this._tempDisplayObjectParent,displayObject.updateTransform(),displayObject.parent=cacheParent),this.bindRenderTexture(renderTexture,transform),this.currentRenderer.start(),(void 0!==clear?clear:this.clearBeforeRender)&&this._activeRenderTarget.clear(),displayObject.renderWebGL(this),this.currentRenderer.flush(),this.textureGC.update(),this.emit("postrender"))},WebGLRenderer.prototype.setObjectRenderer=function(objectRenderer){this.currentRenderer!==objectRenderer&&(this.currentRenderer.stop(),this.currentRenderer=objectRenderer,this.currentRenderer.start())},WebGLRenderer.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},WebGLRenderer.prototype.resize=function(screenWidth,screenHeight){_SystemRenderer3.default.prototype.resize.call(this,screenWidth,screenHeight),this.rootRenderTarget.resize(screenWidth,screenHeight),this._activeRenderTarget===this.rootRenderTarget&&(this.rootRenderTarget.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=this.rootRenderTarget.projectionMatrix.toArray(!0)))},WebGLRenderer.prototype.setBlendMode=function(blendMode){this.state.setBlendMode(blendMode)},WebGLRenderer.prototype.clear=function(clearColor){this._activeRenderTarget.clear(clearColor)},WebGLRenderer.prototype.setTransform=function(matrix){this._activeRenderTarget.transform=matrix},WebGLRenderer.prototype.clearRenderTexture=function(renderTarget,clearColor){renderTarget=renderTarget.baseTexture._glRenderTargets[this.CONTEXT_UID];return renderTarget&&renderTarget.clear(clearColor),this},WebGLRenderer.prototype.bindRenderTexture=function(renderTexture,transform){var baseTexture,renderTarget=void 0;return renderTexture?((baseTexture=renderTexture.baseTexture)._glRenderTargets[this.CONTEXT_UID]||this.textureManager.updateTexture(baseTexture,0),this.unbindTexture(baseTexture),(renderTarget=baseTexture._glRenderTargets[this.CONTEXT_UID]).setFrame(renderTexture.frame)):renderTarget=this.rootRenderTarget,renderTarget.transform=transform,this.bindRenderTarget(renderTarget),this},WebGLRenderer.prototype.bindRenderTarget=function(renderTarget){return renderTarget!==this._activeRenderTarget&&((this._activeRenderTarget=renderTarget).activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=renderTarget.projectionMatrix.toArray(!0)),this.stencilManager.setMaskStack(renderTarget.stencilMaskStack)),this},WebGLRenderer.prototype.bindShader=function(shader,autoProject){return this._activeShader!==shader&&((this._activeShader=shader).bind(),!1!==autoProject&&(shader.uniforms.projectionMatrix=this._activeRenderTarget.projectionMatrix.toArray(!0))),this},WebGLRenderer.prototype.bindTexture=function(texture,location,glTexture){if((texture=(texture=texture||this.emptyTextures[location]).baseTexture||texture).touched=this.textureGC.count,glTexture)location=location||0;else{for(var i=0;i<this.boundTextures.length;i++)if(this.boundTextures[i]===texture)return i;void 0===location&&(this._nextTextureLocation++,this._nextTextureLocation%=this.boundTextures.length,location=this.boundTextures.length-this._nextTextureLocation-1)}var gl=this.gl,glTexture=texture._glTextures[this.CONTEXT_UID];return glTexture?(this.boundTextures[location]=texture,gl.activeTexture(gl.TEXTURE0+location),gl.bindTexture(gl.TEXTURE_2D,glTexture.texture)):this.textureManager.updateTexture(texture,location),location},WebGLRenderer.prototype.unbindTexture=function(texture){var gl=this.gl;if(texture=texture.baseTexture||texture,this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<this.boundTextures.length;i++)this.boundTextures[i]===this.emptyTextures[i]&&(gl.activeTexture(gl.TEXTURE0+i),gl.bindTexture(gl.TEXTURE_2D,this.emptyTextures[i]._glTextures[this.CONTEXT_UID].texture))}for(var _i=0;_i<this.boundTextures.length;_i++)this.boundTextures[_i]===texture&&(this.boundTextures[_i]=this.emptyTextures[_i],gl.activeTexture(gl.TEXTURE0+_i),gl.bindTexture(gl.TEXTURE_2D,this.emptyTextures[_i]._glTextures[this.CONTEXT_UID].texture));return this},WebGLRenderer.prototype.createVao=function(){return new _pixiGlCore2.default.VertexArrayObject(this.gl,this.state.attribState)},WebGLRenderer.prototype.bindVao=function(vao){return this._activeVao===vao||(vao?vao.bind():this._activeVao&&this._activeVao.unbind(),this._activeVao=vao),this},WebGLRenderer.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer),this.bindVao(null),this._activeShader=null,this._activeRenderTarget=this.rootRenderTarget,this._unknownBoundTextures=!0;for(var i=0;i<this.boundTextures.length;i++)this.boundTextures[i]=this.emptyTextures[i];return this.rootRenderTarget.activate(),this.state.resetToDefault(),this},WebGLRenderer.prototype.handleContextLost=function(event){event.preventDefault()},WebGLRenderer.prototype.handleContextRestored=function(){this.textureManager.removeAll(),this.filterManager.destroy(!0),this._initContext()},WebGLRenderer.prototype.destroy=function(removeView){this.destroyPlugins(),this.view.removeEventListener("webglcontextlost",this.handleContextLost),this.view.removeEventListener("webglcontextrestored",this.handleContextRestored),this.textureManager.destroy(),_SystemRenderer.prototype.destroy.call(this,removeView),this.uid=0,this.maskManager.destroy(),this.stencilManager.destroy(),this.filterManager.destroy(),this.maskManager=null,this.filterManager=null,this.textureManager=null,this.currentRenderer=null,this.handleContextLost=null,this.handleContextRestored=null,this._contextOptions=null,this.gl.useProgram(null),this.gl.getExtension("WEBGL_lose_context")&&this.gl.getExtension("WEBGL_lose_context").loseContext(),this.gl=null},WebGLRenderer}(_SystemRenderer3.default);exports.default=WebGLRenderer,_utils.pluginTarget.mixin(WebGLRenderer)},{"../../const":41,"../../textures/BaseTexture":107,"../../utils":120,"../SystemRenderer":71,"./TextureGarbageCollector":77,"./TextureManager":78,"./WebGLState":80,"./managers/FilterManager":85,"./managers/MaskManager":86,"./managers/StencilManager":87,"./utils/ObjectRenderer":89,"./utils/RenderTarget":91,"./utils/mapWebGLDrawModesToPixi":94,"./utils/validateContext":95,"pixi-gl-core":24}],95:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default=function(gl){gl.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")}},{}],94:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default=function(gl){var object=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return object[_const.DRAW_MODES.POINTS]=gl.POINTS,object[_const.DRAW_MODES.LINES]=gl.LINES,object[_const.DRAW_MODES.LINE_LOOP]=gl.LINE_LOOP,object[_const.DRAW_MODES.LINE_STRIP]=gl.LINE_STRIP,object[_const.DRAW_MODES.TRIANGLES]=gl.TRIANGLES,object[_const.DRAW_MODES.TRIANGLE_STRIP]=gl.TRIANGLE_STRIP,object[_const.DRAW_MODES.TRIANGLE_FAN]=gl.TRIANGLE_FAN,object};var _const=require("../../../const")},{"../../../const":41}],89:[function(ObjectRenderer,module,exports){"use strict";exports.__esModule=!0;var obj,_WebGLManager2=ObjectRenderer("../managers/WebGLManager");ObjectRenderer=function(_WebGLManager){function ObjectRenderer(){return function(instance){if(!(instance instanceof ObjectRenderer))throw new TypeError("Cannot call a class as a function")}(this),function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_WebGLManager.apply(this,arguments))}return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(ObjectRenderer,_WebGLManager),ObjectRenderer.prototype.start=function(){},ObjectRenderer.prototype.stop=function(){this.flush()},ObjectRenderer.prototype.flush=function(){},ObjectRenderer.prototype.render=function(object){},ObjectRenderer}(((obj=_WebGLManager2)&&obj.__esModule?obj:{default:obj}).default);exports.default=ObjectRenderer},{"../managers/WebGLManager":88}],87:[function(StencilManager,module,exports){"use strict";exports.__esModule=!0;var obj,_WebGLManager2=StencilManager("./WebGLManager"),_WebGLManager3=(obj=_WebGLManager2)&&obj.__esModule?obj:{default:obj};StencilManager=function(_WebGLManager){function StencilManager(_this){!function(instance){if(!(instance instanceof StencilManager))throw new TypeError("Cannot call a class as a function")}(this);_this=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_WebGLManager.call(this,_this));return _this.stencilMaskStack=null,_this}return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(StencilManager,_WebGLManager),StencilManager.prototype.setMaskStack=function(stencilMaskStack){this.stencilMaskStack=stencilMaskStack;var gl=this.renderer.gl;0===stencilMaskStack.length?gl.disable(gl.STENCIL_TEST):gl.enable(gl.STENCIL_TEST)},StencilManager.prototype.pushStencil=function(graphics){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),this.renderer._activeRenderTarget.attachStencilBuffer();var gl=this.renderer.gl,prevMaskCount=this.stencilMaskStack.length;0===prevMaskCount&&gl.enable(gl.STENCIL_TEST),this.stencilMaskStack.push(graphics),gl.colorMask(!1,!1,!1,!1),gl.stencilFunc(gl.EQUAL,prevMaskCount,this._getBitwiseMask()),gl.stencilOp(gl.KEEP,gl.KEEP,gl.INCR),this.renderer.plugins.graphics.render(graphics),this._useCurrent()},StencilManager.prototype.popStencil=function(){this.renderer.setObjectRenderer(this.renderer.plugins.graphics);var gl=this.renderer.gl,graphics=this.stencilMaskStack.pop();0===this.stencilMaskStack.length?(gl.disable(gl.STENCIL_TEST),gl.clear(gl.STENCIL_BUFFER_BIT),gl.clearStencil(0)):(gl.colorMask(!1,!1,!1,!1),gl.stencilOp(gl.KEEP,gl.KEEP,gl.DECR),this.renderer.plugins.graphics.render(graphics),this._useCurrent())},StencilManager.prototype._useCurrent=function(){var gl=this.renderer.gl;gl.colorMask(!0,!0,!0,!0),gl.stencilFunc(gl.EQUAL,this.stencilMaskStack.length,this._getBitwiseMask()),gl.stencilOp(gl.KEEP,gl.KEEP,gl.KEEP)},StencilManager.prototype._getBitwiseMask=function(){return(1<<this.stencilMaskStack.length)-1},StencilManager.prototype.destroy=function(){_WebGLManager3.default.prototype.destroy.call(this),this.stencilMaskStack.stencilStack=null},StencilManager}(_WebGLManager3.default);exports.default=StencilManager},{"./WebGLManager":88}],86:[function(require,module,exports){"use strict";exports.__esModule=!0;var MaskManager=_interopRequireDefault(require("./WebGLManager")),_SpriteMaskFilter2=_interopRequireDefault(require("../filters/spriteMask/SpriteMaskFilter"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}MaskManager=function(_WebGLManager){function MaskManager(_this){!function(instance){if(!(instance instanceof MaskManager))throw new TypeError("Cannot call a class as a function")}(this);_this=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_WebGLManager.call(this,_this));return _this.scissor=!1,_this.scissorData=null,_this.scissorRenderTarget=null,_this.enableScissor=!0,_this.alphaMaskPool=[],_this.alphaMaskIndex=0,_this}return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(MaskManager,_WebGLManager),MaskManager.prototype.pushMask=function(target,maskData){var rot;maskData.texture?this.pushSpriteMask(target,maskData):this.enableScissor&&!this.scissor&&this.renderer._activeRenderTarget.root&&!this.renderer.stencilManager.stencilMaskStack.length&&maskData.isFastRect()?(rot=maskData.worldTransform,rot=Math.atan2(rot.b,rot.a),(rot=Math.round(rot*(180/Math.PI)))%90?this.pushStencilMask(maskData):this.pushScissorMask(target,maskData)):this.pushStencilMask(maskData)},MaskManager.prototype.popMask=function(target,maskData){maskData.texture?this.popSpriteMask(target,maskData):this.enableScissor&&!this.renderer.stencilManager.stencilMaskStack.length?this.popScissorMask(target,maskData):this.popStencilMask(target,maskData)},MaskManager.prototype.pushSpriteMask=function(target,maskData){var alphaMaskFilter=this.alphaMaskPool[this.alphaMaskIndex];(alphaMaskFilter=alphaMaskFilter||(this.alphaMaskPool[this.alphaMaskIndex]=[new _SpriteMaskFilter2.default(maskData)]))[0].resolution=this.renderer.resolution,alphaMaskFilter[0].maskSprite=maskData;var stashFilterArea=target.filterArea;target.filterArea=maskData.getBounds(!0),this.renderer.filterManager.pushFilter(target,alphaMaskFilter),target.filterArea=stashFilterArea,this.alphaMaskIndex++},MaskManager.prototype.popSpriteMask=function(){this.renderer.filterManager.popFilter(),this.alphaMaskIndex--},MaskManager.prototype.pushStencilMask=function(maskData){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.pushStencil(maskData)},MaskManager.prototype.popStencilMask=function(){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.popStencil()},MaskManager.prototype.pushScissorMask=function(target,maskData){maskData.renderable=!0;var renderTarget=this.renderer._activeRenderTarget,bounds=maskData.getBounds();bounds.fit(renderTarget.size),maskData.renderable=!1,this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST);var resolution=this.renderer.resolution;this.renderer.gl.scissor(bounds.x*resolution,(renderTarget.root?renderTarget.size.height-bounds.y-bounds.height:bounds.y)*resolution,bounds.width*resolution,bounds.height*resolution),this.scissorRenderTarget=renderTarget,this.scissorData=maskData,this.scissor=!0},MaskManager.prototype.popScissorMask=function(){this.scissorRenderTarget=null,this.scissorData=null,this.scissor=!1;var gl=this.renderer.gl;gl.disable(gl.SCISSOR_TEST)},MaskManager}(MaskManager.default);exports.default=MaskManager},{"../filters/spriteMask/SpriteMaskFilter":84,"./WebGLManager":88}],84:[function(require,module,exports){"use strict";exports.__esModule=!0;var SpriteMaskFilter=_interopRequireDefault(require("../Filter")),_math=require("../../../../math"),_TextureMatrix2=(require("path"),_interopRequireDefault(require("../../../../textures/TextureMatrix")));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}SpriteMaskFilter=function(_Filter){function SpriteMaskFilter(sprite){!function(instance){if(!(instance instanceof SpriteMaskFilter))throw new TypeError("Cannot call a class as a function")}(this);var maskMatrix=new _math.Matrix,_this=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_Filter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n\n    original *= (masky.r * masky.a * alpha * clip);\n\n    gl_FragColor = original;\n}\n"));return sprite.renderable=!1,_this.maskSprite=sprite,_this.maskMatrix=maskMatrix,_this}return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(SpriteMaskFilter,_Filter),SpriteMaskFilter.prototype.apply=function(filterManager,input,output,clear){var maskSprite=this.maskSprite,tex=this.maskSprite.texture;tex.valid&&(tex.transform||(tex.transform=new _TextureMatrix2.default(tex,0)),tex.transform.update(),this.uniforms.mask=tex,this.uniforms.otherMatrix=filterManager.calculateSpriteMatrix(this.maskMatrix,maskSprite).prepend(tex.transform.mapCoord),this.uniforms.alpha=maskSprite.worldAlpha,this.uniforms.maskClamp=tex.transform.uClampFrame,filterManager.applyFilter(this,input,output,clear))},SpriteMaskFilter}(SpriteMaskFilter.default);exports.default=SpriteMaskFilter},{"../../../../math":65,"../../../../textures/TextureMatrix":111,"../Filter":81,path:17}],111:[function(TextureMatrix,module,exports){"use strict";exports.__esModule=!0;var _createClass=function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor};function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var obj,_Matrix=TextureMatrix("../math/Matrix"),_Matrix2=(obj=_Matrix)&&obj.__esModule?obj:{default:obj};var tempMat=new _Matrix2.default,TextureMatrix=function(){function TextureMatrix(texture,clampMargin){!function(instance){if(!(instance instanceof TextureMatrix))throw new TypeError("Cannot call a class as a function")}(this),this._texture=texture,this.mapCoord=new _Matrix2.default,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._lastTextureID=-1,this.clampOffset=0,this.clampMargin=void 0===clampMargin?.5:clampMargin}return TextureMatrix.prototype.multiplyUvs=function(uvs,out){void 0===out&&(out=uvs);for(var mat=this.mapCoord,i=0;i<uvs.length;i+=2){var x=uvs[i],y=uvs[i+1];out[i]=x*mat.a+y*mat.c+mat.tx,out[i+1]=x*mat.b+y*mat.d+mat.ty}return out},TextureMatrix.prototype.update=function(texBase){var tex=this._texture;if(!tex||!tex.valid)return!1;if(!texBase&&this._lastTextureID===tex._updateID)return!1;this._lastTextureID=tex._updateID;var frame=tex._uvs;this.mapCoord.set(frame.x1-frame.x0,frame.y1-frame.y0,frame.x3-frame.x0,frame.y3-frame.y0,frame.x0,frame.y0);var margin=tex.orig,offset=tex.trim;offset&&(tempMat.set(margin.width/offset.width,0,0,margin.height/offset.height,-offset.x/offset.width,-offset.y/offset.height),this.mapCoord.append(tempMat));texBase=tex.baseTexture,frame=this.uClampFrame,margin=this.clampMargin/texBase.resolution,offset=this.clampOffset;return frame[0]=(tex._frame.x+margin+offset)/texBase.width,frame[1]=(tex._frame.y+margin+offset)/texBase.height,frame[2]=(tex._frame.x+tex._frame.width-margin+offset)/texBase.width,frame[3]=(tex._frame.y+tex._frame.height-margin+offset)/texBase.height,this.uClampOffset[0]=offset/texBase.realWidth,this.uClampOffset[1]=offset/texBase.realHeight,!0},_createClass(TextureMatrix,[{key:"texture",get:function(){return this._texture},set:function(value){this._texture=value,this._lastTextureID=-1}}]),TextureMatrix}();exports.default=TextureMatrix},{"../math/Matrix":62}],81:[function(Filter,module,exports){"use strict";exports.__esModule=!0;var _createClass=function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor};function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var _extractUniformsFromSrc2=_interopRequireDefault(Filter("./extractUniformsFromSrc")),_utils=Filter("../../../utils"),_const=Filter("../../../const"),_settings2=_interopRequireDefault(Filter("../../../settings"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var SOURCE_KEY_MAP={},Filter=function(){function Filter(vertexSrc,fragmentSrc,uniformData){for(var i in!function(instance){if(!(instance instanceof Filter))throw new TypeError("Cannot call a class as a function")}(this),this.vertexSrc=vertexSrc||Filter.defaultVertexSrc,this.fragmentSrc=fragmentSrc||Filter.defaultFragmentSrc,this._blendMode=_const.BLEND_MODES.NORMAL,this.uniformData=uniformData||(0,_extractUniformsFromSrc2.default)(this.vertexSrc,this.fragmentSrc,"projectionMatrix|uSampler"),this.uniforms={},this.uniformData)this.uniforms[i]=this.uniformData[i].value,this.uniformData[i].type&&(this.uniformData[i].type=this.uniformData[i].type.toLowerCase());this.glShaders={},SOURCE_KEY_MAP[this.vertexSrc+this.fragmentSrc]||(SOURCE_KEY_MAP[this.vertexSrc+this.fragmentSrc]=(0,_utils.uid)()),this.glShaderKey=SOURCE_KEY_MAP[this.vertexSrc+this.fragmentSrc],this.padding=4,this.resolution=_settings2.default.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0}return Filter.prototype.apply=function(filterManager,input,output,clear,currentState){filterManager.applyFilter(this,input,output,clear)},_createClass(Filter,[{key:"blendMode",get:function(){return this._blendMode},set:function(value){this._blendMode=value}}],[{key:"defaultVertexSrc",get:function(){return["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 projectionMatrix;","uniform mat3 filterMatrix;","varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;","   vTextureCoord = aTextureCoord ;","}"].join("\n")}},{key:"defaultFragmentSrc",get:function(){return["varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","uniform sampler2D uSampler;","uniform sampler2D filterSampler;","void main(void){","   vec4 masky = texture2D(filterSampler, vFilterCoord);","   vec4 sample = texture2D(uSampler, vTextureCoord);","   vec4 color;","   if(mod(vFilterCoord.x, 1.0) > 0.5)","   {","     color = vec4(1.0, 0.0, 0.0, 1.0);","   }","   else","   {","     color = vec4(0.0, 1.0, 0.0, 1.0);","   }","   gl_FragColor = mix(sample, masky, 0.5);","   gl_FragColor *= sample.a;","}"].join("\n")}}]),Filter}();exports.default=Filter},{"../../../const":41,"../../../settings":96,"../../../utils":120,"./extractUniformsFromSrc":82}],82:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default=function(vertUniforms,fragUniforms,mask){vertUniforms=extractUniformsFromString(vertUniforms),fragUniforms=extractUniformsFromString(fragUniforms);return Object.assign(vertUniforms,fragUniforms)};var obj,_pixiGlCore=require("pixi-gl-core");var defaultValue=((obj=_pixiGlCore)&&obj.__esModule?obj:{default:obj}).default.shader.defaultValue;function extractUniformsFromString(string){for(var nameSplit,maskRegex=new RegExp("^(projectionMatrix|uSampler|filterArea|filterClamp)$"),uniforms={},lines=string.replace(/\s+/g," ").split(/\s*;\s*/),i=0;i<lines.length;i++){var type,name,size=lines[i].trim();-1<size.indexOf("uniform")&&(type=(name=size.split(" "))[1],-(size=1)<(name=name[2]).indexOf("[")&&(name=(nameSplit=name.split(/\[|]/))[0],size*=Number(nameSplit[1])),name.match(maskRegex)||(uniforms[name]={value:defaultValue(type,size),name:name,type:type}))}return uniforms}},{"pixi-gl-core":24}],17:[function(require,module,exports){(function(process){(function(){function normalizeArray(parts,allowAboveRoot){for(var up=0,i=parts.length-1;0<=i;i--){var last=parts[i];"."===last?parts.splice(i,1):".."===last?(parts.splice(i,1),up++):up&&(parts.splice(i,1),up--)}if(allowAboveRoot)for(;up--;)parts.unshift("..");return parts}function filter(xs,f){if(xs.filter)return xs.filter(f);for(var res=[],i=0;i<xs.length;i++)f(xs[i],i,xs)&&res.push(xs[i]);return res}exports.resolve=function(){for(var resolvedPath="",resolvedAbsolute=!1,i=arguments.length-1;-1<=i&&!resolvedAbsolute;i--){var path=0<=i?arguments[i]:process.cwd();if("string"!=typeof path)throw new TypeError("Arguments to path.resolve must be strings");path&&(resolvedPath=path+"/"+resolvedPath,resolvedAbsolute="/"===path.charAt(0))}return(resolvedAbsolute?"/":"")+(resolvedPath=normalizeArray(filter(resolvedPath.split("/"),function(p){return!!p}),!resolvedAbsolute).join("/"))||"."},exports.normalize=function(path){var isAbsolute=exports.isAbsolute(path),trailingSlash="/"===substr(path,-1);return(path=normalizeArray(filter(path.split("/"),function(p){return!!p}),!isAbsolute).join("/"))||isAbsolute||(path="."),path&&trailingSlash&&(path+="/"),(isAbsolute?"/":"")+path},exports.isAbsolute=function(path){return"/"===path.charAt(0)},exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(paths,function(p,index){if("string"!=typeof p)throw new TypeError("Arguments to path.join must be strings");return p}).join("/"))},exports.relative=function(from,to){function trim(arr){for(var start=0;start<arr.length&&""===arr[start];start++);for(var end=arr.length-1;0<=end&&""===arr[end];end--);return end<start?[]:arr.slice(start,end-start+1)}from=exports.resolve(from).substr(1),to=exports.resolve(to).substr(1);for(var fromParts=trim(from.split("/")),toParts=trim(to.split("/")),length=Math.min(fromParts.length,toParts.length),samePartsLength=length,i=0;i<length;i++)if(fromParts[i]!==toParts[i]){samePartsLength=i;break}for(var outputParts=[],i=samePartsLength;i<fromParts.length;i++)outputParts.push("..");return(outputParts=outputParts.concat(toParts.slice(samePartsLength))).join("/")},exports.sep="/",exports.delimiter=":",exports.dirname=function(path){if("string"!=typeof path&&(path+=""),0===path.length)return".";for(var code=path.charCodeAt(0),hasRoot=47===code,end=-1,matchedSlash=!0,i=path.length-1;1<=i;--i)if(47===path.charCodeAt(i)){if(!matchedSlash){end=i;break}}else matchedSlash=!1;return-1===end?hasRoot?"/":".":hasRoot&&1===end?"/":path.slice(0,end)},exports.basename=function(f,ext){f=function(path){"string"!=typeof path&&(path+="");for(var start=0,end=-1,matchedSlash=!0,i=path.length-1;0<=i;--i)if(47===path.charCodeAt(i)){if(!matchedSlash){start=i+1;break}}else-1===end&&(matchedSlash=!1,end=i+1);return-1===end?"":path.slice(start,end)}(f);return ext&&f.substr(-1*ext.length)===ext&&(f=f.substr(0,f.length-ext.length)),f},exports.extname=function(path){"string"!=typeof path&&(path+="");for(var startDot=-1,startPart=0,end=-1,matchedSlash=!0,preDotState=0,i=path.length-1;0<=i;--i){var code=path.charCodeAt(i);if(47===code){if(matchedSlash)continue;startPart=i+1;break}-1===end&&(matchedSlash=!1,end=i+1),46===code?-1===startDot?startDot=i:1!==preDotState&&(preDotState=1):-1!==startDot&&(preDotState=-1)}return-1===startDot||-1===end||0===preDotState||1===preDotState&&startDot===end-1&&startDot===startPart+1?"":path.slice(startDot,end)};var substr="b"==="ab".substr(-1)?function(str,start,len){return str.substr(start,len)}:function(str,start,len){return start<0&&(start=str.length+start),str.substr(start,len)}}).call(this)}).call(this,require("_process"))},{_process:185}],185:[function(require,process,exports){var cachedSetTimeout,cachedClearTimeout,process=process.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,function(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(name){return[]},process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],85:[function(require,module,exports){"use strict";exports.__esModule=!0;var FilterManager=_interopRequireDefault(require("./WebGLManager")),_RenderTarget2=_interopRequireDefault(require("../utils/RenderTarget")),_Quad2=_interopRequireDefault(require("../utils/Quad")),_math=require("../../../math"),_Shader2=_interopRequireDefault(require("../../../Shader")),filterTransforms=function(obj){{if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}}(require("../filters/filterTransforms")),_bitTwiddle2=_interopRequireDefault(require("bit-twiddle"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var FilterState=function(){function FilterState(){_classCallCheck(this,FilterState),this.renderTarget=null,this.target=null,this.resolution=1,this.sourceFrame=new _math.Rectangle,this.destinationFrame=new _math.Rectangle,this.filters=[]}return FilterState.prototype.clear=function(){this.filters=null,this.target=null,this.renderTarget=null},FilterState}(),FilterManager=function(_WebGLManager){function FilterManager(renderer){_classCallCheck(this,FilterManager);var _this=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_WebGLManager.call(this,renderer));return _this.gl=_this.renderer.gl,_this.quad=new _Quad2.default(_this.gl,renderer.state.attribState),_this.shaderCache={},_this.pool={},_this.filterData=null,_this.managedFilters=[],_this.renderer.on("prerender",_this.onPrerender,_this),_this._screenWidth=renderer.view.width,_this._screenHeight=renderer.view.height,_this}return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(FilterManager,_WebGLManager),FilterManager.prototype.pushFilter=function(target,filters){var renderer=this.renderer,filterData=this.filterData;filterData||(filterData=this.renderer._activeRenderTarget.filterStack,(destinationFrame=new FilterState).sourceFrame=destinationFrame.destinationFrame=this.renderer._activeRenderTarget.size,destinationFrame.renderTarget=renderer._activeRenderTarget,this.renderer._activeRenderTarget.filterData=filterData={index:0,stack:[destinationFrame]},this.filterData=filterData);var currentState=filterData.stack[++filterData.index],renderTargetFrame=filterData.stack[0].destinationFrame,currentState=currentState||(filterData.stack[filterData.index]=new FilterState),fullScreen=target.filterArea&&0===target.filterArea.x&&0===target.filterArea.y&&target.filterArea.width===renderer.screen.width&&target.filterArea.height===renderer.screen.height,resolution=filters[0].resolution,renderTarget=0|filters[0].padding,targetBounds=fullScreen?renderer.screen:target.filterArea||target.getBounds(!0),sourceFrame=currentState.sourceFrame,destinationFrame=currentState.destinationFrame;sourceFrame.x=(targetBounds.x*resolution|0)/resolution,sourceFrame.y=(targetBounds.y*resolution|0)/resolution,sourceFrame.width=(targetBounds.width*resolution|0)/resolution,sourceFrame.height=(targetBounds.height*resolution|0)/resolution,fullScreen||(filterData.stack[0].renderTarget.transform||filters[0].autoFit&&sourceFrame.fit(renderTargetFrame),sourceFrame.pad(renderTarget)),destinationFrame.width=sourceFrame.width,destinationFrame.height=sourceFrame.height;renderTarget=this.getPotRenderTarget(renderer.gl,sourceFrame.width,sourceFrame.height,resolution);currentState.target=target,currentState.filters=filters,currentState.resolution=resolution,(currentState.renderTarget=renderTarget).setFrame(destinationFrame,sourceFrame),renderer.bindRenderTarget(renderTarget),renderTarget.clear()},FilterManager.prototype.popFilter=function(){var filterData=this.filterData,lastState=filterData.stack[filterData.index-1],currentState=filterData.stack[filterData.index];this.quad.map(currentState.renderTarget.size,currentState.sourceFrame).upload();var filters=currentState.filters;if(1===filters.length)filters[0].apply(this,currentState.renderTarget,lastState.renderTarget,!1,currentState),this.freePotRenderTarget(currentState.renderTarget);else{var flip=currentState.renderTarget;(flop=this.getPotRenderTarget(this.renderer.gl,currentState.sourceFrame.width,currentState.sourceFrame.height,currentState.resolution)).setFrame(currentState.destinationFrame,currentState.sourceFrame),flop.clear();for(var i=0,i=0;i<filters.length-1;++i){filters[i].apply(this,flip,flop,!0,currentState);var t=flip,flip=flop,flop=t}filters[i].apply(this,flip,lastState.renderTarget,!1,currentState),this.freePotRenderTarget(flip),this.freePotRenderTarget(flop)}currentState.clear(),filterData.index--,0===filterData.index&&(this.filterData=null)},FilterManager.prototype.applyFilter=function(filter,input,tex,clear){var renderer=this.renderer,gl=renderer.gl,shader=filter.glShaders[renderer.CONTEXT_UID];shader||(filter.glShaderKey?(shader=this.shaderCache[filter.glShaderKey])||(shader=new _Shader2.default(this.gl,filter.vertexSrc,filter.fragmentSrc),filter.glShaders[renderer.CONTEXT_UID]=this.shaderCache[filter.glShaderKey]=shader,this.managedFilters.push(filter)):(shader=filter.glShaders[renderer.CONTEXT_UID]=new _Shader2.default(this.gl,filter.vertexSrc,filter.fragmentSrc),this.managedFilters.push(filter)),renderer.bindVao(null),this.quad.initVao(shader)),renderer.bindVao(this.quad.vao),renderer.bindRenderTarget(tex),clear&&(gl.disable(gl.SCISSOR_TEST),renderer.clear(),gl.enable(gl.SCISSOR_TEST)),tex===renderer.maskManager.scissorRenderTarget&&renderer.maskManager.pushScissorMask(null,renderer.maskManager.scissorData),renderer.bindShader(shader);tex=this.renderer.emptyTextures[0];this.renderer.boundTextures[0]=tex,this.syncUniforms(shader,filter),renderer.state.setBlendMode(filter.blendMode),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,input.texture.texture),this.quad.vao.draw(this.renderer.gl.TRIANGLES,6,0),gl.bindTexture(gl.TEXTURE_2D,tex._glTextures[this.renderer.CONTEXT_UID].texture)},FilterManager.prototype.syncUniforms=function(shader,currentState){var filterClamp,i,type,val,uniformData=currentState.uniformData,uniforms=currentState.uniforms,textureCount=1,currentState=void 0;for(i in shader.uniforms.filterArea&&(currentState=this.filterData.stack[this.filterData.index],(filterClamp=shader.uniforms.filterArea)[0]=currentState.renderTarget.size.width,filterClamp[1]=currentState.renderTarget.size.height,filterClamp[2]=currentState.sourceFrame.x,filterClamp[3]=currentState.sourceFrame.y,shader.uniforms.filterArea=filterClamp),shader.uniforms.filterClamp&&(currentState=currentState||this.filterData.stack[this.filterData.index],(filterClamp=shader.uniforms.filterClamp)[0]=0,filterClamp[1]=0,filterClamp[2]=(currentState.sourceFrame.width-1)/currentState.renderTarget.size.width,filterClamp[3]=(currentState.sourceFrame.height-1)/currentState.renderTarget.size.height,shader.uniforms.filterClamp=filterClamp),uniformData)shader.uniforms.data[i]&&("sampler2d"===(type=uniformData[i].type)&&0!==uniforms[i]?(uniforms[i].baseTexture?shader.uniforms[i]=this.renderer.bindTexture(uniforms[i].baseTexture,textureCount):(shader.uniforms[i]=textureCount,val=this.renderer.gl,this.renderer.boundTextures[textureCount]=this.renderer.emptyTextures[textureCount],val.activeTexture(val.TEXTURE0+textureCount),uniforms[i].texture.bind()),textureCount++):"mat3"===type?void 0!==uniforms[i].a?shader.uniforms[i]=uniforms[i].toArray(!0):shader.uniforms[i]=uniforms[i]:"vec2"===type?void 0!==uniforms[i].x?((val=shader.uniforms[i]||new Float32Array(2))[0]=uniforms[i].x,val[1]=uniforms[i].y,shader.uniforms[i]=val):shader.uniforms[i]=uniforms[i]:"float"===type&&shader.uniforms.data[i].value===uniformData[i]||(shader.uniforms[i]=uniforms[i]))},FilterManager.prototype.getRenderTarget=function(clear,renderTarget){var currentState=this.filterData.stack[this.filterData.index],renderTarget=this.getPotRenderTarget(this.renderer.gl,currentState.sourceFrame.width,currentState.sourceFrame.height,renderTarget||currentState.resolution);return renderTarget.setFrame(currentState.destinationFrame,currentState.sourceFrame),renderTarget},FilterManager.prototype.returnRenderTarget=function(renderTarget){this.freePotRenderTarget(renderTarget)},FilterManager.prototype.calculateScreenSpaceMatrix=function(outputMatrix){var currentState=this.filterData.stack[this.filterData.index];return filterTransforms.calculateScreenSpaceMatrix(outputMatrix,currentState.sourceFrame,currentState.renderTarget.size)},FilterManager.prototype.calculateNormalizedScreenSpaceMatrix=function(outputMatrix){var currentState=this.filterData.stack[this.filterData.index];return filterTransforms.calculateNormalizedScreenSpaceMatrix(outputMatrix,currentState.sourceFrame,currentState.renderTarget.size,currentState.destinationFrame)},FilterManager.prototype.calculateSpriteMatrix=function(outputMatrix,sprite){var currentState=this.filterData.stack[this.filterData.index];return filterTransforms.calculateSpriteMatrix(outputMatrix,currentState.sourceFrame,currentState.renderTarget.size,sprite)},FilterManager.prototype.destroy=function(){var contextLost=0<arguments.length&&void 0!==arguments[0]&&arguments[0],renderer=this.renderer,filters=this.managedFilters;renderer.off("prerender",this.onPrerender,this);for(var i=0;i<filters.length;i++)contextLost||filters[i].glShaders[renderer.CONTEXT_UID].destroy(),delete filters[i].glShaders[renderer.CONTEXT_UID];this.shaderCache={},contextLost?this.pool={}:this.emptyPool()},FilterManager.prototype.getPotRenderTarget=function(gl,minWidth,minHeight,resolution){var key="screen";minHeight*=resolution,(minWidth*=resolution)===this._screenWidth&&minHeight===this._screenHeight||(key=(65535&(minWidth=_bitTwiddle2.default.nextPow2(minWidth)))<<16|65535&(minHeight=_bitTwiddle2.default.nextPow2(minHeight))),this.pool[key]||(this.pool[key]=[]);var tex,renderTarget=this.pool[key].pop();return renderTarget||(tex=this.renderer.boundTextures[0],gl.activeTexture(gl.TEXTURE0),renderTarget=new _RenderTarget2.default(gl,minWidth,minHeight,null,1),gl.bindTexture(gl.TEXTURE_2D,tex._glTextures[this.renderer.CONTEXT_UID].texture)),renderTarget.resolution=resolution,renderTarget.defaultFrame.width=renderTarget.size.width=minWidth/resolution,renderTarget.defaultFrame.height=renderTarget.size.height=minHeight/resolution,renderTarget.filterPoolKey=key,renderTarget},FilterManager.prototype.emptyPool=function(){for(var i in this.pool){var textures=this.pool[i];if(textures)for(var j=0;j<textures.length;j++)textures[j].destroy(!0)}this.pool={}},FilterManager.prototype.freePotRenderTarget=function(renderTarget){this.pool[renderTarget.filterPoolKey].push(renderTarget)},FilterManager.prototype.onPrerender=function(){if(this._screenWidth!==this.renderer.view.width||this._screenHeight!==this.renderer.view.height){this._screenWidth=this.renderer.view.width,this._screenHeight=this.renderer.view.height;var textures=this.pool.screen;if(textures)for(var j=0;j<textures.length;j++)textures[j].destroy(!0);this.pool.screen=[]}},FilterManager}(FilterManager.default);exports.default=FilterManager},{"../../../Shader":39,"../../../math":65,"../filters/filterTransforms":83,"../utils/Quad":90,"../utils/RenderTarget":91,"./WebGLManager":88,"bit-twiddle":8}],90:[function(Quad,module,exports){"use strict";exports.__esModule=!0;var _pixiGlCore2=_interopRequireDefault(Quad("pixi-gl-core")),_createIndicesForQuads2=_interopRequireDefault(Quad("../../../utils/createIndicesForQuads"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Quad=function(){function Quad(gl,state){!function(instance){if(!(instance instanceof Quad))throw new TypeError("Cannot call a class as a function")}(this),this.gl=gl,this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.interleaved=new Float32Array(16);for(var i=0;i<4;i++)this.interleaved[4*i]=this.vertices[2*i],this.interleaved[4*i+1]=this.vertices[2*i+1],this.interleaved[4*i+2]=this.uvs[2*i],this.interleaved[4*i+3]=this.uvs[2*i+1];this.indices=(0,_createIndicesForQuads2.default)(1),this.vertexBuffer=_pixiGlCore2.default.GLBuffer.createVertexBuffer(gl,this.interleaved,gl.STATIC_DRAW),this.indexBuffer=_pixiGlCore2.default.GLBuffer.createIndexBuffer(gl,this.indices,gl.STATIC_DRAW),this.vao=new _pixiGlCore2.default.VertexArrayObject(gl,state)}return Quad.prototype.initVao=function(shader){this.vao.clear().addIndex(this.indexBuffer).addAttribute(this.vertexBuffer,shader.attributes.aVertexPosition,this.gl.FLOAT,!1,16,0).addAttribute(this.vertexBuffer,shader.attributes.aTextureCoord,this.gl.FLOAT,!1,16,8)},Quad.prototype.map=function(targetTextureFrame,destinationFrame){var x,y;return this.uvs[0]=0,this.uvs[1]=0,this.uvs[2]=0+destinationFrame.width/targetTextureFrame.width,this.uvs[3]=0,this.uvs[4]=0+destinationFrame.width/targetTextureFrame.width,this.uvs[5]=0+destinationFrame.height/targetTextureFrame.height,this.uvs[6]=0,this.uvs[7]=0+destinationFrame.height/targetTextureFrame.height,x=destinationFrame.x,y=destinationFrame.y,this.vertices[0]=x,this.vertices[1]=y,this.vertices[2]=x+destinationFrame.width,this.vertices[3]=y,this.vertices[4]=x+destinationFrame.width,this.vertices[5]=y+destinationFrame.height,this.vertices[6]=x,this.vertices[7]=y+destinationFrame.height,this},Quad.prototype.upload=function(){for(var i=0;i<4;i++)this.interleaved[4*i]=this.vertices[2*i],this.interleaved[4*i+1]=this.vertices[2*i+1],this.interleaved[4*i+2]=this.uvs[2*i],this.interleaved[4*i+3]=this.uvs[2*i+1];return this.vertexBuffer.upload(this.interleaved),this},Quad.prototype.destroy=function(){var gl=this.gl;gl.deleteBuffer(this.vertexBuffer),gl.deleteBuffer(this.indexBuffer)},Quad}();exports.default=Quad},{"../../../utils/createIndicesForQuads":118,"pixi-gl-core":24}],118:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default=function(size){for(var totalIndices=6*size,indices=new Uint16Array(totalIndices),i=0,j=0;i<totalIndices;i+=6,j+=4)indices[i+0]=j+0,indices[i+1]=j+1,indices[i+2]=j+2,indices[i+3]=j+0,indices[i+4]=j+2,indices[i+5]=j+3;return indices}},{}],88:[function(require,module,exports){"use strict";exports.__esModule=!0;var WebGLManager=function(){function WebGLManager(renderer){!function(instance){if(!(instance instanceof WebGLManager))throw new TypeError("Cannot call a class as a function")}(this),this.renderer=renderer,this.renderer.on("context",this.onContextChange,this)}return WebGLManager.prototype.onContextChange=function(){},WebGLManager.prototype.destroy=function(){this.renderer.off("context",this.onContextChange,this),this.renderer=null},WebGLManager}();exports.default=WebGLManager},{}],83:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.calculateScreenSpaceMatrix=function(mappedMatrix,filterArea,textureSize){mappedMatrix=mappedMatrix.identity();return mappedMatrix.translate(filterArea.x/textureSize.width,filterArea.y/textureSize.height),mappedMatrix.scale(textureSize.width,textureSize.height),mappedMatrix},exports.calculateNormalizedScreenSpaceMatrix=function(translateScaleX,translateScaleY,textureSize){var mappedMatrix=translateScaleX.identity();mappedMatrix.translate(translateScaleY.x/textureSize.width,translateScaleY.y/textureSize.height);translateScaleX=textureSize.width/translateScaleY.width,translateScaleY=textureSize.height/translateScaleY.height;return mappedMatrix.scale(translateScaleX,translateScaleY),mappedMatrix},exports.calculateSpriteMatrix=function(outputMatrix,worldTransform,mappedMatrix,sprite){var orig=sprite._texture.orig,mappedMatrix=outputMatrix.set(mappedMatrix.width,0,0,mappedMatrix.height,worldTransform.x,worldTransform.y),worldTransform=sprite.worldTransform.copy(_math.Matrix.TEMP_MATRIX);return worldTransform.invert(),mappedMatrix.prepend(worldTransform),mappedMatrix.scale(1/orig.width,1/orig.height),mappedMatrix.translate(sprite.anchor.x,sprite.anchor.y),mappedMatrix};var _math=require("../../../math")},{"../../../math":65}],39:[function(require,module,exports){"use strict";exports.__esModule=!0;var obj,Shader=require("pixi-gl-core"),_settings=require("./settings"),_settings2=(obj=_settings)&&obj.__esModule?obj:{default:obj};function checkPrecision(src,def){if(src instanceof Array){if("precision"!==src[0].substring(0,9)){var copy=src.slice(0);return copy.unshift("precision "+def+" float;"),copy}}else if("precision"!==src.trim().substring(0,9))return"precision "+def+" float;\n"+src;return src}Shader=function(_GLShader){function Shader(gl,vertexSrc,fragmentSrc,attributeLocations,precision){return function(instance){if(!(instance instanceof Shader))throw new TypeError("Cannot call a class as a function")}(this),function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_GLShader.call(this,gl,checkPrecision(vertexSrc,precision||_settings2.default.PRECISION_VERTEX),checkPrecision(fragmentSrc,precision||_settings2.default.PRECISION_FRAGMENT),void 0,attributeLocations))}return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(Shader,_GLShader),Shader}(Shader.GLShader);exports.default=Shader},{"./settings":96,"pixi-gl-core":24}],80:[function(WebGLState,module,exports){"use strict";exports.__esModule=!0;var obj,_mapWebGLBlendModesToPixi=WebGLState("./utils/mapWebGLBlendModesToPixi"),_mapWebGLBlendModesToPixi2=(obj=_mapWebGLBlendModesToPixi)&&obj.__esModule?obj:{default:obj};WebGLState=function(){function WebGLState(gl){!function(instance){if(!(instance instanceof WebGLState))throw new TypeError("Cannot call a class as a function")}(this),this.activeState=new Uint8Array(16),this.defaultState=new Uint8Array(16),this.defaultState[0]=1,this.stackIndex=0,this.stack=[],this.gl=gl,this.maxAttribs=gl.getParameter(gl.MAX_VERTEX_ATTRIBS),this.attribState={tempAttribState:new Array(this.maxAttribs),attribState:new Array(this.maxAttribs)},this.blendModes=(0,_mapWebGLBlendModesToPixi2.default)(gl),this.nativeVaoExtension=gl.getExtension("OES_vertex_array_object")||gl.getExtension("MOZ_OES_vertex_array_object")||gl.getExtension("WEBKIT_OES_vertex_array_object")}return WebGLState.prototype.push=function(){var state=(state=this.stack[this.stackIndex])||(this.stack[this.stackIndex]=new Uint8Array(16));++this.stackIndex;for(var i=0;i<this.activeState.length;i++)state[i]=this.activeState[i]},WebGLState.prototype.pop=function(){var state=this.stack[--this.stackIndex];this.setState(state)},WebGLState.prototype.setState=function(state){this.setBlend(state[0]),this.setDepthTest(state[1]),this.setFrontFace(state[2]),this.setCullFace(state[3]),this.setBlendMode(state[4])},WebGLState.prototype.setBlend=function(value){value=value?1:0,this.activeState[0]!==value&&(this.activeState[0]=value,this.gl[value?"enable":"disable"](this.gl.BLEND))},WebGLState.prototype.setBlendMode=function(mode){mode!==this.activeState[4]&&(this.activeState[4]=mode,2===(mode=this.blendModes[mode]).length?this.gl.blendFunc(mode[0],mode[1]):this.gl.blendFuncSeparate(mode[0],mode[1],mode[2],mode[3]))},WebGLState.prototype.setDepthTest=function(value){value=value?1:0,this.activeState[1]!==value&&(this.activeState[1]=value,this.gl[value?"enable":"disable"](this.gl.DEPTH_TEST))},WebGLState.prototype.setCullFace=function(value){value=value?1:0,this.activeState[3]!==value&&(this.activeState[3]=value,this.gl[value?"enable":"disable"](this.gl.CULL_FACE))},WebGLState.prototype.setFrontFace=function(value){value=value?1:0,this.activeState[2]!==value&&(this.activeState[2]=value,this.gl.frontFace(this.gl[value?"CW":"CCW"]))},WebGLState.prototype.resetAttributes=function(){for(var i=0;i<this.attribState.tempAttribState.length;i++)this.attribState.tempAttribState[i]=0;for(var _i=0;_i<this.attribState.attribState.length;_i++)this.attribState.attribState[_i]=0;for(var _i2=1;_i2<this.maxAttribs;_i2++)this.gl.disableVertexAttribArray(_i2)},WebGLState.prototype.resetToDefault=function(){this.nativeVaoExtension&&this.nativeVaoExtension.bindVertexArrayOES(null),this.resetAttributes();for(var i=0;i<this.activeState.length;++i)this.activeState[i]=32;this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.setState(this.defaultState)},WebGLState}();exports.default=WebGLState},{"./utils/mapWebGLBlendModesToPixi":93}],93:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default=function(gl){var array=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];return array[_const.BLEND_MODES.NORMAL]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.ADD]=[gl.ONE,gl.ONE],array[_const.BLEND_MODES.MULTIPLY]=[gl.DST_COLOR,gl.ONE_MINUS_SRC_ALPHA,gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.SCREEN]=[gl.ONE,gl.ONE_MINUS_SRC_COLOR,gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.OVERLAY]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.DARKEN]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.LIGHTEN]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.COLOR_DODGE]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.COLOR_BURN]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.HARD_LIGHT]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.SOFT_LIGHT]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.DIFFERENCE]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.EXCLUSION]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.HUE]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.SATURATION]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.COLOR]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.LUMINOSITY]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.NORMAL_NPM]=[gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA,gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.ADD_NPM]=[gl.SRC_ALPHA,gl.ONE,gl.ONE,gl.ONE],array[_const.BLEND_MODES.SCREEN_NPM]=[gl.SRC_ALPHA,gl.ONE_MINUS_SRC_COLOR,gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array};var _const=require("../../../const")},{"../../../const":41}],78:[function(TextureManager,module,exports){"use strict";exports.__esModule=!0;var obj,_pixiGlCore=TextureManager("pixi-gl-core"),_const=TextureManager("../../const"),_RenderTarget=TextureManager("./utils/RenderTarget"),_RenderTarget2=(obj=_RenderTarget)&&obj.__esModule?obj:{default:obj},_utils=TextureManager("../../utils");TextureManager=function(){function TextureManager(renderer){!function(instance){if(!(instance instanceof TextureManager))throw new TypeError("Cannot call a class as a function")}(this),this.renderer=renderer,this.gl=renderer.gl,this._managedTextures=[]}return TextureManager.prototype.bindTexture=function(){},TextureManager.prototype.getTexture=function(){},TextureManager.prototype.updateTexture=function(texture,location){var glTexture=this.gl,renderTarget=!!texture._glRenderTargets;if(!texture.hasLoaded)return null;var boundTextures=this.renderer.boundTextures;if(void 0===location)for(var i=location=0;i<boundTextures.length;++i)if(boundTextures[i]===texture){location=i;break}boundTextures[location]=texture,glTexture.activeTexture(glTexture.TEXTURE0+location);glTexture=texture._glTextures[this.renderer.CONTEXT_UID];return glTexture?renderTarget?texture._glRenderTargets[this.renderer.CONTEXT_UID].resize(texture.width,texture.height):glTexture.upload(texture.source):(renderTarget?((renderTarget=new _RenderTarget2.default(this.gl,texture.width,texture.height,texture.scaleMode,texture.resolution)).resize(texture.width,texture.height),glTexture=(texture._glRenderTargets[this.renderer.CONTEXT_UID]=renderTarget).texture,this.renderer._activeRenderTarget.root||this.renderer._activeRenderTarget.frameBuffer.bind()):((glTexture=new _pixiGlCore.GLTexture(this.gl,null,null,null,null)).bind(location),glTexture.premultiplyAlpha=!0,glTexture.upload(texture.source)),texture._glTextures[this.renderer.CONTEXT_UID]=glTexture,texture.on("update",this.updateTexture,this),texture.on("dispose",this.destroyTexture,this),this._managedTextures.push(texture),texture.isPowerOfTwo?(texture.mipmap&&glTexture.enableMipmap(),texture.wrapMode===_const.WRAP_MODES.CLAMP?glTexture.enableWrapClamp():texture.wrapMode===_const.WRAP_MODES.REPEAT?glTexture.enableWrapRepeat():glTexture.enableWrapMirrorRepeat()):glTexture.enableWrapClamp(),texture.scaleMode===_const.SCALE_MODES.NEAREST?glTexture.enableNearestScaling():glTexture.enableLinearScaling()),glTexture},TextureManager.prototype.destroyTexture=function(i,skipRemove){var renderer,uid,glTextures,glRenderTargets;(i=i.baseTexture||i).hasLoaded&&(uid=(renderer=this.renderer).CONTEXT_UID,glTextures=i._glTextures,glRenderTargets=i._glRenderTargets,glTextures[uid]&&(renderer.unbindTexture(i),glTextures[uid].destroy(),i.off("update",this.updateTexture,this),i.off("dispose",this.destroyTexture,this),delete glTextures[uid],skipRemove||-1!==(i=this._managedTextures.indexOf(i))&&(0,_utils.removeItems)(this._managedTextures,i,1)),glRenderTargets&&glRenderTargets[uid]&&(renderer._activeRenderTarget===glRenderTargets[uid]&&renderer.bindRenderTarget(renderer.rootRenderTarget),glRenderTargets[uid].destroy(),delete glRenderTargets[uid]))},TextureManager.prototype.removeAll=function(){for(var i=0;i<this._managedTextures.length;++i){var texture=this._managedTextures[i];texture._glTextures[this.renderer.CONTEXT_UID]&&delete texture._glTextures[this.renderer.CONTEXT_UID]}},TextureManager.prototype.destroy=function(){for(var i=0;i<this._managedTextures.length;++i){var texture=this._managedTextures[i];this.destroyTexture(texture,!0),texture.off("update",this.updateTexture,this),texture.off("dispose",this.destroyTexture,this)}this._managedTextures=null},TextureManager}();exports.default=TextureManager},{"../../const":41,"../../utils":120,"./utils/RenderTarget":91,"pixi-gl-core":24}],91:[function(RenderTarget,module,exports){"use strict";exports.__esModule=!0;var obj,_math=RenderTarget("../../../math"),_const=RenderTarget("../../../const"),_settings=RenderTarget("../../../settings"),_settings2=(obj=_settings)&&obj.__esModule?obj:{default:obj},_pixiGlCore=RenderTarget("pixi-gl-core");RenderTarget=function(){function RenderTarget(gl,width,height,scaleMode,resolution,root){!function(instance){if(!(instance instanceof RenderTarget))throw new TypeError("Cannot call a class as a function")}(this),this.gl=gl,this.frameBuffer=null,this.texture=null,this.clearColor=[0,0,0,0],this.size=new _math.Rectangle(0,0,1,1),this.resolution=resolution||_settings2.default.RESOLUTION,this.projectionMatrix=new _math.Matrix,this.transform=null,this.frame=null,this.defaultFrame=new _math.Rectangle,this.destinationFrame=null,this.sourceFrame=null,this.stencilBuffer=null,this.stencilMaskStack=[],this.filterData=null,this.filterPoolKey="",this.scaleMode=void 0!==scaleMode?scaleMode:_settings2.default.SCALE_MODE,this.root=root||!1,this.root?(this.frameBuffer=new _pixiGlCore.GLFramebuffer(gl,100,100),this.frameBuffer.framebuffer=null):(this.frameBuffer=_pixiGlCore.GLFramebuffer.createRGBA(gl,100,100),this.scaleMode===_const.SCALE_MODES.NEAREST?this.frameBuffer.texture.enableNearestScaling():this.frameBuffer.texture.enableLinearScaling(),this.texture=this.frameBuffer.texture),this.setFrame(),this.resize(width,height)}return RenderTarget.prototype.clear=function(cc){cc=cc||this.clearColor;this.frameBuffer.clear(cc[0],cc[1],cc[2],cc[3])},RenderTarget.prototype.attachStencilBuffer=function(){this.root||this.frameBuffer.enableStencil()},RenderTarget.prototype.setFrame=function(destinationFrame,sourceFrame){this.destinationFrame=destinationFrame||this.destinationFrame||this.defaultFrame,this.sourceFrame=sourceFrame||this.sourceFrame||this.destinationFrame},RenderTarget.prototype.activate=function(){var gl=this.gl;this.frameBuffer.bind(),this.calculateProjection(this.destinationFrame,this.sourceFrame),this.transform&&this.projectionMatrix.append(this.transform),this.destinationFrame!==this.sourceFrame?(gl.enable(gl.SCISSOR_TEST),gl.scissor(0|this.destinationFrame.x,0|this.destinationFrame.y,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)):gl.disable(gl.SCISSOR_TEST),gl.viewport(0|this.destinationFrame.x,0|this.destinationFrame.y,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)},RenderTarget.prototype.calculateProjection=function(destinationFrame,sourceFrame){var pm=this.projectionMatrix;sourceFrame=sourceFrame||destinationFrame,pm.identity(),this.root?(pm.a=1/destinationFrame.width*2,pm.d=-1/destinationFrame.height*2,pm.tx=-1-sourceFrame.x*pm.a,pm.ty=1-sourceFrame.y*pm.d):(pm.a=1/destinationFrame.width*2,pm.d=1/destinationFrame.height*2,pm.tx=-1-sourceFrame.x*pm.a,pm.ty=-1-sourceFrame.y*pm.d)},RenderTarget.prototype.resize=function(width,projectionFrame){width|=0,projectionFrame|=0,this.size.width===width&&this.size.height===projectionFrame||(this.size.width=width,this.size.height=projectionFrame,this.defaultFrame.width=width,this.defaultFrame.height=projectionFrame,this.frameBuffer.resize(width*this.resolution,projectionFrame*this.resolution),projectionFrame=this.frame||this.size,this.calculateProjection(projectionFrame))},RenderTarget.prototype.destroy=function(){this.frameBuffer.stencil&&this.gl.deleteRenderbuffer(this.frameBuffer.stencil),this.frameBuffer.destroy(),this.frameBuffer=null,this.texture=null},RenderTarget}();exports.default=RenderTarget},{"../../../const":41,"../../../math":65,"../../../settings":96,"pixi-gl-core":24}],77:[function(TextureGarbageCollector,module,exports){"use strict";exports.__esModule=!0;var obj,_const=TextureGarbageCollector("../../const"),_settings=TextureGarbageCollector("../../settings"),_settings2=(obj=_settings)&&obj.__esModule?obj:{default:obj};TextureGarbageCollector=function(){function TextureGarbageCollector(renderer){!function(instance){if(!(instance instanceof TextureGarbageCollector))throw new TypeError("Cannot call a class as a function")}(this),this.renderer=renderer,this.count=0,this.checkCount=0,this.maxIdle=_settings2.default.GC_MAX_IDLE,this.checkCountMax=_settings2.default.GC_MAX_CHECK_COUNT,this.mode=_settings2.default.GC_MODE}return TextureGarbageCollector.prototype.update=function(){this.count++,this.mode!==_const.GC_MODES.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run()))},TextureGarbageCollector.prototype.run=function(){for(var tm=this.renderer.textureManager,managedTextures=tm._managedTextures,wasRemoved=!1,i=0;i<managedTextures.length;i++){var texture=managedTextures[i];!texture._glRenderTargets&&this.count-texture.touched>this.maxIdle&&(tm.destroyTexture(texture,!0),wasRemoved=!(managedTextures[i]=null))}if(wasRemoved){for(var j=0,_i=0;_i<managedTextures.length;_i++)null!==managedTextures[_i]&&(managedTextures[j++]=managedTextures[_i]);managedTextures.length=j}},TextureGarbageCollector.prototype.unload=function(displayObject){var tm=this.renderer.textureManager;displayObject._texture&&displayObject._texture._glRenderTargets&&tm.destroyTexture(displayObject._texture,!0);for(var i=displayObject.children.length-1;0<=i;i--)this.unload(displayObject.children[i])},TextureGarbageCollector}();exports.default=TextureGarbageCollector},{"../../const":41,"../../settings":96}],72:[function(require,module,exports){"use strict";exports.__esModule=!0;var CanvasRenderer=_interopRequireDefault(require("../SystemRenderer")),_CanvasMaskManager2=_interopRequireDefault(require("./utils/CanvasMaskManager")),_CanvasRenderTarget2=_interopRequireDefault(require("./utils/CanvasRenderTarget")),_mapCanvasBlendModesToPixi2=_interopRequireDefault(require("./utils/mapCanvasBlendModesToPixi")),_utils=require("../../utils"),_const=require("../../const"),_settings2=_interopRequireDefault(require("../../settings"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}CanvasRenderer=function(_SystemRenderer){function CanvasRenderer(options,arg2,_this){!function(instance){if(!(instance instanceof CanvasRenderer))throw new TypeError("Cannot call a class as a function")}(this);_this=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_SystemRenderer.call(this,"Canvas",options,arg2,_this));return _this.type=_const.RENDERER_TYPE.CANVAS,_this.rootContext=_this.view.getContext("2d",{alpha:_this.transparent}),_this.context=_this.rootContext,_this.refresh=!0,_this.maskManager=new _CanvasMaskManager2.default(_this),_this.smoothProperty="imageSmoothingEnabled",_this.rootContext.imageSmoothingEnabled||(_this.rootContext.webkitImageSmoothingEnabled?_this.smoothProperty="webkitImageSmoothingEnabled":_this.rootContext.mozImageSmoothingEnabled?_this.smoothProperty="mozImageSmoothingEnabled":_this.rootContext.oImageSmoothingEnabled?_this.smoothProperty="oImageSmoothingEnabled":_this.rootContext.msImageSmoothingEnabled&&(_this.smoothProperty="msImageSmoothingEnabled")),_this.initPlugins(),_this.blendModes=(0,_mapCanvasBlendModesToPixi2.default)(),_this._activeBlendMode=null,_this.renderingToScreen=!1,_this.resize(_this.options.width,_this.options.height),_this}return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(CanvasRenderer,_SystemRenderer),CanvasRenderer.prototype.render=function(displayObject,cacheParent,tempContext,transform,tempWt){var rootResolution,context;this.view&&(this.renderingToScreen=!cacheParent,this.emit("prerender"),rootResolution=this.resolution,cacheParent?((cacheParent=cacheParent.baseTexture||cacheParent)._canvasRenderTarget||(cacheParent._canvasRenderTarget=new _CanvasRenderTarget2.default(cacheParent.width,cacheParent.height,cacheParent.resolution),cacheParent.source=cacheParent._canvasRenderTarget.canvas,cacheParent.valid=!0),this.context=cacheParent._canvasRenderTarget.context,this.resolution=cacheParent._canvasRenderTarget.resolution):this.context=this.rootContext,context=this.context,cacheParent||(this._lastObjectRendered=displayObject),tempWt||(cacheParent=displayObject.parent,tempWt=this._tempDisplayObjectParent.transform.worldTransform,transform?(transform.copy(tempWt),this._tempDisplayObjectParent.transform._worldID=-1):tempWt.identity(),displayObject.parent=this._tempDisplayObjectParent,displayObject.updateTransform(),displayObject.parent=cacheParent),context.save(),context.setTransform(1,0,0,1,0,0),context.globalAlpha=1,this._activeBlendMode=_const.BLEND_MODES.NORMAL,context.globalCompositeOperation=this.blendModes[_const.BLEND_MODES.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(context.fillStyle="black",context.clear()),(void 0!==tempContext?tempContext:this.clearBeforeRender)&&this.renderingToScreen&&(this.transparent?context.clearRect(0,0,this.width,this.height):(context.fillStyle=this._backgroundColorString,context.fillRect(0,0,this.width,this.height))),tempContext=this.context,this.context=context,displayObject.renderCanvas(this),this.context=tempContext,context.restore(),this.resolution=rootResolution,this.emit("postrender"))},CanvasRenderer.prototype.clear=function(clearColor){var context=this.context;clearColor=clearColor||this._backgroundColorString,!this.transparent&&clearColor?(context.fillStyle=clearColor,context.fillRect(0,0,this.width,this.height)):context.clearRect(0,0,this.width,this.height)},CanvasRenderer.prototype.setBlendMode=function(blendMode){this._activeBlendMode!==blendMode&&(this._activeBlendMode=blendMode,this.context.globalCompositeOperation=this.blendModes[blendMode])},CanvasRenderer.prototype.destroy=function(removeView){this.destroyPlugins(),_SystemRenderer.prototype.destroy.call(this,removeView),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},CanvasRenderer.prototype.resize=function(screenWidth,screenHeight){_SystemRenderer.prototype.resize.call(this,screenWidth,screenHeight),this.smoothProperty&&(this.rootContext[this.smoothProperty]=_settings2.default.SCALE_MODE===_const.SCALE_MODES.LINEAR)},CanvasRenderer.prototype.invalidateBlendMode=function(){this._activeBlendMode=this.blendModes.indexOf(this.context.globalCompositeOperation)},CanvasRenderer}(CanvasRenderer.default);exports.default=CanvasRenderer,_utils.pluginTarget.mixin(CanvasRenderer)},{"../../const":41,"../../settings":96,"../../utils":120,"../SystemRenderer":71,"./utils/CanvasMaskManager":73,"./utils/CanvasRenderTarget":74,"./utils/mapCanvasBlendModesToPixi":76}],76:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default=function(){var array=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];(0,_canUseNewCanvasBlendModes2.default)()?(array[_const.BLEND_MODES.NORMAL]="source-over",array[_const.BLEND_MODES.ADD]="lighter",array[_const.BLEND_MODES.MULTIPLY]="multiply",array[_const.BLEND_MODES.SCREEN]="screen",array[_const.BLEND_MODES.OVERLAY]="overlay",array[_const.BLEND_MODES.DARKEN]="darken",array[_const.BLEND_MODES.LIGHTEN]="lighten",array[_const.BLEND_MODES.COLOR_DODGE]="color-dodge",array[_const.BLEND_MODES.COLOR_BURN]="color-burn",array[_const.BLEND_MODES.HARD_LIGHT]="hard-light",array[_const.BLEND_MODES.SOFT_LIGHT]="soft-light",array[_const.BLEND_MODES.DIFFERENCE]="difference",array[_const.BLEND_MODES.EXCLUSION]="exclusion",array[_const.BLEND_MODES.HUE]="hue",array[_const.BLEND_MODES.SATURATION]="saturate",array[_const.BLEND_MODES.COLOR]="color",array[_const.BLEND_MODES.LUMINOSITY]="luminosity"):(array[_const.BLEND_MODES.NORMAL]="source-over",array[_const.BLEND_MODES.ADD]="lighter",array[_const.BLEND_MODES.MULTIPLY]="source-over",array[_const.BLEND_MODES.SCREEN]="source-over",array[_const.BLEND_MODES.OVERLAY]="source-over",array[_const.BLEND_MODES.DARKEN]="source-over",array[_const.BLEND_MODES.LIGHTEN]="source-over",array[_const.BLEND_MODES.COLOR_DODGE]="source-over",array[_const.BLEND_MODES.COLOR_BURN]="source-over",array[_const.BLEND_MODES.HARD_LIGHT]="source-over",array[_const.BLEND_MODES.SOFT_LIGHT]="source-over",array[_const.BLEND_MODES.DIFFERENCE]="source-over",array[_const.BLEND_MODES.EXCLUSION]="source-over",array[_const.BLEND_MODES.HUE]="source-over",array[_const.BLEND_MODES.SATURATION]="source-over",array[_const.BLEND_MODES.COLOR]="source-over",array[_const.BLEND_MODES.LUMINOSITY]="source-over");return array[_const.BLEND_MODES.NORMAL_NPM]=array[_const.BLEND_MODES.NORMAL],array[_const.BLEND_MODES.ADD_NPM]=array[_const.BLEND_MODES.ADD],array[_const.BLEND_MODES.SCREEN_NPM]=array[_const.BLEND_MODES.SCREEN],array};var obj,_const=require("../../../const"),_canUseNewCanvasBlendModes=require("./canUseNewCanvasBlendModes"),_canUseNewCanvasBlendModes2=(obj=_canUseNewCanvasBlendModes)&&obj.__esModule?obj:{default:obj}},{"../../../const":41,"./canUseNewCanvasBlendModes":75}],75:[function(require,module,exports){"use strict";function createColoredCanvas(color){var canvas=document.createElement("canvas");canvas.width=6,canvas.height=1;var context=canvas.getContext("2d");return context.fillStyle=color,context.fillRect(0,0,6,1),canvas}exports.__esModule=!0,exports.default=function(){if("undefined"==typeof document)return!1;var magenta=createColoredCanvas("#ff00ff"),yellow=createColoredCanvas("#ffff00"),data=document.createElement("canvas");data.width=6,data.height=1;data=data.getContext("2d");data.globalCompositeOperation="multiply",data.drawImage(magenta,0,0),data.drawImage(yellow,2,0);data=data.getImageData(2,0,1,1);if(!data)return!1;data=data.data;return 255===data[0]&&0===data[1]&&0===data[2]}},{}],74:[function(CanvasRenderTarget,module,exports){"use strict";exports.__esModule=!0;var _createClass=function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor};function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var obj,_settings=CanvasRenderTarget("../../../settings"),_settings2=(obj=_settings)&&obj.__esModule?obj:{default:obj};CanvasRenderTarget=function(){function CanvasRenderTarget(width,height,resolution){!function(instance){if(!(instance instanceof CanvasRenderTarget))throw new TypeError("Cannot call a class as a function")}(this),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=resolution||_settings2.default.RESOLUTION,this.resize(width,height)}return CanvasRenderTarget.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},CanvasRenderTarget.prototype.resize=function(width,height){this.canvas.width=width*this.resolution,this.canvas.height=height*this.resolution},CanvasRenderTarget.prototype.destroy=function(){this.context=null,this.canvas=null},_createClass(CanvasRenderTarget,[{key:"width",get:function(){return this.canvas.width},set:function(val){this.canvas.width=val}},{key:"height",get:function(){return this.canvas.height},set:function(val){this.canvas.height=val}}]),CanvasRenderTarget}();exports.default=CanvasRenderTarget},{"../../../settings":96}],73:[function(CanvasMaskManager,module,exports){"use strict";exports.__esModule=!0;var _const=CanvasMaskManager("../../../const");CanvasMaskManager=function(){function CanvasMaskManager(renderer){!function(instance){if(!(instance instanceof CanvasMaskManager))throw new TypeError("Cannot call a class as a function")}(this),this.renderer=renderer}return CanvasMaskManager.prototype.pushMask=function(maskData){var renderer=this.renderer;renderer.context.save();var cacheAlpha=maskData.alpha,transform=maskData.transform.worldTransform,resolution=renderer.resolution;renderer.context.setTransform(transform.a*resolution,transform.b*resolution,transform.c*resolution,transform.d*resolution,transform.tx*resolution,transform.ty*resolution),maskData._texture||(this.renderGraphicsShape(maskData),renderer.context.clip()),maskData.worldAlpha=cacheAlpha},CanvasMaskManager.prototype.renderGraphicsShape=function(graphics){var context=this.renderer.context,len=graphics.graphicsData.length;if(0!==len){context.beginPath();for(var i=0;i<len;i++){var y,ox,xe,xm,rx,ry,width,height,radius=graphics.graphicsData[i],maxRadius=radius.shape;if(radius.type===_const.SHAPES.POLY){var points=maxRadius.points,holes=radius.holes,outerArea=void 0,innerArea=void 0;context.moveTo(points[0],points[1]);for(var j=2;j<points.length;j+=2)context.lineTo(points[j],points[j+1]);if(points[0]===points[points.length-2]&&points[1]===points[points.length-1]&&context.closePath(),0<holes.length){for(var _j=outerArea=0;_j<points.length;_j+=2)outerArea+=points[_j]*points[_j+3]-points[_j+1]*points[_j+2];for(var k=0;k<holes.length;k++){points=holes[k].points;for(var _j2=innerArea=0;_j2<points.length;_j2+=2)innerArea+=points[_j2]*points[_j2+3]-points[_j2+1]*points[_j2+2];if(context.moveTo(points[0],points[1]),innerArea*outerArea<0)for(var _j3=2;_j3<points.length;_j3+=2)context.lineTo(points[_j3],points[_j3+1]);else for(var _j4=points.length-2;2<=_j4;_j4-=2)context.lineTo(points[_j4],points[_j4+1])}}}else radius.type===_const.SHAPES.RECT?(context.rect(maxRadius.x,maxRadius.y,maxRadius.width,maxRadius.height),context.closePath()):radius.type===_const.SHAPES.CIRC?(context.arc(maxRadius.x,maxRadius.y,maxRadius.radius,0,2*Math.PI),context.closePath()):radius.type===_const.SHAPES.ELIP?(ox=(xm=2*maxRadius.width)/2*.5522848,ry=(height=2*maxRadius.height)/2*.5522848,xe=(width=maxRadius.x-xm/2)+xm,rx=(y=maxRadius.y-height/2)+height,xm=width+xm/2,height=y+height/2,context.moveTo(width,height),context.bezierCurveTo(width,height-ry,xm-ox,y,xm,y),context.bezierCurveTo(xm+ox,y,xe,height-ry,xe,height),context.bezierCurveTo(xe,height+ry,xm+ox,rx,xm,rx),context.bezierCurveTo(xm-ox,rx,width,height+ry,width,height),context.closePath()):radius.type===_const.SHAPES.RREC&&(rx=maxRadius.x,ry=maxRadius.y,width=maxRadius.width,height=maxRadius.height,radius=maxRadius.radius,radius=(maxRadius=Math.min(width,height)/2|0)<radius?maxRadius:radius,context.moveTo(rx,ry+radius),context.lineTo(rx,ry+height-radius),context.quadraticCurveTo(rx,ry+height,rx+radius,ry+height),context.lineTo(rx+width-radius,ry+height),context.quadraticCurveTo(rx+width,ry+height,rx+width,ry+height-radius),context.lineTo(rx+width,ry+radius),context.quadraticCurveTo(rx+width,ry,rx+width-radius,ry),context.lineTo(rx+radius,ry),context.quadraticCurveTo(rx,ry,rx,ry+radius),context.closePath())}}},CanvasMaskManager.prototype.popMask=function(renderer){renderer.context.restore(),renderer.invalidateBlendMode()},CanvasMaskManager.prototype.destroy=function(){},CanvasMaskManager}();exports.default=CanvasMaskManager},{"../../../const":41}],71:[function(SystemRenderer,module,exports){"use strict";exports.__esModule=!0;var _createClass=function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor};function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var _utils=SystemRenderer("../utils"),_math=SystemRenderer("../math"),_const=SystemRenderer("../const"),_settings2=_interopRequireDefault(SystemRenderer("../settings")),_Container2=_interopRequireDefault(SystemRenderer("../display/Container")),_RenderTexture2=_interopRequireDefault(SystemRenderer("../textures/RenderTexture")),SystemRenderer=_interopRequireDefault(SystemRenderer("eventemitter3"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var tempMatrix=new _math.Matrix,SystemRenderer=function(_EventEmitter){function SystemRenderer(system,options,arg2,arg3){!function(instance){if(!(instance instanceof SystemRenderer))throw new TypeError("Cannot call a class as a function")}(this);var _this=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_EventEmitter.call(this));return(0,_utils.sayHello)(system),"number"==typeof options&&(options=Object.assign({width:options,height:arg2||_settings2.default.RENDER_OPTIONS.height},arg3)),options=Object.assign({},_settings2.default.RENDER_OPTIONS,options),_this.options=options,_this.type=_const.RENDERER_TYPE.UNKNOWN,_this.screen=new _math.Rectangle(0,0,options.width,options.height),_this.view=options.view||document.createElement("canvas"),_this.resolution=options.resolution||_settings2.default.RESOLUTION,_this.transparent=options.transparent,_this.autoResize=options.autoResize||!1,_this.blendModes=null,_this.preserveDrawingBuffer=options.preserveDrawingBuffer,_this.clearBeforeRender=options.clearBeforeRender,_this.roundPixels=options.roundPixels,_this._backgroundColor=0,_this._backgroundColorRgba=[0,0,0,0],_this._backgroundColorString="#000000",_this.backgroundColor=options.backgroundColor||_this._backgroundColor,_this._tempDisplayObjectParent=new _Container2.default,_this._lastObjectRendered=_this._tempDisplayObjectParent,_this}return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(SystemRenderer,_EventEmitter),SystemRenderer.prototype.resize=function(screenWidth,screenHeight){this.screen.width=screenWidth,this.screen.height=screenHeight,this.view.width=screenWidth*this.resolution,this.view.height=screenHeight*this.resolution,this.autoResize&&(this.view.style.width=screenWidth+"px",this.view.style.height=screenHeight+"px")},SystemRenderer.prototype.generateTexture=function(displayObject,scaleMode,renderTexture,region){region=region||displayObject.getLocalBounds();renderTexture=_RenderTexture2.default.create(0|region.width,0|region.height,scaleMode,renderTexture);return tempMatrix.tx=-region.x,tempMatrix.ty=-region.y,this.render(displayObject,renderTexture,!1,tempMatrix,!!displayObject.parent),renderTexture},SystemRenderer.prototype.destroy=function(removeView){removeView&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.type=_const.RENDERER_TYPE.UNKNOWN,this.view=null,this.screen=null,this.resolution=0,this.transparent=!1,this.autoResize=!1,this.blendModes=null,this.options=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this.roundPixels=!1,this._backgroundColor=0,this._backgroundColorRgba=null,this._backgroundColorString=null,this._tempDisplayObjectParent=null,this._lastObjectRendered=null},_createClass(SystemRenderer,[{key:"width",get:function(){return this.view.width}},{key:"height",get:function(){return this.view.height}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(value){this._backgroundColor=value,this._backgroundColorString=(0,_utils.hex2string)(value),(0,_utils.hex2rgb)(value,this._backgroundColorRgba)}}]),SystemRenderer}(SystemRenderer.default);exports.default=SystemRenderer},{"../const":41,"../display/Container":43,"../math":65,"../settings":96,"../textures/RenderTexture":108,"../utils":120,eventemitter3:10}],108:[function(RenderTexture,module,exports){"use strict";exports.__esModule=!0;var _BaseRenderTexture2=_interopRequireDefault(RenderTexture("./BaseRenderTexture"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}RenderTexture=function(_Texture){function RenderTexture(baseRenderTexture,_this){!function(instance){if(!(instance instanceof RenderTexture))throw new TypeError("Cannot call a class as a function")}(this);var width,height,scaleMode,resolution,_legacyRenderer=null;baseRenderTexture instanceof _BaseRenderTexture2.default||(width=arguments[1],height=arguments[2],scaleMode=arguments[3],resolution=arguments[4],console.warn("Please use RenderTexture.create("+width+", "+height+") instead of the ctor directly."),_legacyRenderer=arguments[0],_this=null,baseRenderTexture=new _BaseRenderTexture2.default(width,height,scaleMode,resolution));_this=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_Texture.call(this,baseRenderTexture,_this));return _this.legacyRenderer=_legacyRenderer,_this.valid=!0,_this._updateUvs(),_this}return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(RenderTexture,_Texture),RenderTexture.prototype.resize=function(width,height,doNotResizeBaseTexture){width=Math.ceil(width),height=Math.ceil(height),this.valid=0<width&&0<height,this._frame.width=this.orig.width=width,this._frame.height=this.orig.height=height,doNotResizeBaseTexture||this.baseTexture.resize(width,height),this._updateUvs()},RenderTexture.create=function(width,height,scaleMode,resolution){return new RenderTexture(new _BaseRenderTexture2.default(width,height,scaleMode,resolution))},RenderTexture}(_interopRequireDefault(RenderTexture("./Texture")).default);exports.default=RenderTexture},{"./BaseRenderTexture":106,"./Texture":110}],110:[function(require,module,exports){"use strict";exports.__esModule=!0;var _createClass=function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor};function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var _BaseTexture2=_interopRequireDefault(require("./BaseTexture")),_VideoBaseTexture2=_interopRequireDefault(require("./VideoBaseTexture")),_TextureUvs2=_interopRequireDefault(require("./TextureUvs")),_eventemitter2=_interopRequireDefault(require("eventemitter3")),_math=require("../math"),_utils=require("../utils"),_settings2=_interopRequireDefault(require("../settings"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Texture=function(_EventEmitter){function Texture(baseTexture,frame,orig,trim,rotate,anchor){!function(instance){if(!(instance instanceof Texture))throw new TypeError("Cannot call a class as a function")}(this);var _this=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_EventEmitter.call(this));if(_this.noFrame=!1,frame||(_this.noFrame=!0,frame=new _math.Rectangle(0,0,1,1)),baseTexture instanceof Texture&&(baseTexture=baseTexture.baseTexture),_this.baseTexture=baseTexture,_this._frame=frame,_this.trim=trim,_this.valid=!1,_this.requiresUpdate=!1,_this._uvs=null,_this.orig=orig||frame,_this._rotate=Number(rotate||0),!0===rotate)_this._rotate=2;else if(_this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return baseTexture.hasLoaded?(_this.noFrame&&(frame=new _math.Rectangle(0,0,baseTexture.width,baseTexture.height),baseTexture.on("update",_this.onBaseTextureUpdated,_this)),_this.frame=frame):baseTexture.once("loaded",_this.onBaseTextureLoaded,_this),_this.defaultAnchor=anchor?new _math.Point(anchor.x,anchor.y):new _math.Point(0,0),_this._updateID=0,_this.transform=null,_this.textureCacheIds=[],_this}return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(Texture,_EventEmitter),Texture.prototype.update=function(){this.baseTexture.update()},Texture.prototype.onBaseTextureLoaded=function(baseTexture){this._updateID++,this.noFrame?this.frame=new _math.Rectangle(0,0,baseTexture.width,baseTexture.height):this.frame=this._frame,this.baseTexture.on("update",this.onBaseTextureUpdated,this),this.emit("update",this)},Texture.prototype.onBaseTextureUpdated=function(baseTexture){this._updateID++,this._frame.width=baseTexture.width,this._frame.height=baseTexture.height,this.emit("update",this)},Texture.prototype.destroy=function(destroyBase){this.baseTexture&&(destroyBase&&(_utils.TextureCache[this.baseTexture.imageUrl]&&Texture.removeFromCache(this.baseTexture.imageUrl),this.baseTexture.destroy()),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture.off("loaded",this.onBaseTextureLoaded,this),this.baseTexture=null),this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,Texture.removeFromCache(this),this.textureCacheIds=null},Texture.prototype.clone=function(){return new Texture(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},Texture.prototype._updateUvs=function(){this._uvs||(this._uvs=new _TextureUvs2.default),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},Texture.fromImage=function(imageUrl,crossorigin,scaleMode,sourceScale){var texture=_utils.TextureCache[imageUrl];return texture||(texture=new Texture(_BaseTexture2.default.fromImage(imageUrl,crossorigin,scaleMode,sourceScale)),Texture.addToCache(texture,imageUrl)),texture},Texture.fromFrame=function(frameId){var texture=_utils.TextureCache[frameId];if(!texture)throw new Error('The frameId "'+frameId+'" does not exist in the texture cache');return texture},Texture.fromCanvas=function(canvas,scaleMode){var origin=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"canvas";return new Texture(_BaseTexture2.default.fromCanvas(canvas,scaleMode,origin))},Texture.fromVideo=function(video,scaleMode,crossorigin,autoPlay){return"string"==typeof video?Texture.fromVideoUrl(video,scaleMode,crossorigin,autoPlay):new Texture(_VideoBaseTexture2.default.fromVideo(video,scaleMode,autoPlay))},Texture.fromVideoUrl=function(videoUrl,scaleMode,crossorigin,autoPlay){return new Texture(_VideoBaseTexture2.default.fromUrl(videoUrl,scaleMode,crossorigin,autoPlay))},Texture.from=function(source){if("string"!=typeof source)return source instanceof HTMLImageElement?new Texture(_BaseTexture2.default.from(source)):source instanceof HTMLCanvasElement?Texture.fromCanvas(source,_settings2.default.SCALE_MODE,"HTMLCanvasElement"):source instanceof HTMLVideoElement?Texture.fromVideo(source):source instanceof _BaseTexture2.default?new Texture(source):source;var texture=_utils.TextureCache[source];return texture||(null!==source.match(/\.(mp4|webm|ogg|h264|avi|mov)$/)?Texture.fromVideoUrl(source):Texture.fromImage(source))},Texture.fromLoader=function(texture,imageUrl,name){var baseTexture=new _BaseTexture2.default(texture,void 0,(0,_utils.getResolutionOfUrl)(imageUrl)),texture=new Texture(baseTexture);return baseTexture.imageUrl=imageUrl,name=name||imageUrl,_BaseTexture2.default.addToCache(texture.baseTexture,name),Texture.addToCache(texture,name),name!==imageUrl&&(_BaseTexture2.default.addToCache(texture.baseTexture,imageUrl),Texture.addToCache(texture,imageUrl)),texture},Texture.addToCache=function(texture,id){id&&(-1===texture.textureCacheIds.indexOf(id)&&texture.textureCacheIds.push(id),_utils.TextureCache[id]&&console.warn("Texture added to the cache with an id ["+id+"] that already had an entry"),_utils.TextureCache[id]=texture)},Texture.removeFromCache=function(texture){if("string"==typeof texture){var textureFromCache=_utils.TextureCache[texture];if(textureFromCache){var index=textureFromCache.textureCacheIds.indexOf(texture);return-1<index&&textureFromCache.textureCacheIds.splice(index,1),delete _utils.TextureCache[texture],textureFromCache}}else if(texture&&texture.textureCacheIds){for(var i=0;i<texture.textureCacheIds.length;++i)_utils.TextureCache[texture.textureCacheIds[i]]===texture&&delete _utils.TextureCache[texture.textureCacheIds[i]];return texture.textureCacheIds.length=0,texture}return null},_createClass(Texture,[{key:"frame",get:function(){return this._frame},set:function(frame){this._frame=frame,this.noFrame=!1;var errorX=frame.x,errorY=frame.y,width=frame.width,height=frame.height,xNotFit=errorX+width>this.baseTexture.width,relationship=errorY+height>this.baseTexture.height;if(xNotFit||relationship){relationship=xNotFit&&relationship?"and":"or",errorX="X: "+errorX+" + "+width+" = "+(errorX+width)+" > "+this.baseTexture.width,errorY="Y: "+errorY+" + "+height+" = "+(errorY+height)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+errorX+" "+relationship+" "+errorY)}this.valid=width&&height&&this.baseTexture.hasLoaded,this.trim||this.rotate||(this.orig=frame),this.valid&&this._updateUvs()}},{key:"rotate",get:function(){return this._rotate},set:function(rotate){this._rotate=rotate,this.valid&&this._updateUvs()}},{key:"width",get:function(){return this.orig.width}},{key:"height",get:function(){return this.orig.height}}]),Texture}(_eventemitter2.default);function removeAllHandlers(tex){tex.destroy=function(){},tex.on=function(){},tex.once=function(){},tex.emit=function(){}}(exports.default=Texture).EMPTY=new Texture(new _BaseTexture2.default),removeAllHandlers(Texture.EMPTY),removeAllHandlers(Texture.EMPTY.baseTexture),Texture.WHITE=function(){var canvas=document.createElement("canvas");canvas.width=10,canvas.height=10;var context=canvas.getContext("2d");return context.fillStyle="white",context.fillRect(0,0,10,10),new Texture(new _BaseTexture2.default(canvas))}(),removeAllHandlers(Texture.WHITE),removeAllHandlers(Texture.WHITE.baseTexture)},{"../math":65,"../settings":96,"../utils":120,"./BaseTexture":107,"./TextureUvs":112,"./VideoBaseTexture":113,eventemitter3:10}],113:[function(VideoBaseTexture,module,exports){"use strict";exports.__esModule=!0;var _createClass=function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor};function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var _BaseTexture3=_interopRequireDefault(VideoBaseTexture("./BaseTexture")),_utils=VideoBaseTexture("../utils"),_ticker=VideoBaseTexture("../ticker"),_const=VideoBaseTexture("../const"),_determineCrossOrigin2=_interopRequireDefault(VideoBaseTexture("../utils/determineCrossOrigin"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}VideoBaseTexture=function(_BaseTexture){function VideoBaseTexture(source,_this){var autoPlay=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];if(!function(instance){if(!(instance instanceof VideoBaseTexture))throw new TypeError("Cannot call a class as a function")}(this),!source)throw new Error("No video source element specified.");(source.readyState===source.HAVE_ENOUGH_DATA||source.readyState===source.HAVE_FUTURE_DATA)&&source.width&&source.height&&(source.complete=!0);_this=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_BaseTexture.call(this,source,_this));return _this.width=source.videoWidth,_this.height=source.videoHeight,_this._autoUpdate=!0,_this._isAutoUpdating=!1,_this.autoPlay=autoPlay,_this.update=_this.update.bind(_this),_this._onCanPlay=_this._onCanPlay.bind(_this),source.addEventListener("play",_this._onPlayStart.bind(_this)),source.addEventListener("pause",_this._onPlayStop.bind(_this)),_this.hasLoaded=!1,_this.__loaded=!1,_this._isSourceReady()?_this._onCanPlay():(source.addEventListener("canplay",_this._onCanPlay),source.addEventListener("canplaythrough",_this._onCanPlay)),_this}return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(VideoBaseTexture,_BaseTexture),VideoBaseTexture.prototype._isSourcePlaying=function(){var source=this.source;return 0<source.currentTime&&!1===source.paused&&!1===source.ended&&2<source.readyState},VideoBaseTexture.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},VideoBaseTexture.prototype._onPlayStart=function(){this.hasLoaded||this._onCanPlay(),!this._isAutoUpdating&&this.autoUpdate&&(_ticker.shared.add(this.update,this,_const.UPDATE_PRIORITY.HIGH),this._isAutoUpdating=!0)},VideoBaseTexture.prototype._onPlayStop=function(){this._isAutoUpdating&&(_ticker.shared.remove(this.update,this),this._isAutoUpdating=!1)},VideoBaseTexture.prototype._onCanPlay=function(){this.hasLoaded=!0,this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.__loaded||(this.__loaded=!0,this.emit("loaded",this)),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.source.play())},VideoBaseTexture.prototype.destroy=function(){this._isAutoUpdating&&_ticker.shared.remove(this.update,this),this.source&&this.source._pixiId&&(_BaseTexture3.default.removeFromCache(this.source._pixiId),delete this.source._pixiId,this.source.pause(),this.source.src="",this.source.load()),_BaseTexture.prototype.destroy.call(this)},VideoBaseTexture.fromVideo=function(video,scaleMode,autoPlay){video._pixiId||(video._pixiId="video_"+(0,_utils.uid)());var baseTexture=_utils.BaseTextureCache[video._pixiId];return baseTexture||(baseTexture=new VideoBaseTexture(video,scaleMode,autoPlay),_BaseTexture3.default.addToCache(baseTexture,video._pixiId)),baseTexture},VideoBaseTexture.fromUrl=function(videoSrc,scaleMode,crossorigin,autoPlay){var video=document.createElement("video");video.setAttribute("webkit-playsinline",""),video.setAttribute("playsinline","");var url=Array.isArray(videoSrc)?videoSrc[0].src||videoSrc[0]:videoSrc.src||videoSrc;if(void 0===crossorigin&&0!==url.indexOf("data:")?video.crossOrigin=(0,_determineCrossOrigin2.default)(url):crossorigin&&(video.crossOrigin="string"==typeof crossorigin?crossorigin:"anonymous"),Array.isArray(videoSrc))for(var i=0;i<videoSrc.length;++i)video.appendChild(createSource(videoSrc[i].src||videoSrc[i],videoSrc[i].mime));else video.appendChild(createSource(url,videoSrc.mime));return video.load(),VideoBaseTexture.fromVideo(video,scaleMode,autoPlay)},_createClass(VideoBaseTexture,[{key:"autoUpdate",get:function(){return this._autoUpdate},set:function(value){value!==this._autoUpdate&&(this._autoUpdate=value,!this._autoUpdate&&this._isAutoUpdating?(_ticker.shared.remove(this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(_ticker.shared.add(this.update,this,_const.UPDATE_PRIORITY.HIGH),this._isAutoUpdating=!0))}}]),VideoBaseTexture}(_BaseTexture3.default);function createSource(path,type){type||(type="video/"+(source=path.split("?").shift().toLowerCase()).substr(source.lastIndexOf(".")+1));var source=document.createElement("source");return source.src=path,source.type=type,source}(exports.default=VideoBaseTexture).fromUrls=VideoBaseTexture.fromUrl},{"../const":41,"../ticker":116,"../utils":120,"../utils/determineCrossOrigin":119,"./BaseTexture":107}],116:[function(shared,module,exports){"use strict";exports.__esModule=!0,exports.Ticker=exports.shared=void 0;var obj,_Ticker=shared("./Ticker"),_Ticker2=(obj=_Ticker)&&obj.__esModule?obj:{default:obj};shared=new _Ticker2.default;shared.autoStart=!0,shared.destroy=function(){},exports.shared=shared,exports.Ticker=_Ticker2.default},{"./Ticker":114}],114:[function(Ticker,module,exports){"use strict";exports.__esModule=!0;var _createClass=function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor};function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var _settings2=_interopRequireDefault(Ticker("../settings")),_const=Ticker("../const"),_TickerListener2=_interopRequireDefault(Ticker("./TickerListener"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Ticker=function(){function Ticker(){var _this=this;!function(instance){if(!(instance instanceof Ticker))throw new TypeError("Cannot call a class as a function")}(this),this._head=new _TickerListener2.default(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this.autoStart=!1,this.deltaTime=1,this.elapsedMS=1/_settings2.default.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._tick=function(time){_this._requestId=null,_this.started&&(_this.update(time),_this.started&&null===_this._requestId&&_this._head.next&&(_this._requestId=requestAnimationFrame(_this._tick)))}}return Ticker.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._requestId=requestAnimationFrame(this._tick))},Ticker.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},Ticker.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},Ticker.prototype.add=function(fn,context){var priority=2<arguments.length&&void 0!==arguments[2]?arguments[2]:_const.UPDATE_PRIORITY.NORMAL;return this._addListener(new _TickerListener2.default(fn,context,priority))},Ticker.prototype.addOnce=function(fn,context){var priority=2<arguments.length&&void 0!==arguments[2]?arguments[2]:_const.UPDATE_PRIORITY.NORMAL;return this._addListener(new _TickerListener2.default(fn,context,priority,!0))},Ticker.prototype._addListener=function(listener){var current=this._head.next,previous=this._head;if(current){for(;current;){if(listener.priority>current.priority){listener.connect(previous);break}current=(previous=current).next}listener.previous||listener.connect(previous)}else listener.connect(previous);return this._startIfPossible(),this},Ticker.prototype.remove=function(fn,context){for(var listener=this._head.next;listener;)listener=listener.match(fn,context)?listener.destroy():listener.next;return this._head.next||this._cancelIfNeeded(),this},Ticker.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},Ticker.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},Ticker.prototype.destroy=function(){this.stop();for(var listener=this._head.next;listener;)listener=listener.destroy(!0);this._head.destroy(),this._head=null},Ticker.prototype.update=function(){var currentTime=0<arguments.length&&void 0!==arguments[0]?arguments[0]:performance.now(),head=void 0;if(currentTime>this.lastTime){(head=this.elapsedMS=currentTime-this.lastTime)>this._maxElapsedMS&&(head=this._maxElapsedMS),this.deltaTime=head*_settings2.default.TARGET_FPMS*this.speed;for(var head=this._head,listener=head.next;listener;)listener=listener.emit(this.deltaTime);head.next||this._cancelIfNeeded()}else this.deltaTime=this.elapsedMS=0;this.lastTime=currentTime},_createClass(Ticker,[{key:"FPS",get:function(){return 1e3/this.elapsedMS}},{key:"minFPS",get:function(){return 1e3/this._maxElapsedMS},set:function(minFPMS){minFPMS=Math.min(Math.max(0,minFPMS)/1e3,_settings2.default.TARGET_FPMS);this._maxElapsedMS=1/minFPMS}}]),Ticker}();exports.default=Ticker},{"../const":41,"../settings":96,"./TickerListener":115}],115:[function(require,module,exports){"use strict";exports.__esModule=!0;var TickerListener=function(){function TickerListener(fn){var context=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,priority=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,once=3<arguments.length&&void 0!==arguments[3]&&arguments[3];!function(instance){if(!(instance instanceof TickerListener))throw new TypeError("Cannot call a class as a function")}(this),this.fn=fn,this.context=context,this.priority=priority,this.once=once,this.next=null,this.previous=null,this._destroyed=!1}return TickerListener.prototype.match=function(fn,context){return context=context||null,this.fn===fn&&this.context===context},TickerListener.prototype.emit=function(redirect){this.fn&&(this.context?this.fn.call(this.context,redirect):this.fn(redirect));redirect=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),redirect},TickerListener.prototype.connect=function(previous){(this.previous=previous).next&&(previous.next.previous=this),this.next=previous.next,previous.next=this},TickerListener.prototype.destroy=function(){var hard=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var redirect=this.next;return this.next=hard?null:redirect,this.previous=null,redirect},TickerListener}();exports.default=TickerListener},{}],112:[function(TextureUvs,module,exports){"use strict";exports.__esModule=!0;var obj,_GroupD=TextureUvs("../math/GroupD8"),_GroupD2=(obj=_GroupD)&&obj.__esModule?obj:{default:obj};TextureUvs=function(){function TextureUvs(){!function(instance){if(!(instance instanceof TextureUvs))throw new TypeError("Cannot call a class as a function")}(this),this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsUint32=new Uint32Array(4)}return TextureUvs.prototype.set=function(frame,cY,rotate){var w2,h2,cX,tw=cY.width,th=cY.height;rotate?(w2=frame.width/2/tw,h2=frame.height/2/th,cX=frame.x/tw+w2,cY=frame.y/th+h2,rotate=_GroupD2.default.add(rotate,_GroupD2.default.NW),this.x0=cX+w2*_GroupD2.default.uX(rotate),this.y0=cY+h2*_GroupD2.default.uY(rotate),rotate=_GroupD2.default.add(rotate,2),this.x1=cX+w2*_GroupD2.default.uX(rotate),this.y1=cY+h2*_GroupD2.default.uY(rotate),rotate=_GroupD2.default.add(rotate,2),this.x2=cX+w2*_GroupD2.default.uX(rotate),this.y2=cY+h2*_GroupD2.default.uY(rotate),rotate=_GroupD2.default.add(rotate,2),this.x3=cX+w2*_GroupD2.default.uX(rotate),this.y3=cY+h2*_GroupD2.default.uY(rotate)):(this.x0=frame.x/tw,this.y0=frame.y/th,this.x1=(frame.x+frame.width)/tw,this.y1=frame.y/th,this.x2=(frame.x+frame.width)/tw,this.y2=(frame.y+frame.height)/th,this.x3=frame.x/tw,this.y3=(frame.y+frame.height)/th),this.uvsUint32[0]=(65535&Math.round(65535*this.y0))<<16|65535&Math.round(65535*this.x0),this.uvsUint32[1]=(65535&Math.round(65535*this.y1))<<16|65535&Math.round(65535*this.x1),this.uvsUint32[2]=(65535&Math.round(65535*this.y2))<<16|65535&Math.round(65535*this.x2),this.uvsUint32[3]=(65535&Math.round(65535*this.y3))<<16|65535&Math.round(65535*this.x3)},TextureUvs}();exports.default=TextureUvs},{"../math/GroupD8":61}],106:[function(require,module,exports){"use strict";exports.__esModule=!0;var BaseRenderTexture=_interopRequireDefault(require("./BaseTexture")),_settings2=_interopRequireDefault(require("../settings"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}BaseRenderTexture=function(_BaseTexture){function BaseRenderTexture(){var width=0<arguments.length&&void 0!==arguments[0]?arguments[0]:100,height=1<arguments.length&&void 0!==arguments[1]?arguments[1]:100,scaleMode=arguments[2],resolution=arguments[3];!function(instance){if(!(instance instanceof BaseRenderTexture))throw new TypeError("Cannot call a class as a function")}(this);var _this=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_BaseTexture.call(this,null,scaleMode));return _this.resolution=resolution||_settings2.default.RESOLUTION,_this.width=Math.ceil(width),_this.height=Math.ceil(height),_this.realWidth=_this.width*_this.resolution,_this.realHeight=_this.height*_this.resolution,_this.scaleMode=void 0!==scaleMode?scaleMode:_settings2.default.SCALE_MODE,_this.hasLoaded=!0,_this._glRenderTargets={},_this._canvasRenderTarget=null,_this.valid=!1,_this}return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(BaseRenderTexture,_BaseTexture),BaseRenderTexture.prototype.resize=function(width,height){width=Math.ceil(width),height=Math.ceil(height),width===this.width&&height===this.height||(this.valid=0<width&&0<height,this.width=width,this.height=height,this.realWidth=this.width*this.resolution,this.realHeight=this.height*this.resolution,this.valid&&this.emit("update",this))},BaseRenderTexture.prototype.destroy=function(){_BaseTexture.prototype.destroy.call(this,!0),this.renderer=null},BaseRenderTexture}(BaseRenderTexture.default);exports.default=BaseRenderTexture},{"../settings":96,"./BaseTexture":107}],107:[function(require,module,exports){"use strict";exports.__esModule=!0;var _utils=require("../utils"),_settings2=_interopRequireDefault(require("../settings")),BaseTexture=_interopRequireDefault(require("eventemitter3")),_determineCrossOrigin2=_interopRequireDefault(require("../utils/determineCrossOrigin")),_bitTwiddle2=_interopRequireDefault(require("bit-twiddle"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}BaseTexture=function(_EventEmitter){function BaseTexture(source,scaleMode,resolution){!function(instance){if(!(instance instanceof BaseTexture))throw new TypeError("Cannot call a class as a function")}(this);var _this=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_EventEmitter.call(this));return _this.uid=(0,_utils.uid)(),_this.touched=0,_this.resolution=resolution||_settings2.default.RESOLUTION,_this.width=100,_this.height=100,_this.realWidth=100,_this.realHeight=100,_this.scaleMode=void 0!==scaleMode?scaleMode:_settings2.default.SCALE_MODE,_this.hasLoaded=!1,_this.isLoading=!1,_this.source=null,_this.origSource=null,_this.imageType=null,_this.sourceScale=1,_this.premultipliedAlpha=!0,_this.imageUrl=null,_this.isPowerOfTwo=!1,_this.mipmap=_settings2.default.MIPMAP_TEXTURES,_this.wrapMode=_settings2.default.WRAP_MODE,_this._glTextures={},_this._enabled=0,_this._virtalBoundId=-1,_this._destroyed=!1,_this.textureCacheIds=[],source&&_this.loadSource(source),_this}return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(BaseTexture,_EventEmitter),BaseTexture.prototype.update=function(){"svg"!==this.imageType&&(this.realWidth=this.source.naturalWidth||this.source.videoWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.videoHeight||this.source.height,this._updateDimensions()),this.emit("update",this)},BaseTexture.prototype._updateDimensions=function(){this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=_bitTwiddle2.default.isPow2(this.realWidth)&&_bitTwiddle2.default.isPow2(this.realHeight)},BaseTexture.prototype.loadSource=function(source){var wasLoading=this.isLoading;this.hasLoaded=!1,this.isLoading=!1,wasLoading&&this.source&&(this.source.onload=null,this.source.onerror=null);var scope,firstSourceLoaded=!this.source;((this.source=source).src&&source.complete||source.getContext)&&source.width&&source.height?(this._updateImageType(),"svg"===this.imageType?this._loadSvgSource():this._sourceLoaded(),firstSourceLoaded&&this.emit("loaded",this)):source.getContext||(this.isLoading=!0,scope=this,source.onload=function(){scope._updateImageType(),source.onload=null,source.onerror=null,scope.isLoading&&(scope.isLoading=!1,scope._sourceLoaded(),"svg"!==scope.imageType?scope.emit("loaded",scope):scope._loadSvgSource())},source.onerror=function(){source.onload=null,source.onerror=null,scope.isLoading&&(scope.isLoading=!1,scope.emit("error",scope))},source.complete&&source.src&&(source.onload=null,source.onerror=null,"svg"!==scope.imageType?(this.isLoading=!1,source.width&&source.height?(this._sourceLoaded(),wasLoading&&this.emit("loaded",this)):wasLoading&&this.emit("error",this)):scope._loadSvgSource()))},BaseTexture.prototype._updateImageType=function(){if(this.imageUrl){var firstSubType=(0,_utils.decomposeDataUri)(this.imageUrl),imageType=void 0;if(firstSubType&&"image"===firstSubType.mediaType){firstSubType=firstSubType.subType.split("+")[0];if(!(imageType=(0,_utils.getUrlFileExtension)("."+firstSubType)))throw new Error("Invalid image type in data URI.")}else imageType=(imageType=(0,_utils.getUrlFileExtension)(this.imageUrl))||"png";this.imageType=imageType}},BaseTexture.prototype._loadSvgSource=function(){var dataUri;"svg"===this.imageType&&((dataUri=(0,_utils.decomposeDataUri)(this.imageUrl))?this._loadSvgSourceUsingDataUri(dataUri):this._loadSvgSourceUsingXhr())},BaseTexture.prototype._loadSvgSourceUsingDataUri=function(dataUri){var svgString=void 0;if("base64"===dataUri.encoding){if(!atob)throw new Error("Your browser doesn't support base64 conversions.");svgString=atob(dataUri.data)}else svgString=dataUri.data;this._loadSvgSourceUsingString(svgString)},BaseTexture.prototype._loadSvgSourceUsingXhr=function(){var _this2=this,svgXhr=new XMLHttpRequest;svgXhr.onload=function(){if(svgXhr.readyState!==svgXhr.DONE||200!==svgXhr.status)throw new Error("Failed to load SVG using XHR.");_this2._loadSvgSourceUsingString(svgXhr.response)},svgXhr.onerror=function(){return _this2.emit("error",_this2)},svgXhr.open("GET",this.imageUrl,!0),svgXhr.send()},BaseTexture.prototype._loadSvgSourceUsingString=function(svgHeight){var canvas=(0,_utils.getSvgSize)(svgHeight),svgWidth=canvas.width,svgHeight=canvas.height;if(!svgWidth||!svgHeight)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");this.realWidth=Math.round(svgWidth*this.sourceScale),this.realHeight=Math.round(svgHeight*this.sourceScale),this._updateDimensions();canvas=document.createElement("canvas");canvas.width=this.realWidth,canvas.height=this.realHeight,canvas._pixiId="canvas_"+(0,_utils.uid)(),canvas.getContext("2d").drawImage(this.source,0,0,svgWidth,svgHeight,0,0,this.realWidth,this.realHeight),this.origSource=this.source,this.source=canvas,BaseTexture.addToCache(this,canvas._pixiId),this.isLoading=!1,this._sourceLoaded(),this.emit("loaded",this)},BaseTexture.prototype._sourceLoaded=function(){this.hasLoaded=!0,this.update()},BaseTexture.prototype.destroy=function(){this.imageUrl&&(delete _utils.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")),this.source=null,this.dispose(),BaseTexture.removeFromCache(this),this.textureCacheIds=null,this._destroyed=!0},BaseTexture.prototype.dispose=function(){this.emit("dispose",this)},BaseTexture.prototype.updateSourceImage=function(newSrc){this.source.src=newSrc,this.loadSource(this.source)},BaseTexture.fromImage=function(imageUrl,crossorigin,scaleMode,sourceScale){var image,baseTexture=_utils.BaseTextureCache[imageUrl];return baseTexture||(image=new Image,void 0===crossorigin&&0!==imageUrl.indexOf("data:")?image.crossOrigin=(0,_determineCrossOrigin2.default)(imageUrl):crossorigin&&(image.crossOrigin="string"==typeof crossorigin?crossorigin:"anonymous"),(baseTexture=new BaseTexture(image,scaleMode)).imageUrl=imageUrl,sourceScale&&(baseTexture.sourceScale=sourceScale),baseTexture.resolution=(0,_utils.getResolutionOfUrl)(imageUrl),image.src=imageUrl,BaseTexture.addToCache(baseTexture,imageUrl)),baseTexture},BaseTexture.fromCanvas=function(canvas,scaleMode){var baseTexture=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"canvas";canvas._pixiId||(canvas._pixiId=baseTexture+"_"+(0,_utils.uid)());baseTexture=_utils.BaseTextureCache[canvas._pixiId];return baseTexture||(baseTexture=new BaseTexture(canvas,scaleMode),BaseTexture.addToCache(baseTexture,canvas._pixiId)),baseTexture},BaseTexture.from=function(source,scaleMode,sourceScale){if("string"==typeof source)return BaseTexture.fromImage(source,void 0,scaleMode,sourceScale);if(source instanceof HTMLImageElement){var imageUrl=source.src,baseTexture=_utils.BaseTextureCache[imageUrl];return baseTexture||((baseTexture=new BaseTexture(source,scaleMode)).imageUrl=imageUrl,sourceScale&&(baseTexture.sourceScale=sourceScale),baseTexture.resolution=(0,_utils.getResolutionOfUrl)(imageUrl),BaseTexture.addToCache(baseTexture,imageUrl)),baseTexture}return source instanceof HTMLCanvasElement?BaseTexture.fromCanvas(source,scaleMode):source},BaseTexture.addToCache=function(baseTexture,id){id&&(-1===baseTexture.textureCacheIds.indexOf(id)&&baseTexture.textureCacheIds.push(id),_utils.BaseTextureCache[id]&&console.warn("BaseTexture added to the cache with an id ["+id+"] that already had an entry"),_utils.BaseTextureCache[id]=baseTexture)},BaseTexture.removeFromCache=function(baseTexture){if("string"==typeof baseTexture){var baseTextureFromCache=_utils.BaseTextureCache[baseTexture];if(baseTextureFromCache){var index=baseTextureFromCache.textureCacheIds.indexOf(baseTexture);return-1<index&&baseTextureFromCache.textureCacheIds.splice(index,1),delete _utils.BaseTextureCache[baseTexture],baseTextureFromCache}}else if(baseTexture&&baseTexture.textureCacheIds){for(var i=0;i<baseTexture.textureCacheIds.length;++i)delete _utils.BaseTextureCache[baseTexture.textureCacheIds[i]];return baseTexture.textureCacheIds.length=0,baseTexture}return null},BaseTexture}(BaseTexture.default);exports.default=BaseTexture},{"../settings":96,"../utils":120,"../utils/determineCrossOrigin":119,"bit-twiddle":8,eventemitter3:10}],119:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default=function(url){var loc=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window.location;if(0===url.indexOf("data:"))return"";loc=loc||window.location,tempAnchor=tempAnchor||document.createElement("a");tempAnchor.href=url;var samePort=!(url=_url3.default.parse(tempAnchor.href)).port&&""===loc.port||url.port===loc.port;return url.hostname===loc.hostname&&samePort&&url.protocol===loc.protocol?"":"anonymous"};var obj,_url2=require("url"),_url3=(obj=_url2)&&obj.__esModule?obj:{default:obj};var tempAnchor=void 0},{url:197}],197:[function(require,module,unwise){"use strict";var punycode=require("punycode"),util=require("./util");function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}unwise.parse=urlParse,unwise.resolve=function(source,relative){return urlParse(source,!1,!0).resolve(relative)},unwise.resolveObject=function(source,relative){return source?urlParse(source,!1,!0).resolveObject(relative):relative},unwise.format=function(obj){util.isString(obj)&&(obj=urlParse(obj));return obj instanceof Url?obj.format():Url.prototype.format.call(obj)},unwise.Url=Url;var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,unwise=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:!0,"javascript:":!0},hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},querystring=require("querystring");function urlParse(url,parseQueryString,slashesDenoteHost){if(url&&util.isObject(url)&&url instanceof Url)return url;var u=new Url;return u.parse(url,parseQueryString,slashesDenoteHost),u}Url.prototype.parse=function(url,parseQueryString,slashesDenoteHost){if(!util.isString(url))throw new TypeError("Parameter 'url' must be a string, not "+typeof url);var uSplit=url.indexOf("?"),splitter=-1!==uSplit&&uSplit<url.indexOf("#")?"?":"#",uSplit=url.split(splitter);uSplit[0]=uSplit[0].replace(/\\/g,"/");var rest=(rest=url=uSplit.join(splitter)).trim();if(!slashesDenoteHost&&1===url.split("#").length){var proto=simplePathPattern.exec(rest);if(proto)return this.path=rest,this.href=rest,this.pathname=proto[1],proto[2]?(this.search=proto[2],this.query=parseQueryString?querystring.parse(this.search.substr(1)):this.search.substr(1)):parseQueryString&&(this.search="",this.query={}),this}var slashes,proto=protocolPattern.exec(rest);if(proto&&(s=(proto=proto[0]).toLowerCase(),this.protocol=s,rest=rest.substr(proto.length)),(slashesDenoteHost||proto||rest.match(/^\/\/[^@\/]+@[^@\/]+/))&&(!(slashes="//"===rest.substr(0,2))||proto&&hostlessProtocol[proto]||(rest=rest.substr(2),this.slashes=!0)),!hostlessProtocol[proto]&&(slashes||proto&&!slashedProtocol[proto])){for(var hostEnd=-1,i=0;i<hostEndingChars.length;i++)-1!==(hec=rest.indexOf(hostEndingChars[i]))&&(-1===hostEnd||hec<hostEnd)&&(hostEnd=hec);-1!==(p=-1===hostEnd?rest.lastIndexOf("@"):rest.lastIndexOf("@",hostEnd))&&(h=rest.slice(0,p),rest=rest.slice(p+1),this.auth=decodeURIComponent(h)),hostEnd=-1;for(var hec,i=0;i<nonHostChars.length;i++)-1!==(hec=rest.indexOf(nonHostChars[i]))&&(-1===hostEnd||hec<hostEnd)&&(hostEnd=hec);-1===hostEnd&&(hostEnd=rest.length),this.host=rest.slice(0,hostEnd),rest=rest.slice(hostEnd),this.parseHost(),this.hostname=this.hostname||"";var qm="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!qm)for(var hostparts=this.hostname.split(/\./),i=0,l=hostparts.length;i<l;i++){var part=hostparts[i];if(part&&!part.match(hostnamePartPattern)){for(var newpart="",j=0,k=part.length;j<k;j++)127<part.charCodeAt(j)?newpart+="x":newpart+=part[j];if(!newpart.match(hostnamePartPattern)){var validParts=hostparts.slice(0,i),notHost=hostparts.slice(i+1),bit=part.match(hostnamePartStart);bit&&(validParts.push(bit[1]),notHost.unshift(bit[2])),notHost.length&&(rest="/"+notHost.join(".")+rest),this.hostname=validParts.join(".");break}}}255<this.hostname.length?this.hostname="":this.hostname=this.hostname.toLowerCase(),qm||(this.hostname=punycode.toASCII(this.hostname));var p=this.port?":"+this.port:"",h=this.hostname||"";this.host=h+p,this.href+=this.host,qm&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==rest[0]&&(rest="/"+rest))}if(!unsafeProtocol[s])for(i=0,l=autoEscape.length;i<l;i++){var esc,ae=autoEscape[i];-1!==rest.indexOf(ae)&&((esc=encodeURIComponent(ae))===ae&&(esc=escape(ae)),rest=rest.split(ae).join(esc))}qm=rest.indexOf("#");-1!==qm&&(this.hash=rest.substr(qm),rest=rest.slice(0,qm));var s,qm=rest.indexOf("?");return-1!==qm?(this.search=rest.substr(qm),this.query=rest.substr(qm+1),parseQueryString&&(this.query=querystring.parse(this.query)),rest=rest.slice(0,qm)):parseQueryString&&(this.search="",this.query={}),rest&&(this.pathname=rest),slashedProtocol[s]&&this.hostname&&!this.pathname&&(this.pathname="/"),(this.pathname||this.search)&&(p=this.pathname||"",s=this.search||"",this.path=p+s),this.href=this.format(),this},Url.prototype.format=function(){var auth=this.auth||"";auth&&(auth=(auth=encodeURIComponent(auth)).replace(/%3A/i,":"),auth+="@");var protocol=this.protocol||"",pathname=this.pathname||"",hash=this.hash||"",host=!1,search="";this.host?host=auth+this.host:this.hostname&&(host=auth+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(host+=":"+this.port)),this.query&&util.isObject(this.query)&&Object.keys(this.query).length&&(search=querystring.stringify(this.query));search=this.search||search&&"?"+search||"";return protocol&&":"!==protocol.substr(-1)&&(protocol+=":"),this.slashes||(!protocol||slashedProtocol[protocol])&&!1!==host?(host="//"+(host||""),pathname&&"/"!==pathname.charAt(0)&&(pathname="/"+pathname)):host=host||"",hash&&"#"!==hash.charAt(0)&&(hash="#"+hash),search&&"?"!==search.charAt(0)&&(search="?"+search),protocol+host+(pathname=pathname.replace(/[?#]/g,function(match){return encodeURIComponent(match)}))+(search=search.replace("#","%23"))+hash},Url.prototype.resolve=function(relative){return this.resolveObject(urlParse(relative,!1,!0)).format()},Url.prototype.resolveObject=function(relative){util.isString(relative)&&((isAbsolute=new Url).parse(relative,!1,!0),relative=isAbsolute);for(var result=new Url,tkeys=Object.keys(this),tk=0;tk<tkeys.length;tk++){var tkey=tkeys[tk];result[tkey]=this[tkey]}if(result.hash=relative.hash,""===relative.href)return result.href=result.format(),result;if(relative.slashes&&!relative.protocol){for(var rkeys=Object.keys(relative),rk=0;rk<rkeys.length;rk++){var rkey=rkeys[rk];"protocol"!==rkey&&(result[rkey]=relative[rkey])}return slashedProtocol[result.protocol]&&result.hostname&&!result.pathname&&(result.path=result.pathname="/"),result.href=result.format(),result}if(relative.protocol&&relative.protocol!==result.protocol){if(!slashedProtocol[relative.protocol]){for(var keys=Object.keys(relative),v=0;v<keys.length;v++){var k=keys[v];result[k]=relative[k]}return result.href=result.format(),result}if(result.protocol=relative.protocol,relative.host||hostlessProtocol[relative.protocol])result.pathname=relative.pathname;else{for(var relPath=(relative.pathname||"").split("/");relPath.length&&!(relative.host=relPath.shift()););relative.host||(relative.host=""),relative.hostname||(relative.hostname=""),""!==relPath[0]&&relPath.unshift(""),relPath.length<2&&relPath.unshift(""),result.pathname=relPath.join("/")}return result.search=relative.search,result.query=relative.query,result.host=relative.host||"",result.auth=relative.auth,result.hostname=relative.hostname||relative.host,result.port=relative.port,(result.pathname||result.search)&&(mustEndAbs=result.pathname||"",removeAllDots=result.search||"",result.path=mustEndAbs+removeAllDots),result.slashes=result.slashes||relative.slashes,result.href=result.format(),result}var psychotic=result.pathname&&"/"===result.pathname.charAt(0),isAbsolute=relative.host||relative.pathname&&"/"===relative.pathname.charAt(0),mustEndAbs=isAbsolute||psychotic||result.host&&relative.pathname,removeAllDots=mustEndAbs,srcPath=result.pathname&&result.pathname.split("/")||[],relPath=relative.pathname&&relative.pathname.split("/")||[],psychotic=result.protocol&&!slashedProtocol[result.protocol];if(psychotic&&(result.hostname="",result.port=null,result.host&&(""===srcPath[0]?srcPath[0]=result.host:srcPath.unshift(result.host)),result.host="",relative.protocol&&(relative.hostname=null,relative.port=null,relative.host&&(""===relPath[0]?relPath[0]=relative.host:relPath.unshift(relative.host)),relative.host=null),mustEndAbs=mustEndAbs&&(""===relPath[0]||""===srcPath[0])),isAbsolute)result.host=(relative.host||""===relative.host?relative:result).host,result.hostname=(relative.hostname||""===relative.hostname?relative:result).hostname,result.search=relative.search,result.query=relative.query,srcPath=relPath;else if(relPath.length)(srcPath=srcPath||[]).pop(),srcPath=srcPath.concat(relPath),result.search=relative.search,result.query=relative.query;else if(!util.isNullOrUndefined(relative.search))return psychotic&&(result.hostname=result.host=srcPath.shift(),(authInHost=!!(result.host&&0<result.host.indexOf("@"))&&result.host.split("@"))&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift())),result.search=relative.search,result.query=relative.query,util.isNull(result.pathname)&&util.isNull(result.search)||(result.path=(result.pathname||"")+(result.search||"")),result.href=result.format(),result;if(!srcPath.length)return result.pathname=null,result.search?result.path="/"+result.search:result.path=null,result.href=result.format(),result;for(var last=srcPath.slice(-1)[0],isAbsolute=(result.host||relative.host||1<srcPath.length)&&("."===last||".."===last)||""===last,up=0,i=srcPath.length;0<=i;i--)"."===(last=srcPath[i])?srcPath.splice(i,1):".."===last?(srcPath.splice(i,1),up++):up&&(srcPath.splice(i,1),up--);if(!mustEndAbs&&!removeAllDots)for(;up--;)srcPath.unshift("..");!mustEndAbs||""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0)||srcPath.unshift(""),isAbsolute&&"/"!==srcPath.join("/").substr(-1)&&srcPath.push("");var authInHost,isAbsolute=""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0);return psychotic&&(result.hostname=result.host=!isAbsolute&&srcPath.length?srcPath.shift():"",(authInHost=!!(result.host&&0<result.host.indexOf("@"))&&result.host.split("@"))&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift())),(mustEndAbs=mustEndAbs||result.host&&srcPath.length)&&!isAbsolute&&srcPath.unshift(""),srcPath.length?result.pathname=srcPath.join("/"):(result.pathname=null,result.path=null),util.isNull(result.pathname)&&util.isNull(result.search)||(result.path=(result.pathname||"")+(result.search||"")),result.auth=relative.auth||result.auth,result.slashes=result.slashes||relative.slashes,result.href=result.format(),result},Url.prototype.parseHost=function(){var host=this.host,port=portPattern.exec(host);port&&(":"!==(port=port[0])&&(this.port=port.substr(1)),host=host.substr(0,host.length-port.length)),host&&(this.hostname=host)}},{"./util":198,punycode:186,querystring:189}],198:[function(require,module,exports){"use strict";module.exports={isString:function(arg){return"string"==typeof arg},isObject:function(arg){return"object"==typeof arg&&null!==arg},isNull:function(arg){return null===arg},isNullOrUndefined:function(arg){return null==arg}}},{}],189:[function(require,module,exports){"use strict";exports.decode=exports.parse=require("./decode"),exports.encode=exports.stringify=require("./encode")},{"./decode":187,"./encode":188}],188:[function(require,module,exports){"use strict";function stringifyPrimitive(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}}module.exports=function(obj,sep,eq,name){return sep=sep||"&",eq=eq||"=",null===obj&&(obj=void 0),"object"==typeof obj?map(objectKeys(obj),function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;return isArray(obj[k])?map(obj[k],function(v){return ks+encodeURIComponent(stringifyPrimitive(v))}).join(sep):ks+encodeURIComponent(stringifyPrimitive(obj[k]))}).join(sep):name?encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj)):""};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)};function map(xs,f){if(xs.map)return xs.map(f);for(var res=[],i=0;i<xs.length;i++)res.push(f(xs[i],i));return res}var objectKeys=Object.keys||function(obj){var key,res=[];for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&res.push(key);return res}},{}],187:[function(require,module,exports){"use strict";module.exports=function(qs,maxKeys,eq,options){maxKeys=maxKeys||"&",eq=eq||"=";var obj={};if("string"!=typeof qs||0===qs.length)return obj;var regexp=/\+/g;qs=qs.split(maxKeys);maxKeys=1e3;options&&"number"==typeof options.maxKeys&&(maxKeys=options.maxKeys);var len=qs.length;0<maxKeys&&maxKeys<len&&(len=maxKeys);for(var i=0;i<len;++i){var kstr,k=qs[i].replace(regexp,"%20"),v=k.indexOf(eq),v=0<=v?(kstr=k.substr(0,v),k.substr(v+1)):(kstr=k,""),k=decodeURIComponent(kstr),v=decodeURIComponent(v);!function(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}(obj,k)?obj[k]=v:isArray(obj[k])?obj[k].push(v):obj[k]=[obj[k],v]}return obj};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)}},{}],186:[function(require,module,exports){(function(global){(function(){!function(root){var freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule="object"==typeof module&&module&&!module.nodeType&&module,freeGlobal="object"==typeof global&&global;freeGlobal.global!==freeGlobal&&freeGlobal.window!==freeGlobal&&freeGlobal.self!==freeGlobal||(root=freeGlobal);var punycode,key,maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexPunycode=/^xn--/,regexNonASCII=/[^\x20-\x7E]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},baseMinusTMin=base-tMin,floor=Math.floor,stringFromCharCode=String.fromCharCode;function error(type){throw new RangeError(errors[type])}function map(array,fn){for(var length=array.length,result=[];length--;)result[length]=fn(array[length]);return result}function mapDomain(string,fn){var parts=string.split("@"),result="";return 1<parts.length&&(result=parts[0]+"@",string=parts[1]),result+map((string=string.replace(regexSeparators,".")).split("."),fn).join(".")}function ucs2decode(string){for(var value,extra,output=[],counter=0,length=string.length;counter<length;)55296<=(value=string.charCodeAt(counter++))&&value<=56319&&counter<length?56320==(64512&(extra=string.charCodeAt(counter++)))?output.push(((1023&value)<<10)+(1023&extra)+65536):(output.push(value),counter--):output.push(value);return output}function ucs2encode(array){return map(array,function(value){var output="";return 65535<value&&(output+=stringFromCharCode((value-=65536)>>>10&1023|55296),value=56320|1023&value),output+=stringFromCharCode(value)}).join("")}function digitToBasic(digit,flag){return digit+22+75*(digit<26)-((0!=flag)<<5)}function adapt(delta,numPoints,firstTime){var k=0;for(delta=firstTime?floor(delta/damp):delta>>1,delta+=floor(delta/numPoints);baseMinusTMin*tMax>>1<delta;k+=base)delta=floor(delta/baseMinusTMin);return floor(k+(baseMinusTMin+1)*delta/(delta+skew))}function decode(input){var out,j,index,oldi,w,k,baseMinusT,output=[],inputLength=input.length,i=0,n=initialN,bias=initialBias,basic=input.lastIndexOf(delimiter);for(basic<0&&(basic=0),j=0;j<basic;++j)128<=input.charCodeAt(j)&&error("not-basic"),output.push(input.charCodeAt(j));for(index=0<basic?basic+1:0;index<inputLength;){for(oldi=i,w=1,k=base;inputLength<=index&&error("invalid-input"),baseMinusT=input.charCodeAt(index++),(base<=(baseMinusT=baseMinusT-48<10?baseMinusT-22:baseMinusT-65<26?baseMinusT-65:baseMinusT-97<26?baseMinusT-97:base)||baseMinusT>floor((maxInt-i)/w))&&error("overflow"),i+=baseMinusT*w,!(baseMinusT<(baseMinusT=k<=bias?tMin:bias+tMax<=k?tMax:k-bias));k+=base)w>floor(maxInt/(baseMinusT=base-baseMinusT))&&error("overflow"),w*=baseMinusT;bias=adapt(i-oldi,out=output.length+1,0==oldi),floor(i/out)>maxInt-n&&error("overflow"),n+=floor(i/out),i%=out,output.splice(i++,0,n)}return ucs2encode(output)}function encode(input){for(var delta,handledCPCount,basicLength,m,q,k,t,currentValue,handledCPCountPlusOne,baseMinusT,qMinusT,output=[],inputLength=(input=ucs2decode(input)).length,n=initialN,bias=initialBias,j=delta=0;j<inputLength;++j)(currentValue=input[j])<128&&output.push(stringFromCharCode(currentValue));for(handledCPCount=basicLength=output.length,basicLength&&output.push(delimiter);handledCPCount<inputLength;){for(m=maxInt,j=0;j<inputLength;++j)n<=(currentValue=input[j])&&currentValue<m&&(m=currentValue);for(m-n>floor((maxInt-delta)/(handledCPCountPlusOne=handledCPCount+1))&&error("overflow"),delta+=(m-n)*handledCPCountPlusOne,n=m,j=0;j<inputLength;++j)if((currentValue=input[j])<n&&++delta>maxInt&&error("overflow"),currentValue==n){for(q=delta,k=base;!(q<(t=k<=bias?tMin:bias+tMax<=k?tMax:k-bias));k+=base)qMinusT=q-t,baseMinusT=base-t,output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0))),q=floor(qMinusT/baseMinusT);output.push(stringFromCharCode(digitToBasic(q,0))),bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength),delta=0,++handledCPCount}++delta,++n}return output.join("")}if(punycode={version:"1.4.1",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode,encode:encode,toASCII:function(input){return mapDomain(input,function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string})},toUnicode:function(input){return mapDomain(input,function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string})}},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return punycode});else if(freeExports&&freeModule)if(module.exports==freeExports)freeModule.exports=punycode;else for(key in punycode)punycode.hasOwnProperty(key)&&(freeExports[key]=punycode[key]);else root.punycode=punycode}(this)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(require,module,exports){"use strict";function countTrailingZeros(v){var c=32;return(v&=-v)&&c--,65535&v&&(c-=16),16711935&v&&(c-=8),252645135&v&&(c-=4),858993459&v&&(c-=2),1431655765&v&&--c,c}exports.INT_BITS=32,exports.INT_MAX=2147483647,exports.INT_MIN=-1<<31,exports.sign=function(v){return(0<v)-(v<0)},exports.abs=function(v){var mask=v>>31;return(v^mask)-mask},exports.min=function(x,y){return y^(x^y)&-(x<y)},exports.max=function(x,y){return x^(x^y)&-(x<y)},exports.isPow2=function(v){return!(v&v-1||!v)},exports.log2=function(v){var shift,r=(65535<v)<<4;return r|=shift=(255<(v>>>=r))<<3,r|=shift=(15<(v>>>=shift))<<2,(r|=shift=(3<(v>>>=shift))<<1)|(v>>>=shift)>>1},exports.log10=function(v){return 1e9<=v?9:1e8<=v?8:1e7<=v?7:1e6<=v?6:1e5<=v?5:1e4<=v?4:1e3<=v?3:100<=v?2:10<=v?1:0},exports.popCount=function(v){return 16843009*((v=(858993459&(v-=v>>>1&1431655765))+(v>>>2&858993459))+(v>>>4)&252645135)>>>24},exports.countTrailingZeros=countTrailingZeros,exports.nextPow2=function(v){return v+=0===v,--v,v|=v>>>1,v|=v>>>2,v|=v>>>4,v|=v>>>8,(v|=v>>>16)+1},exports.prevPow2=function(v){return v|=v>>>1,v|=v>>>2,v|=v>>>4,v|=v>>>8,(v|=v>>>16)-(v>>>1)},exports.parity=function(v){return v^=v>>>16,v^=v>>>8,v^=v>>>4,27030>>>(v&=15)&1};var REVERSE_TABLE=new Array(256);!function(tab){for(var i=0;i<256;++i){var v=i,r=i,s=7;for(v>>>=1;v;v>>>=1)r<<=1,r|=1&v,--s;tab[i]=r<<s&255}}(REVERSE_TABLE),exports.reverse=function(v){return REVERSE_TABLE[255&v]<<24|REVERSE_TABLE[v>>>8&255]<<16|REVERSE_TABLE[v>>>16&255]<<8|REVERSE_TABLE[v>>>24&255]},exports.interleave2=function(x,y){return(x=1431655765&((x=858993459&((x=252645135&((x=16711935&((x&=65535)|x<<8))|x<<4))|x<<2))|x<<1))|(y=1431655765&((y=858993459&((y=252645135&((y=16711935&((y&=65535)|y<<8))|y<<4))|y<<2))|y<<1))<<1},exports.deinterleave2=function(v,n){return(v=65535&((v=16711935&((v=252645135&((v=858993459&((v=v>>>n&1431655765)|v>>>1))|v>>>2))|v>>>4))|v>>>16))<<16>>16},exports.interleave3=function(x,y,z){return x=1227133513&((x=3272356035&((x=251719695&((x=4278190335&((x&=1023)|x<<16))|x<<8))|x<<4))|x<<2),(x|=(y=1227133513&((y=3272356035&((y=251719695&((y=4278190335&((y&=1023)|y<<16))|y<<8))|y<<4))|y<<2))<<1)|(z=1227133513&((z=3272356035&((z=251719695&((z=4278190335&((z&=1023)|z<<16))|z<<8))|z<<4))|z<<2))<<2},exports.deinterleave3=function(v,n){return(v=1023&((v=4278190335&((v=251719695&((v=3272356035&((v=v>>>n&1227133513)|v>>>2))|v>>>4))|v>>>8))|v>>>16))<<22>>22},exports.nextCombination=function(v){var t=v|v-1;return 1+t|(~t&-~t)-1>>>countTrailingZeros(v)+1}},{}],43:[function(Container,module,exports){"use strict";exports.__esModule=!0;var _createClass=function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor};function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var obj,_utils=Container("../utils"),_DisplayObject2=Container("./DisplayObject");Container=function(_DisplayObject){function Container(){!function(instance){if(!(instance instanceof Container))throw new TypeError("Cannot call a class as a function")}(this);var _this=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_DisplayObject.call(this));return _this.children=[],_this}return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(Container,_DisplayObject),Container.prototype.onChildrenChange=function(){},Container.prototype.addChild=function(child){var argumentsLength=arguments.length;if(1<argumentsLength)for(var i=0;i<argumentsLength;i++)this.addChild(arguments[i]);else child.parent&&child.parent.removeChild(child),child.parent=this,child.transform._parentID=-1,this.children.push(child),this._boundsID++,this.onChildrenChange(this.children.length-1),child.emit("added",this);return child},Container.prototype.addChildAt=function(child,index){if(index<0||index>this.children.length)throw new Error(child+"addChildAt: The index "+index+" supplied is out of bounds "+this.children.length);return child.parent&&child.parent.removeChild(child),child.parent=this,child.transform._parentID=-1,this.children.splice(index,0,child),this._boundsID++,this.onChildrenChange(index),child.emit("added",this),child},Container.prototype.swapChildren=function(child,child2){var index1,index2;child!==child2&&(index1=this.getChildIndex(child),index2=this.getChildIndex(child2),this.children[index1]=child2,this.children[index2]=child,this.onChildrenChange(index1<index2?index1:index2))},Container.prototype.getChildIndex=function(index){index=this.children.indexOf(index);if(-1===index)throw new Error("The supplied DisplayObject must be a child of the caller");return index},Container.prototype.setChildIndex=function(child,index){if(index<0||index>=this.children.length)throw new Error("The index "+index+" supplied is out of bounds "+this.children.length);var currentIndex=this.getChildIndex(child);(0,_utils.removeItems)(this.children,currentIndex,1),this.children.splice(index,0,child),this.onChildrenChange(index)},Container.prototype.getChildAt=function(index){if(index<0||index>=this.children.length)throw new Error("getChildAt: Index ("+index+") does not exist.");return this.children[index]},Container.prototype.removeChild=function(child){var argumentsLength=arguments.length;if(1<argumentsLength)for(var i=0;i<argumentsLength;i++)this.removeChild(arguments[i]);else{var index=this.children.indexOf(child);if(-1===index)return null;child.parent=null,child.transform._parentID=-1,(0,_utils.removeItems)(this.children,index,1),this._boundsID++,this.onChildrenChange(index),child.emit("removed",this)}return child},Container.prototype.removeChildAt=function(index){var child=this.getChildAt(index);return child.parent=null,child.transform._parentID=-1,(0,_utils.removeItems)(this.children,index,1),this._boundsID++,this.onChildrenChange(index),child.emit("removed",this),child},Container.prototype.removeChildren=function(){var beginIndex=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,range=arguments[1],end="number"==typeof range?range:this.children.length,range=end-beginIndex,removed=void 0;if(0<range&&range<=end){removed=this.children.splice(beginIndex,range);for(var i=0;i<removed.length;++i)removed[i].parent=null,removed[i].transform&&(removed[i].transform._parentID=-1);this._boundsID++,this.onChildrenChange(beginIndex);for(var _i=0;_i<removed.length;++_i)removed[_i].emit("removed",this);return removed}if(0==range&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},Container.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var i=0,j=this.children.length;i<j;++i){var child=this.children[i];child.visible&&child.updateTransform()}},Container.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var i=0;i<this.children.length;i++){var child=this.children[i];child.visible&&child.renderable&&(child.calculateBounds(),child._mask?(child._mask.calculateBounds(),this._bounds.addBoundsMask(child._bounds,child._mask._bounds)):child.filterArea?this._bounds.addBoundsArea(child._bounds,child.filterArea):this._bounds.addBounds(child._bounds))}this._lastBoundsID=this._boundsID},Container.prototype._calculateBounds=function(){},Container.prototype.renderWebGL=function(renderer){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvancedWebGL(renderer);else{this._renderWebGL(renderer);for(var i=0,j=this.children.length;i<j;++i)this.children[i].renderWebGL(renderer)}},Container.prototype.renderAdvancedWebGL=function(renderer){renderer.flush();var filters=this._filters,mask=this._mask;if(filters){this._enabledFilters||(this._enabledFilters=[]);for(var i=this._enabledFilters.length=0;i<filters.length;i++)filters[i].enabled&&this._enabledFilters.push(filters[i]);this._enabledFilters.length&&renderer.filterManager.pushFilter(this,this._enabledFilters)}mask&&renderer.maskManager.pushMask(this,this._mask),this._renderWebGL(renderer);for(var _i2=0,j=this.children.length;_i2<j;_i2++)this.children[_i2].renderWebGL(renderer);renderer.flush(),mask&&renderer.maskManager.popMask(this,this._mask),filters&&this._enabledFilters&&this._enabledFilters.length&&renderer.filterManager.popFilter()},Container.prototype._renderWebGL=function(renderer){},Container.prototype._renderCanvas=function(renderer){},Container.prototype.renderCanvas=function(renderer){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){this._mask&&renderer.maskManager.pushMask(this._mask),this._renderCanvas(renderer);for(var i=0,j=this.children.length;i<j;++i)this.children[i].renderCanvas(renderer);this._mask&&renderer.maskManager.popMask(renderer)}},Container.prototype.destroy=function(options){_DisplayObject.prototype.destroy.call(this);var destroyChildren="boolean"==typeof options?options:options&&options.children,oldChildren=this.removeChildren(0,this.children.length);if(destroyChildren)for(var i=0;i<oldChildren.length;++i)oldChildren[i].destroy(options)},_createClass(Container,[{key:"width",get:function(){return this.scale.x*this.getLocalBounds().width},set:function(value){var width=this.getLocalBounds().width;this.scale.x=0!==width?value/width:1,this._width=value}},{key:"height",get:function(){return this.scale.y*this.getLocalBounds().height},set:function(value){var height=this.getLocalBounds().height;this.scale.y=0!==height?value/height:1,this._height=value}}]),Container}(((obj=_DisplayObject2)&&obj.__esModule?obj:{default:obj}).default);(exports.default=Container).prototype.containerUpdateTransform=Container.prototype.updateTransform},{"../utils":120,"./DisplayObject":44}],120:[function(_earcut2,module,exports){"use strict";exports.__esModule=!0,exports.premultiplyBlendMode=exports.BaseTextureCache=exports.TextureCache=exports.earcut=exports.mixins=exports.pluginTarget=exports.EventEmitter=exports.removeItems=exports.isMobile=void 0,exports.uid=function(){return++nextUid},exports.hex2rgb=function(hex,out){return(out=out||[])[0]=(hex>>16&255)/255,out[1]=(hex>>8&255)/255,out[2]=(255&hex)/255,out},exports.hex2string=function(hex){return hex=hex.toString(16),"#"+(hex="000000".substr(0,6-hex.length)+hex)},exports.rgb2hex=function(rgb){return(255*rgb[0]<<16)+(255*rgb[1]<<8)+(255*rgb[2]|0)},exports.getResolutionOfUrl=function(resolution,defaultValue){resolution=_settings2.default.RETINA_PREFIX.exec(resolution);if(resolution)return parseFloat(resolution[1]);return void 0!==defaultValue?defaultValue:1},exports.decomposeDataUri=function(dataUriMatch){dataUriMatch=_const.DATA_URI.exec(dataUriMatch);if(dataUriMatch)return{mediaType:dataUriMatch[1]?dataUriMatch[1].toLowerCase():void 0,subType:dataUriMatch[2]?dataUriMatch[2].toLowerCase():void 0,charset:dataUriMatch[3]?dataUriMatch[3].toLowerCase():void 0,encoding:dataUriMatch[4]?dataUriMatch[4].toLowerCase():void 0,data:dataUriMatch[5]};return},exports.getUrlFileExtension=function(extension){extension=_const.URL_FILE_EXTENSION.exec(extension);if(extension)return extension[1].toLowerCase();return},exports.getSvgSize=function(size){var sizeMatch=_const.SVG_SIZE.exec(size),size={};sizeMatch&&(size[sizeMatch[1]]=Math.round(parseFloat(sizeMatch[3])),size[sizeMatch[5]]=Math.round(parseFloat(sizeMatch[7])));return size},exports.skipHello=function(){saidHello=!0},exports.sayHello=function(type){if(saidHello)return;{var args;-1<navigator.userAgent.toLowerCase().indexOf("chrome")?(args=["\n %c %c %c PixiJS "+_const.VERSION+" - ✰ "+type+" ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; backgr